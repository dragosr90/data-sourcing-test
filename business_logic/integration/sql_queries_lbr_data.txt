-- Check how many records we'd get with different variant IDs
SELECT 
    'Coverage by variant ID' as check_type,
    MODEL_COMPONENT_ESSENTIAL_CATEGORY_VARIANT_ID,
    COUNT(DISTINCT RATING_ID) as unique_ratings,
    COUNT(*) as total_records
FROM stg_{{ RUN_MONTH }}.dial_fair_pd_model_component_essentials
WHERE MODEL_COMPONENT_ESSENTIAL_TYPE_CODE IN ('TotalTurnoverTurnover', 'Turnover', 'Budget', 'Revenues', 'TotalRevenues', 'TotalOperatingIncome')
GROUP BY MODEL_COMPONENT_ESSENTIAL_CATEGORY_VARIANT_ID

UNION ALL

-- Check total unique ratings if we use ALL variant IDs
SELECT 
    'Total with all variants' as check_type,
    'all' as MODEL_COMPONENT_ESSENTIAL_CATEGORY_VARIANT_ID,
    COUNT(DISTINCT RATING_ID) as unique_ratings,
    COUNT(*) as total_records
FROM stg_{{ RUN_MONTH }}.dial_fair_pd_model_component_essentials
WHERE MODEL_COMPONENT_ESSENTIAL_TYPE_CODE IN ('TotalTurnoverTurnover', 'Turnover', 'Budget', 'Revenues', 'TotalRevenues', 'TotalOperatingIncome')

ORDER BY unique_ratings DESC;
