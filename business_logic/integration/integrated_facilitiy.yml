target: int_{{ RUN_MONTH }}.{{ DELIVERY_ENTITY }}_integrated_facility

sources:
  - alias: SSF_CF
    columns:
    - DeliveryEntity
    - LocalFacilityIdentifier
    - Default
    - DefaultDate
    - DefaultEndDate
    - NonperformingEndDate
    - NonperformingStartDate
    - PerformingIndicator
    - ReportingDate
    - AccruedFeesAmountDebitCreditIndicator
    - AccruedFeesAmountReportingAmount
    - AccruedFeesAmountReportingCurrency
    - AccruedFeesAmountTransactionAmount
    - AccruedFeesAmountTransactionCurrency
    - AlternativeLocalReferenceIdentifier
    - ApprovedLossGivenDefaultRatingDate
    - ArrangementParticipationType
    - BaselIIProductType
    - BookType
    - BorrowingBaseReportingAmount
    - BorrowingBaseReportingCurrency
    - BorrowingBaseTransactionAmount
    - BorrowingBaseTransactionCurrency
    - BusinessSegment
    - ContractStatus
    - ContractStatusDate
    - CreditAgreement
    - CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
    - CreditConversionFactor
    - CreditLimitReportingAmount
    - CreditLimitReportingCurrency
    - CreditLimitTransactionAmount
    - CreditLimitTransactionCurrency
    - CreditProductProgramSegment
    - DownturnLossGivenDefault
    - EADAmountBeforeApplicationOfConservatismReportingAmount
    - EADAmountBeforeApplicationOfConservatismReportingCurrency
    - EADAmountBeforeApplicationOfConservatismTransactionAmount
    - EADAmountBeforeApplicationOfConservatismTransactionCurrency
    - EADModelCode
    - ELBEPercentageBeforeApplicationOfConservatism
    - ExemptionFromAdvancedInternalRatingBasedApproach
    - ExposureAtDefaultReportingAmount
    - ExposureAtDefaultReportingCurrency
    - FacilityType
    - Forborne
    - ForborneDate
    - GlobalFacilityIdentifier
    - HighQualityIndicator
    - Ifrs9RiskStage
    - IncomeProducingRealEstateFinance
    - InfrastructuralSupportingFactor
    - InsuredFlag
    - LandAcquisitionDevelopmentAndConstructionExposureFinance
    - LGDMarginOfConservatism
    - LGDModelCode
    - LGDPercentageBeforeConservatism
    - LGDType
    - LoanLossAllowanceRcoa
    - LoanLossAllowanceReportingAmount
    - LoanLossAllowanceReportingCurrency
    - LoanLossAllowanceTransactionAmount
    - LoanLossAllowanceTransactionCurrency
    - LocalReferenceIdentifier
    - LossGivenDefaultClass
    - MaturityDate
    - ParentCreditFacility
    - ParentCreditFacilitySourceSystemIdentifier
    - PDMarginOfConservatism
    - PDModelCode
    - PDPercentageBeforeConservatism
    - PensionerFlag
    - PlNplIndicator
    - ProbabilityOfDefault
    - ProductProgram
    - ProjectFinancePhaseIndicator
    - ReportingEntity
    - Revolving
    - RiskWeightedExposureApproach
    - SourceSystemIdentifier
    - SpecialisedLendingType
    - ThroughTheCycleLossGivenDefault
    - TradeDate
    - TypeOfCommitment
    - UnadvisedCreditLimitReportingAmount
    - UnadvisedCreditLimitReportingCurrency
    - UnadvisedCreditLimitTransactionAmount
    - UnadvisedCreditLimitTransactionCurrency
    - UndrawnRcoa
    - UndrawnReportingAmount
    - UndrawnReportingCurrency
    - UndrawnTransactionAmount
    - UndrawnTransactionCurrency
    source: stg_{{ RUN_MONTH }}.ssf_{{ DELIVERY_ENTITY }}_cf
  - alias: SSF_DUMMY_FACILITY
    columns:
    - DeliveryEntity
    - LocalFacilityIdentifier
    - Default
    - DefaultDate
    - DefaultEndDate
    - NonperformingEndDate
    - NonperformingStartDate
    - PerformingIndicator
    - ReportingDate
    - AccruedFeesAmountDebitCreditIndicator
    - AccruedFeesAmountReportingAmount
    - AccruedFeesAmountReportingCurrency
    - AccruedFeesAmountTransactionAmount
    - AccruedFeesAmountTransactionCurrency
    - AlternativeLocalReferenceIdentifier
    - ApprovedLossGivenDefaultRatingDate
    - ArrangementParticipationType
    - BaselIIProductType
    - BookType
    - BorrowingBaseReportingAmount
    - BorrowingBaseReportingCurrency
    - BorrowingBaseTransactionAmount
    - BorrowingBaseTransactionCurrency
    - BusinessSegment
    - ContractStatus
    - ContractStatusDate
    - CreditAgreement
    - CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
    - CreditConversionFactor
    - CreditLimitReportingAmount
    - CreditLimitReportingCurrency
    - CreditLimitTransactionAmount
    - CreditLimitTransactionCurrency
    - CreditProductProgramSegment
    - DownturnLossGivenDefault
    - EADAmountBeforeApplicationOfConservatismReportingAmount
    - EADAmountBeforeApplicationOfConservatismReportingCurrency
    - EADAmountBeforeApplicationOfConservatismTransactionAmount
    - EADAmountBeforeApplicationOfConservatismTransactionCurrency
    - EADModelCode
    - ELBEPercentageBeforeApplicationOfConservatism
    - ExemptionFromAdvancedInternalRatingBasedApproach
    - ExposureAtDefaultReportingAmount
    - ExposureAtDefaultReportingCurrency
    - FacilityType
    - Forborne
    - ForborneDate
    - GlobalFacilityIdentifier
    - HighQualityIndicator
    - Ifrs9RiskStage
    - IncomeProducingRealEstateFinance
    - InfrastructuralSupportingFactor
    - InsuredFlag
    - LandAcquisitionDevelopmentAndConstructionExposureFinance
    - LGDMarginOfConservatism
    - LGDModelCode
    - LGDPercentageBeforeConservatism
    - LGDType
    - LoanLossAllowanceRcoa
    - LoanLossAllowanceReportingAmount
    - LoanLossAllowanceReportingCurrency
    - LoanLossAllowanceTransactionAmount
    - LoanLossAllowanceTransactionCurrency
    - LocalReferenceIdentifier
    - LossGivenDefaultClass
    - MaturityDate
    - ParentCreditFacility
    - ParentCreditFacilitySourceSystemIdentifier
    - PDMarginOfConservatism
    - PDModelCode
    - PDPercentageBeforeConservatism
    - PensionerFlag
    - PlNplIndicator
    - ProbabilityOfDefault
    - ProductProgram
    - ProjectFinancePhaseIndicator
    - ReportingEntity
    - Revolving
    - RiskWeightedExposureApproach
    - SourceSystemIdentifier
    - SpecialisedLendingType
    - ThroughTheCycleLossGivenDefault
    - TradeDate
    - TypeOfCommitment
    - UnadvisedCreditLimitReportingAmount
    - UnadvisedCreditLimitReportingCurrency
    - UnadvisedCreditLimitTransactionAmount
    - UnadvisedCreditLimitTransactionCurrency
    - UndrawnRcoa
    - UndrawnReportingAmount
    - UndrawnReportingCurrency
    - UndrawnTransactionAmount
    - UndrawnTransactionCurrency
    source: int_{{ RUN_MONTH }}.{{ DELIVERY_ENTITY }}_dummy_facility
  - alias: SSF_FACILITY_ROLLUP
    columns:
    - DeliveryEntity
    - LocalFacilityIdentifier
    - HighestExistingFacility
    - HighestFacilityExplained
    - SubFacilityFlag
    source: int_{{ RUN_MONTH }}.{{ DELIVERY_ENTITY }}_facility_rollup

transformations:
  - union:
      alias: COMBINED_FACILITIES
      column_mapping:
        SSF_CF:
          DeliveryEntity: SSF_CF.DeliveryEntity
          LocalFacilityIdentifier: SSF_CF.LocalFacilityIdentifier
          Default: SSF_CF.Default
          DefaultDate: SSF_CF.DefaultDate
          DefaultEndDate: SSF_CF.DefaultEndDate
          NonperformingEndDate: SSF_CF.NonperformingEndDate
          NonperformingStartDate: SSF_CF.NonperformingStartDate
          PerformingIndicator: SSF_CF.PerformingIndicator
          ReportingDate: SSF_CF.ReportingDate
          AccruedFeesAmountDebitCreditIndicator: SSF_CF.AccruedFeesAmountDebitCreditIndicator
          AccruedFeesAmountReportingAmount: SSF_CF.AccruedFeesAmountReportingAmount
          AccruedFeesAmountReportingCurrency: SSF_CF.AccruedFeesAmountReportingCurrency
          AccruedFeesAmountTransactionAmount: SSF_CF.AccruedFeesAmountTransactionAmount
          AccruedFeesAmountTransactionCurrency: SSF_CF.AccruedFeesAmountTransactionCurrency
          AlternativeLocalReferenceIdentifier: SSF_CF.AlternativeLocalReferenceIdentifier
          ApprovedLossGivenDefaultRatingDate: SSF_CF.ApprovedLossGivenDefaultRatingDate
          ArrangementParticipationType: SSF_CF.ArrangementParticipationType
          BaselIIProductType: SSF_CF.BaselIIProductType
          BookType: SSF_CF.BookType
          BorrowingBaseReportingAmount: SSF_CF.BorrowingBaseReportingAmount
          BorrowingBaseReportingCurrency: SSF_CF.BorrowingBaseReportingCurrency
          BorrowingBaseTransactionAmount: SSF_CF.BorrowingBaseTransactionAmount
          BorrowingBaseTransactionCurrency: SSF_CF.BorrowingBaseTransactionCurrency
          BusinessSegment: SSF_CF.BusinessSegment
          ContractStatus: SSF_CF.ContractStatus
          ContractStatusDate: SSF_CF.ContractStatusDate
          CreditAgreement: SSF_CF.CreditAgreement
          CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator: SSF_CF.CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
          CreditConversionFactor: SSF_CF.CreditConversionFactor
          CreditLimitReportingAmount: SSF_CF.CreditLimitReportingAmount
          CreditLimitReportingCurrency: SSF_CF.CreditLimitReportingCurrency
          CreditLimitTransactionAmount: SSF_CF.CreditLimitTransactionAmount
          CreditLimitTransactionCurrency: SSF_CF.CreditLimitTransactionCurrency
          CreditProductProgramSegment: SSF_CF.CreditProductProgramSegment
          DownturnLossGivenDefault: SSF_CF.DownturnLossGivenDefault
          EADAmountBeforeApplicationOfConservatismReportingAmount: SSF_CF.EADAmountBeforeApplicationOfConservatismReportingAmount
          EADAmountBeforeApplicationOfConservatismReportingCurrency: SSF_CF.EADAmountBeforeApplicationOfConservatismReportingCurrency
          EADAmountBeforeApplicationOfConservatismTransactionAmount: SSF_CF.EADAmountBeforeApplicationOfConservatismTransactionAmount
          EADAmountBeforeApplicationOfConservatismTransactionCurrency: SSF_CF.EADAmountBeforeApplicationOfConservatismTransactionCurrency
          EADModelCode: SSF_CF.EADModelCode
          ELBEPercentageBeforeApplicationOfConservatism: SSF_CF.ELBEPercentageBeforeApplicationOfConservatism
          ExemptionFromAdvancedInternalRatingBasedApproach: SSF_CF.ExemptionFromAdvancedInternalRatingBasedApproach
          ExposureAtDefaultReportingAmount: SSF_CF.ExposureAtDefaultReportingAmount
          ExposureAtDefaultReportingCurrency: SSF_CF.ExposureAtDefaultReportingCurrency
          FacilityType: SSF_CF.FacilityType
          Forborne: SSF_CF.Forborne
          ForborneDate: SSF_CF.ForborneDate
          GlobalFacilityIdentifier: SSF_CF.GlobalFacilityIdentifier
          HighQualityIndicator: SSF_CF.HighQualityIndicator
          Ifrs9RiskStage: SSF_CF.Ifrs9RiskStage
          IncomeProducingRealEstateFinance: SSF_CF.IncomeProducingRealEstateFinance
          InfrastructuralSupportingFactor: SSF_CF.InfrastructuralSupportingFactor
          InsuredFlag: SSF_CF.InsuredFlag
          LandAcquisitionDevelopmentAndConstructionExposureFinance: SSF_CF.LandAcquisitionDevelopmentAndConstructionExposureFinance
          LGDMarginOfConservatism: SSF_CF.LGDMarginOfConservatism
          LGDModelCode: SSF_CF.LGDModelCode
          LGDPercentageBeforeConservatism: SSF_CF.LGDPercentageBeforeConservatism
          LGDType: SSF_CF.LGDType
          LoanLossAllowanceRcoa: SSF_CF.LoanLossAllowanceRcoa
          LoanLossAllowanceReportingAmount: SSF_CF.LoanLossAllowanceReportingAmount
          LoanLossAllowanceReportingCurrency: SSF_CF.LoanLossAllowanceReportingCurrency
          LoanLossAllowanceTransactionAmount: SSF_CF.LoanLossAllowanceTransactionAmount
          LoanLossAllowanceTransactionCurrency: SSF_CF.LoanLossAllowanceTransactionCurrency
          LocalReferenceIdentifier: SSF_CF.LocalReferenceIdentifier
          LossGivenDefaultClass: SSF_CF.LossGivenDefaultClass
          MaturityDate: SSF_CF.MaturityDate
          ParentCreditFacility: SSF_CF.ParentCreditFacility
          ParentCreditFacilitySourceSystemIdentifier: SSF_CF.ParentCreditFacilitySourceSystemIdentifier
          PDMarginOfConservatism: SSF_CF.PDMarginOfConservatism
          PDModelCode: SSF_CF.PDModelCode
          PDPercentageBeforeConservatism: SSF_CF.PDPercentageBeforeConservatism
          PensionerFlag: SSF_CF.PensionerFlag
          PlNplIndicator: SSF_CF.PlNplIndicator
          ProbabilityOfDefault: SSF_CF.ProbabilityOfDefault
          ProductProgram: SSF_CF.ProductProgram
          ProjectFinancePhaseIndicator: SSF_CF.ProjectFinancePhaseIndicator
          ReportingEntity: SSF_CF.ReportingEntity
          Revolving: SSF_CF.Revolving
          RiskWeightedExposureApproach: SSF_CF.RiskWeightedExposureApproach
          SourceSystemIdentifier: SSF_CF.SourceSystemIdentifier
          SpecialisedLendingType: SSF_CF.SpecialisedLendingType
          ThroughTheCycleLossGivenDefault: SSF_CF.ThroughTheCycleLossGivenDefault
          TradeDate: SSF_CF.TradeDate
          TypeOfCommitment: SSF_CF.TypeOfCommitment
          UnadvisedCreditLimitReportingAmount: SSF_CF.UnadvisedCreditLimitReportingAmount
          UnadvisedCreditLimitReportingCurrency: SSF_CF.UnadvisedCreditLimitReportingCurrency
          UnadvisedCreditLimitTransactionAmount: SSF_CF.UnadvisedCreditLimitTransactionAmount
          UnadvisedCreditLimitTransactionCurrency: SSF_CF.UnadvisedCreditLimitTransactionCurrency
          UndrawnRcoa: SSF_CF.UndrawnRcoa
          UndrawnReportingAmount: SSF_CF.UndrawnReportingAmount
          UndrawnReportingCurrency: SSF_CF.UndrawnReportingCurrency
          UndrawnTransactionAmount: SSF_CF.UndrawnTransactionAmount
          UndrawnTransactionCurrency: SSF_CF.UndrawnTransactionCurrency
        SSF_DUMMY_FACILITY:
          DeliveryEntity: SSF_DUMMY_FACILITY.DeliveryEntity
          LocalFacilityIdentifier: SSF_DUMMY_FACILITY.LocalFacilityIdentifier
          Default: SSF_DUMMY_FACILITY.Default
          DefaultDate: SSF_DUMMY_FACILITY.DefaultDate
          DefaultEndDate: SSF_DUMMY_FACILITY.DefaultEndDate
          NonperformingEndDate: SSF_DUMMY_FACILITY.NonperformingEndDate
          NonperformingStartDate: SSF_DUMMY_FACILITY.NonperformingStartDate
          PerformingIndicator: SSF_DUMMY_FACILITY.PerformingIndicator
          ReportingDate: SSF_DUMMY_FACILITY.ReportingDate
          AccruedFeesAmountDebitCreditIndicator: SSF_DUMMY_FACILITY.AccruedFeesAmountDebitCreditIndicator
          AccruedFeesAmountReportingAmount: SSF_DUMMY_FACILITY.AccruedFeesAmountReportingAmount
          AccruedFeesAmountReportingCurrency: SSF_DUMMY_FACILITY.AccruedFeesAmountReportingCurrency
          AccruedFeesAmountTransactionAmount: SSF_DUMMY_FACILITY.AccruedFeesAmountTransactionAmount
          AccruedFeesAmountTransactionCurrency: SSF_DUMMY_FACILITY.AccruedFeesAmountTransactionCurrency
          AlternativeLocalReferenceIdentifier: SSF_DUMMY_FACILITY.AlternativeLocalReferenceIdentifier
          ApprovedLossGivenDefaultRatingDate: SSF_DUMMY_FACILITY.ApprovedLossGivenDefaultRatingDate
          ArrangementParticipationType: SSF_DUMMY_FACILITY.ArrangementParticipationType
          BaselIIProductType: SSF_DUMMY_FACILITY.BaselIIProductType
          BookType: SSF_DUMMY_FACILITY.BookType
          BorrowingBaseReportingAmount: SSF_DUMMY_FACILITY.BorrowingBaseReportingAmount
          BorrowingBaseReportingCurrency: SSF_DUMMY_FACILITY.BorrowingBaseReportingCurrency
          BorrowingBaseTransactionAmount: SSF_DUMMY_FACILITY.BorrowingBaseTransactionAmount
          BorrowingBaseTransactionCurrency: SSF_DUMMY_FACILITY.BorrowingBaseTransactionCurrency
          BusinessSegment: SSF_DUMMY_FACILITY.BusinessSegment
          ContractStatus: SSF_DUMMY_FACILITY.ContractStatus
          ContractStatusDate: SSF_DUMMY_FACILITY.ContractStatusDate
          CreditAgreement: SSF_DUMMY_FACILITY.CreditAgreement
          CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator: SSF_DUMMY_FACILITY.CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
          CreditConversionFactor: SSF_DUMMY_FACILITY.CreditConversionFactor
          CreditLimitReportingAmount: SSF_DUMMY_FACILITY.CreditLimitReportingAmount
          CreditLimitReportingCurrency: SSF_DUMMY_FACILITY.CreditLimitReportingCurrency
          CreditLimitTransactionAmount: SSF_DUMMY_FACILITY.CreditLimitTransactionAmount
          CreditLimitTransactionCurrency: SSF_DUMMY_FACILITY.CreditLimitTransactionCurrency
          CreditProductProgramSegment: SSF_DUMMY_FACILITY.CreditProductProgramSegment
          DownturnLossGivenDefault: SSF_DUMMY_FACILITY.DownturnLossGivenDefault
          EADAmountBeforeApplicationOfConservatismReportingAmount: SSF_DUMMY_FACILITY.EADAmountBeforeApplicationOfConservatismReportingAmount
          EADAmountBeforeApplicationOfConservatismReportingCurrency: SSF_DUMMY_FACILITY.EADAmountBeforeApplicationOfConservatismReportingCurrency
          EADAmountBeforeApplicationOfConservatismTransactionAmount: SSF_DUMMY_FACILITY.EADAmountBeforeApplicationOfConservatismTransactionAmount
          EADAmountBeforeApplicationOfConservatismTransactionCurrency: SSF_DUMMY_FACILITY.EADAmountBeforeApplicationOfConservatismTransactionCurrency
          EADModelCode: SSF_DUMMY_FACILITY.EADModelCode
          ELBEPercentageBeforeApplicationOfConservatism: SSF_DUMMY_FACILITY.ELBEPercentageBeforeApplicationOfConservatism
          ExemptionFromAdvancedInternalRatingBasedApproach: SSF_DUMMY_FACILITY.ExemptionFromAdvancedInternalRatingBasedApproach
          ExposureAtDefaultReportingAmount: SSF_DUMMY_FACILITY.ExposureAtDefaultReportingAmount
          ExposureAtDefaultReportingCurrency: SSF_DUMMY_FACILITY.ExposureAtDefaultReportingCurrency
          FacilityType: SSF_DUMMY_FACILITY.FacilityType
          Forborne: SSF_DUMMY_FACILITY.Forborne
          ForborneDate: SSF_DUMMY_FACILITY.ForborneDate
          GlobalFacilityIdentifier: SSF_DUMMY_FACILITY.GlobalFacilityIdentifier
          HighQualityIndicator: SSF_DUMMY_FACILITY.HighQualityIndicator
          Ifrs9RiskStage: SSF_DUMMY_FACILITY.Ifrs9RiskStage
          IncomeProducingRealEstateFinance: SSF_DUMMY_FACILITY.IncomeProducingRealEstateFinance
          InfrastructuralSupportingFactor: SSF_DUMMY_FACILITY.InfrastructuralSupportingFactor
          InsuredFlag: SSF_DUMMY_FACILITY.InsuredFlag
          LandAcquisitionDevelopmentAndConstructionExposureFinance: SSF_DUMMY_FACILITY.LandAcquisitionDevelopmentAndConstructionExposureFinance
          LGDMarginOfConservatism: SSF_DUMMY_FACILITY.LGDMarginOfConservatism
          LGDModelCode: SSF_DUMMY_FACILITY.LGDModelCode
          LGDPercentageBeforeConservatism: SSF_DUMMY_FACILITY.LGDPercentageBeforeConservatism
          LGDType: SSF_DUMMY_FACILITY.LGDType
          LoanLossAllowanceRcoa: SSF_DUMMY_FACILITY.LoanLossAllowanceRcoa
          LoanLossAllowanceReportingAmount: SSF_DUMMY_FACILITY.LoanLossAllowanceReportingAmount
          LoanLossAllowanceReportingCurrency: SSF_DUMMY_FACILITY.LoanLossAllowanceReportingCurrency
          LoanLossAllowanceTransactionAmount: SSF_DUMMY_FACILITY.LoanLossAllowanceTransactionAmount
          LoanLossAllowanceTransactionCurrency: SSF_DUMMY_FACILITY.LoanLossAllowanceTransactionCurrency
          LocalReferenceIdentifier: SSF_DUMMY_FACILITY.LocalReferenceIdentifier
          LossGivenDefaultClass: SSF_DUMMY_FACILITY.LossGivenDefaultClass
          MaturityDate: SSF_DUMMY_FACILITY.MaturityDate
          ParentCreditFacility: SSF_DUMMY_FACILITY.ParentCreditFacility
          ParentCreditFacilitySourceSystemIdentifier: SSF_DUMMY_FACILITY.ParentCreditFacilitySourceSystemIdentifier
          PDMarginOfConservatism: SSF_DUMMY_FACILITY.PDMarginOfConservatism
          PDModelCode: SSF_DUMMY_FACILITY.PDModelCode
          PDPercentageBeforeConservatism: SSF_DUMMY_FACILITY.PDPercentageBeforeConservatism
          PensionerFlag: SSF_DUMMY_FACILITY.PensionerFlag
          PlNplIndicator: SSF_DUMMY_FACILITY.PlNplIndicator
          ProbabilityOfDefault: SSF_DUMMY_FACILITY.ProbabilityOfDefault
          ProductProgram: SSF_DUMMY_FACILITY.ProductProgram
          ProjectFinancePhaseIndicator: SSF_DUMMY_FACILITY.ProjectFinancePhaseIndicator
          ReportingEntity: SSF_DUMMY_FACILITY.ReportingEntity
          Revolving: SSF_DUMMY_FACILITY.Revolving
          RiskWeightedExposureApproach: SSF_DUMMY_FACILITY.RiskWeightedExposureApproach
          SourceSystemIdentifier: SSF_DUMMY_FACILITY.SourceSystemIdentifier
          SpecialisedLendingType: SSF_DUMMY_FACILITY.SpecialisedLendingType
          ThroughTheCycleLossGivenDefault: SSF_DUMMY_FACILITY.ThroughTheCycleLossGivenDefault
          TradeDate: SSF_DUMMY_FACILITY.TradeDate
          TypeOfCommitment: SSF_DUMMY_FACILITY.TypeOfCommitment
          UnadvisedCreditLimitReportingAmount: SSF_DUMMY_FACILITY.UnadvisedCreditLimitReportingAmount
          UnadvisedCreditLimitReportingCurrency: SSF_DUMMY_FACILITY.UnadvisedCreditLimitReportingCurrency
          UnadvisedCreditLimitTransactionAmount: SSF_DUMMY_FACILITY.UnadvisedCreditLimitTransactionAmount
          UnadvisedCreditLimitTransactionCurrency: SSF_DUMMY_FACILITY.UnadvisedCreditLimitTransactionCurrency
          UndrawnRcoa: SSF_DUMMY_FACILITY.UndrawnRcoa
          UndrawnReportingAmount: SSF_DUMMY_FACILITY.UndrawnReportingAmount
          UndrawnReportingCurrency: SSF_DUMMY_FACILITY.UndrawnReportingCurrency
          UndrawnTransactionAmount: SSF_DUMMY_FACILITY.UndrawnTransactionAmount
          UndrawnTransactionCurrency: SSF_DUMMY_FACILITY.UndrawnTransactionCurrency
      source: SSF_CF
  - join:
      left_source: COMBINED_FACILITIES
      right_source: SSF_FACILITY_ROLLUP
      condition:
      - COMBINED_FACILITIES.LocalFacilityIdentifier = SSF_FACILITY_ROLLUP.LocalFacilityIdentifier
      - COMBINED_FACILITIES.DeliveryEntity = SSF_FACILITY_ROLLUP.DeliveryEntity
      how: left
  - filter:
      conditions:
      - coalesce(SSF_FACILITY_ROLLUP.SubFacilityFlag, 0) = 0

expressions:
  DeliveryEntity: COMBINED_FACILITIES.DeliveryEntity
  LocalFacilityIdentifier: COMBINED_FACILITIES.LocalFacilityIdentifier
  Default: COMBINED_FACILITIES.Default
  DefaultDate: COMBINED_FACILITIES.DefaultDate
  DefaultEndDate: COMBINED_FACILITIES.DefaultEndDate
  NonperformingEndDate: COMBINED_FACILITIES.NonperformingEndDate
  NonperformingStartDate: COMBINED_FACILITIES.NonperformingStartDate
  PerformingIndicator: COMBINED_FACILITIES.PerformingIndicator
  ReportingDate: COMBINED_FACILITIES.ReportingDate
  AccruedFeesAmountDebitCreditIndicator: COMBINED_FACILITIES.AccruedFeesAmountDebitCreditIndicator
  AccruedFeesAmountReportingAmount: COMBINED_FACILITIES.AccruedFeesAmountReportingAmount
  AccruedFeesAmountReportingCurrency: COMBINED_FACILITIES.AccruedFeesAmountReportingCurrency
  AccruedFeesAmountTransactionAmount: COMBINED_FACILITIES.AccruedFeesAmountTransactionAmount
  AccruedFeesAmountTransactionCurrency: COMBINED_FACILITIES.AccruedFeesAmountTransactionCurrency
  AlternativeLocalReferenceIdentifier: COMBINED_FACILITIES.AlternativeLocalReferenceIdentifier
  ApprovedLossGivenDefaultRatingDate: COMBINED_FACILITIES.ApprovedLossGivenDefaultRatingDate
  ArrangementParticipationType: COMBINED_FACILITIES.ArrangementParticipationType
  BaselIIProductType: COMBINED_FACILITIES.BaselIIProductType
  BookType: COMBINED_FACILITIES.BookType
  BorrowingBaseReportingAmount: COMBINED_FACILITIES.BorrowingBaseReportingAmount
  BorrowingBaseReportingCurrency: COMBINED_FACILITIES.BorrowingBaseReportingCurrency
  BorrowingBaseTransactionAmount: COMBINED_FACILITIES.BorrowingBaseTransactionAmount
  BorrowingBaseTransactionCurrency: COMBINED_FACILITIES.BorrowingBaseTransactionCurrency
  BusinessSegment: COMBINED_FACILITIES.BusinessSegment
  ContractStatus: COMBINED_FACILITIES.ContractStatus
  ContractStatusDate: COMBINED_FACILITIES.ContractStatusDate
  CreditAgreement: COMBINED_FACILITIES.CreditAgreement
  CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator: COMBINED_FACILITIES.CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
  CreditConversionFactor: COMBINED_FACILITIES.CreditConversionFactor
  CreditLimitReport: COMBINED_FACILITIES.CreditLimitReportingAmount
  CreditLimitReportingCurrency: COMBINED_FACILITIES.CreditLimitReportingCurrency
  CreditLimitTransactionAmount: COMBINED_FACILITIES.CreditLimitTransactionAmount
  CreditLimitTransactionCurrency: COMBINED_FACILITIES.CreditLimitTransactionCurrency
  CreditProductProgramSegment: COMBINED_FACILITIES.CreditProductProgramSegment
  DownturnLossGivenDefault: COMBINED_FACILITIES.DownturnLossGivenDefault
  EADAmountBeforeApplicationOfConservatismReportingAmount: COMBINED_FACILITIES.EADAmountBeforeApplicationOfConservatismReportingAmount
  EADAmountBeforeApplicationOfConservatismReportingCurrency: COMBINED_FACILITIES.EADAmountBeforeApplicationOfConservatismReportingCurrency
  EADAmountBeforeApplicationOfConservatismTransactionAmount: COMBINED_FACILITIES.EADAmountBeforeApplicationOfConservatismTransactionAmount
  EADAmountBeforeApplicationOfConservatismTransactionCurrency: COMBINED_FACILITIES.EADAmountBeforeApplicationOfConservatismTransactionCurrency
  EADModelCode: COMBINED_FACILITIES.EADModelCode
  ELBEPercentageBeforeApplicationOfConservatism: COMBINED_FACILITIES.ELBEPercentageBeforeApplicationOfConservatism
  ExemptionFromAdvancedInternalRatingBasedApproach: COMBINED_FACILITIES.ExemptionFromAdvancedInternalRatingBasedApproach
  ExposureAtDefaultReportingAmount: COMBINED_FACILITIES.ExposureAtDefaultReportingAmount
  ExposureAtDefaultReportingCurrency: COMBINED_FACILITIES.ExposureAtDefaultReportingCurrency
  FacilityType: COMBINED_FACILITIES.FacilityType
  Forborne: COMBINED_FACILITIES.Forborne
  ForborneDate: COMBINED_FACILITIES.ForborneDate
  GlobalFacilityIdentifier: COMBINED_FACILITIES.GlobalFacilityIdentifier
  HighQualityIndicator: COMBINED_FACILITIES.HighQualityIndicator
  Ifrs9RiskStage: COMBINED_FACILITIES.Ifrs9RiskStage
  IncomeProducingRealEstateFinance: COMBINED_FACILITIES.IncomeProducingRealEstateFinance
  InfrastructuralSupportingFactor: COMBINED_FACILITIES.InfrastructuralSupportingFactor
  InsuredFlag: COMBINED_FACILITIES.InsuredFlag
  LandAcquisitionDevelopmentAndConstructionExposureFinance: COMBINED_FACILITIES.LandAcquisitionDevelopmentAndConstructionExposureFinance
  LGDMarginOfConservatism: COMBINED_FACILITIES.LGDMarginOfConservatism
  LGDModelCode: COMBINED_FACILITIES.LGDModelCode
  LGDPercentageBeforeConservatism: COMBINED_FACILITIES.LGDPercentageBeforeConservatism
  LGDType: COMBINED_FACILITIES.LGDType
  LoanLossAllowanceRcoa: COMBINED_FACILITIES.LoanLossAllowanceRcoa
  LoanLossAllowanceReportingAmount: COMBINED_FACILITIES.LoanLossAllowanceReportingAmount
  LoanLossAllowanceReportingCurrency: COMBINED_FACILITIES.LoanLossAllowanceReportingCurrency
  LoanLossAllowanceTransactionAmount: COMBINED_FACILITIES.LoanLossAllowanceTransactionAmount
  LoanLossAllowanceTransactionCurrency: COMBINED_FACILITIES.LoanLossAllowanceTransactionCurrency
  LocalReferenceIdentifier: COMBINED_FACILITIES.LocalReferenceIdentifier
  LossGivenDefaultClass: COMBINED_FACILITIES.LossGivenDefaultClass
  MaturityDate: COMBINED_FACILITIES.MaturityDate
  ParentCreditFacility: COMBINED_FACILITIES.ParentCreditFacility
  ParentCreditFacilitySourceSystemIdentifier: COMBINED_FACILITIES.ParentCreditFacilitySourceSystemIdentifier
  PDMarginOfConservatism: COMBINED_FACILITIES.PDMarginOfConservatism
  PDModelCode: COMBINED_FACILITIES.PDModelCode
  PDPercentageBeforeConservatism: COMBINED_FACILITIES.PDPercentageBeforeConservatism
  PensionerFlag: COMBINED_FACILITIES.PensionerFlag
  PlNplIndicator: COMBINED_FACILITIES.PlNplIndicator
  ProbabilityOfDefault: COMBINED_FACILITIES.ProbabilityOfDefault
  ProductProgram: COMBINED_FACILITIES.ProductProgram
  ProjectFinancePhaseIndicator: COMBINED_FACILITIES.ProjectFinancePhaseIndicator
  ReportingEntity: COMBINED_FACILITIES.ReportingEntity
  Revolving: COMBINED_FACILITIES.Revolving
  RiskWeightedExposureApproach: COMBINED_FACILITIES.RiskWeightedExposureApproach
  SourceSystemIdentifier: COMBINED_FACILITIES.SourceSystemIdentifier
  SpecialisedLendingType: COMBINED_FACILITIES.SpecialisedLendingType
  ThroughTheCycleLossGivenDefault: COMBINED_FACILITIES.ThroughTheCycleLossGivenDefault
  TradeDate: COMBINED_FACILITIES.TradeDate
  TypeOfCommitment: COMBINED_FACILITIES.TypeOfCommitment
  UnadvisedCreditLimitReportingAmount: COMBINED_FACILITIES.UnadvisedCreditLimitReportingAmount
  UnadvisedCreditLimitReportingCurrency: COMBINED_FACILITIES.UnadvisedCreditLimitReportingCurrency
  UnadvisedCreditLimitTransactionAmount: COMBINED_FACILITIES.UnadvisedCreditLimitTransactionAmount
  UnadvisedCreditLimitTransactionCurrency: COMBINED_FACILITIES.UnadvisedCreditLimitTransactionCurrency
  UndrawnRcoa: COMBINED_FACILITIES.UndrawnRcoa
  UndrawnReportingAmount: COMBINED_FACILITIES.UndrawnReportingAmount
  UndrawnReportingCurrency: COMBINED_FACILITIES.UndrawnReportingCurrency
  UndrawnTransactionAmount: COMBINED_FACILITIES.UndrawnTransactionAmount
  UndrawnTransactionCurrency: COMBINED_FACILITIES.UndrawnTransactionCurrency
  HighestExistingFacility: SSF_FACILITY_ROLLUP.HighestExistingFacility
  HighestFacilityExplained: SSF_FACILITY_ROLLUP.HighestFacilityExplained
  SubFacilityFlag: SSF_FACILITY_ROLLUP.SubFacilityFlag

drop_duplicates: true
