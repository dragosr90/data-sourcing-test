Logic for Creation of stg_{{ RUN_MONTH }}.bsl_andes_1286_b2_exmp_cond_2
Sources - 
bsrc_d.stg_{{ RUN_MONTH }}.dial_andes_bsl_exmptn_cndtn
bsrc_d.stg_{{ RUN_MONTH }}.dial_andes_bsl_exmptn_id
Target - bsrc_d.stg_{{ RUN_MONTH }}.bsl_andes_1286_b2_exmp_cond  (Check with Pradip for name and schema)
Target attributes- (same as ctrl table above) 
REPORTING_DATE
DELIVERY_ENTITY
EXEMPTION_CONDITION_ID
EXEMPTION_ID
EXEMPTION_NAME
EXEMPTION_END_DATE
SOURCE_SYS_COMP_ID
PD_RTG_MODEL
REPORTING_ENTITY_ID
B2_PD_TYPE_ID
RPRT_CAR_ACCCODE_ID
B2_CPTY_TYPE_ID
CR_PD_PROGRAM
CUSTOMER_MARKET_SEGMENT_ID
LGD_RTG_MODEL
LEGAL_ENTITY
EX_FBN_FLAG
INTERCOMPANY_FLAG
CTPTY_UID
CTPTY_SSC
BASEL_APPROACH
EC_MODEL_INPUT_INDICATOR
EC_PROXIED_INDICATOR
TIME_STAMP
MIN_TURNOVER
SOURCED_EXEMPTION_ID
PL_NPL_INDICATOR
SPECIALISED_LENDING_TYPE
PPU_FLAG

YAML - bsl_andes_1286_b2_exmp_cond  
Logic
Filter on dial exmptn condn file - EFFCTV_STATUS='Active'
Join - Normal on exemption id
Tgt attribute	      mapping from source
REPORTING_DATE	 
DELIVERY_ENTITY	 
EXEMPTION_CONDITION_ID	EXMPTN_CNDTN_ID
EXEMPTION_ID	EXMPTN_ID
EXEMPTION_NAME	EXMPTN_NM
EXEMPTION_END_DATE	EFFCTV_END_DT
SOURCE_SYS_COMP_ID	SRCE_SSTM_CMPNNT_ID
PD_RTG_MODEL	PD_RTNG_MDL
REPORTING_ENTITY_ID	RPRTNG_ENTTY_CD
B2_PD_TYPE_ID	BSL_II_PRDCT_TYP_CD
RPRT_CAR_ACCCODE_ID	RPRTNG_CRTSS_ACCNT_CD
B2_CPTY_TYPE_ID	BSL_II_CNTRPRTY_TYP_CD
CR_PD_PROGRAM	RTL_CRDT_EXPSR_PRTFL_CD
CUSTOMER_MARKET_SEGMENT_ID	CSTMR_MRKT_SGMNT_ID
LGD_RTG_MODEL	LGD_RTNG_MDL
LEGAL_ENTITY	LGL_ENTTY
EX_FBN_FLAG	EX_FBN_FLG
INTERCOMPANY_FLAG	INTRCMPNY_FLG
CTPTY_UID	CNTRPRTY_ID
CTPTY_SSC	MDL_SRC_SSTM_CMPNNT_CD
BASEL_APPROACH	BSL_APPRCH
EC_MODEL_INPUT_INDICATOR	EC_MDL_INPT_INDCTR
EC_PROXIED_INDICATOR	EC_PRXD_INDCTR
TIME_STAMP	null
MIN_TURNOVER	MIN_TURNOVER
SOURCED_EXEMPTION_ID	SOURCED_EXEMPTION_ID
PL_NPL_INDICATOR	SPECIALISED_LENDING_TYPE
SPECIALISED_LENDING_TYPE	SPECIALISED_LENDING_TYPE
PPU_FLAG	"PPU6"

Put this condition for above yellow highlighted attributes - if null then assign *
Example - IIF(ISNULL(SRCE_SSTM_CMPNNT_ID),'*',SRCE_SSTM_CMPNNT_ID)

Highlighted attributes below:
EXEMPTION_ID	EXMPTN_ID
EXEMPTION_NAME	EXMPTN_NM
EXEMPTION_END_DATE	EFFCTV_END_DT
SOURCE_SYS_COMP_ID	SRCE_SSTM_CMPNNT_ID
PD_RTG_MODEL	PD_RTNG_MDL
REPORTING_ENTITY_ID	RPRTNG_ENTTY_CD
B2_PD_TYPE_ID	BSL_II_PRDCT_TYP_CD
RPRT_CAR_ACCCODE_ID	RPRTNG_CRTSS_ACCNT_CD
B2_CPTY_TYPE_ID	BSL_II_CNTRPRTY_TYP_CD
CR_PD_PROGRAM	RTL_CRDT_EXPSR_PRTFL_CD
CUSTOMER_MARKET_SEGMENT_ID	CSTMR_MRKT_SGMNT_ID
LGD_RTG_MODEL	LGD_RTNG_MDL
LEGAL_ENTITY	LGL_ENTTY
EX_FBN_FLAG	EX_FBN_FLG
INTERCOMPANY_FLAG	INTRCMPNY_FLG
CTPTY_UID	CNTRPRTY_ID
CTPTY_SSC	MDL_SRC_SSTM_CMPNNT_CD
BASEL_APPROACH	BSL_APPRCH
EC_MODEL_INPUT_INDICATOR	EC_MDL_INPT_INDCTR
EC_PROXIED_INDICATOR	EC_PRXD_INDCTR
TIME_STAMP	null
MIN_TURNOVER	MIN_TURNOVER
SOURCED_EXEMPTION_ID	SOURCED_EXEMPTION_ID
PL_NPL_INDICATOR
