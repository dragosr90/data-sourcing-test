2025-08-12 09:22:24 [INFO] validate:  YAML format validated successfully
2025-08-12 09:22:31 [INFO] validate:  Sources validated successfully
2025-08-12 09:22:31 [INFO] validate_join:  Joins validated successfully
2025-08-12 09:22:31 [INFO] validate_join:  Joins validated successfully
2025-08-12 09:22:31 [INFO] validate_join:  Joins validated successfully
2025-08-12 09:22:32 [INFO] validate_join:  Joins validated successfully
2025-08-12 09:22:33 [INFO] validate_join:  Joins validated successfully
2025-08-12 09:22:33 [INFO] validate_add_variables:  Variables validated successfully
2025-08-12 09:22:33 [INFO] validate_join:  Joins validated successfully
2025-08-12 09:22:33 [INFO] validate_add_variables:  Variables validated successfully
2025-08-12 09:22:33 [INFO] validate_filter_conditions:  Filter conditions validated successfully
2025-08-12 09:22:33 [INFO] validate_filter:  Filter conditions validated successfully
{"ts": "2025-08-12 09:22:34.029", "level": "ERROR", "logger": "SQLQueryContextLogger", "msg": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`LocalFacilityIdentifier` cannot be resolved. Did you mean one of the following? [`INT_CF_LINKS`.`deliveryentity`, `INT_CF_LINKS`.`liabilitypercentage`, `EXMP_CP_RC`.`deliveryentity`, `EXMP_CP_RC`.`pdmodelcode`, `rank_num_Processid_RC`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 19 more fields]\n      +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 18 more fields]\n         +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 17 more fields]\n            +- Project [idx#12525336L, baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, ... 18 more fields]\n               +- Join LeftOuter, (idx#12525336L = idx#12525516L)\n                  :- Project [idx#12525336L, baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, ... 10 more fields]\n                  :  +- Join LeftOuter, (idx#12525336L = idx#12525435L)\n                  :     :- SubqueryAlias EXMP_CP_RC\n                  :     :  +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, monotonically_increasing_id() AS idx#12525336L]\n                  :     :     +- Project [EXMP_CP_RC.baselcreditriskapproach#12525265 AS baselcreditriskapproach#12525307, EXMP_CP_RC.counterpartyid#12525266 AS counterpartyid#12525308, EXMP_CP_RC.counterpartysourcesystemidentifier#12525267 AS counterpartysourcesystemidentifier#12525309, EXMP_CP_RC.deliveryentity#12525268 AS deliveryentity#12525310, EXMP_CP_RC.exemptionconditionidrc#12525269 AS exemptionconditionidrc#12525311, EXMP_CP_RC.exemptionidrc#12525270 AS exemptionidrc#12525312, EXMP_CP_RC.exemptionnamerc#12525271 AS exemptionnamerc#12525313, EXMP_CP_RC.exemptiontyperc#12525272 AS exemptiontyperc#12525314, EXMP_CP_RC.globalcounterpartyidentifier#12525273 AS globalcounterpartyidentifier#12525315, EXMP_CP_RC.intercompanyflag#12525274 AS intercompanyflag#12525316, EXMP_CP_RC.lastperformingpdmodelcode#12525275 AS lastperformingpdmodelcode#12525317, EXMP_CP_RC.pdmodelcode#12525276 AS pdmodelcode#12525318, EXMP_CP_RC.reportingdate#12525277 AS reportingdate#12525319, EXMP_CP_RC.sourcedexemptionid#12525278 AS sourcedexemptionid#12525320]\n                  :     :        +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525265, EXMP_CP_RC.counterpartyid#12525266, EXMP_CP_RC.counterpartysourcesystemidentifier#12525267, EXMP_CP_RC.deliveryentity#12525268, EXMP_CP_RC.exemptionconditionidrc#12525269, EXMP_CP_RC.exemptionidrc#12525270, EXMP_CP_RC.exemptionnamerc#12525271, EXMP_CP_RC.exemptiontyperc#12525272, EXMP_CP_RC.globalcounterpartyidentifier#12525273, EXMP_CP_RC.intercompanyflag#12525274, EXMP_CP_RC.lastperformingpdmodelcode#12525275, EXMP_CP_RC.pdmodelcode#12525276, EXMP_CP_RC.reportingdate#12525277, EXMP_CP_RC.sourcedexemptionid#12525278, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525279, EXMP_CP_RC_LOWEST.counterpartyid#12525280, EXMP_CP_RC_LOWEST.counterpartyrole#12525281, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525282, EXMP_CP_RC_LOWEST.creditfacility#12525283, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525284, EXMP_CP_RC_LOWEST.deliveryentity#12525285, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525286, EXMP_CP_RC_LOWEST.exemptionidrc#12525287, EXMP_CP_RC_LOWEST.exemptionnamerc#12525288, EXMP_CP_RC_LOWEST.exemptiontyperc#12525289, ... 17 more fields]\n                  :     +- SubqueryAlias EXMP_CP_RC_LOWEST\n                  :        +- Project [baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, globalcounterpartyidentifier#12525405, intercompanyflag#12525406, lastperformingpdmodelcode#12525407, liabilitypercentage#12525408, participatingcounterparty#12525409, participatingcounterpartysourcesystemidentifier#12525410, pdmodelcode#12525411, reportingdate#12525412, sourcedexemptionid#12525413, monotonically_increasing_id() AS idx#12525435L]\n                  :           +- Project [EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525366 AS baselcreditriskapproach#12525394, EXMP_CP_RC_LOWEST.counterpartyid#12525367 AS counterpartyid#12525395, EXMP_CP_RC_LOWEST.counterpartyrole#12525368 AS counterpartyrole#12525396, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525369 AS counterpartysourcesystemidentifier#12525397, EXMP_CP_RC_LOWEST.creditfacility#12525370 AS creditfacility#12525398, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525371 AS creditfacilitysourcesystemidentifier#12525399, EXMP_CP_RC_LOWEST.deliveryentity#12525372 AS deliveryentity#12525400, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525373 AS exemptionconditionidrc#12525401, EXMP_CP_RC_LOWEST.exemptionidrc#12525374 AS exemptionidrc#12525402, EXMP_CP_RC_LOWEST.exemptionnamerc#12525375 AS exemptionnamerc#12525403, EXMP_CP_RC_LOWEST.exemptiontyperc#12525376 AS exemptiontyperc#12525404, EXMP_CP_RC_LOWEST.globalcounterpartyidentifier#12525377 AS globalcounterpartyidentifier#12525405, EXMP_CP_RC_LOWEST.intercompanyflag#12525378 AS intercompanyflag#12525406, EXMP_CP_RC_LOWEST.lastperformingpdmodelcode#12525379 AS lastperformingpdmodelcode#12525407, EXMP_CP_RC_LOWEST.liabilitypercentage#12525380 AS liabilitypercentage#12525408, EXMP_CP_RC_LOWEST.participatingcounterparty#12525381 AS participatingcounterparty#12525409, EXMP_CP_RC_LOWEST.participatingcounterpartysourcesystemidentifier#12525382 AS participatingcounterpartysourcesystemidentifier#12525410, EXMP_CP_RC_LOWEST.pdmodelcode#12525383 AS pdmodelcode#12525411, EXMP_CP_RC_LOWEST.reportingdate#12525384 AS reportingdate#12525412, EXMP_CP_RC_LOWEST.sourcedexemptionid#12525385 AS sourcedexemptionid#12525413]\n                  :              +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525352, EXMP_CP_RC.counterpartyid#12525353, EXMP_CP_RC.counterpartysourcesystemidentifier#12525354, EXMP_CP_RC.deliveryentity#12525355, EXMP_CP_RC.exemptionconditionidrc#12525356, EXMP_CP_RC.exemptionidrc#12525357, EXMP_CP_RC.exemptionnamerc#12525358, EXMP_CP_RC.exemptiontyperc#12525359, EXMP_CP_RC.globalcounterpartyidentifier#12525360, EXMP_CP_RC.intercompanyflag#12525361, EXMP_CP_RC.lastperformingpdmodelcode#12525362, EXMP_CP_RC.pdmodelcode#12525363, EXMP_CP_RC.reportingdate#12525364, EXMP_CP_RC.sourcedexemptionid#12525365, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525366, EXMP_CP_RC_LOWEST.counterpartyid#12525367, EXMP_CP_RC_LOWEST.counterpartyrole#12525368, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525369, EXMP_CP_RC_LOWEST.creditfacility#12525370, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525371, EXMP_CP_RC_LOWEST.deliveryentity#12525372, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525373, EXMP_CP_RC_LOWEST.exemptionidrc#12525374, EXMP_CP_RC_LOWEST.exemptionnamerc#12525375, EXMP_CP_RC_LOWEST.exemptiontyperc#12525376, ... 17 more fields]\n                  +- SubqueryAlias INT_CF_LINKS\n                     +- Project [counterpartyrole#12525499, creditfacility#12525500, creditfacilitysourcesystemidentifier#12525501, deliveryentity#12525502, liabilitypercentage#12525503, participatingcounterparty#12525504, participatingcounterpartysourcesystemidentifier#12525505, reportingdate#12525506, monotonically_increasing_id() AS idx#12525516L]\n                        +- Project [INT_CF_LINKS.counterpartyrole#12525491 AS counterpartyrole#12525499, INT_CF_LINKS.creditfacility#12525492 AS creditfacility#12525500, INT_CF_LINKS.creditfacilitysourcesystemidentifier#12525493 AS creditfacilitysourcesystemidentifier#12525501, INT_CF_LINKS.deliveryentity#12525494 AS deliveryentity#12525502, INT_CF_LINKS.liabilitypercentage#12525495 AS liabilitypercentage#12525503, INT_CF_LINKS.participatingcounterparty#12525496 AS participatingcounterparty#12525504, INT_CF_LINKS.participatingcounterpartysourcesystemidentifier#12525497 AS participatingcounterpartysourcesystemidentifier#12525505, INT_CF_LINKS.reportingdate#12525498 AS reportingdate#12525506]\n                           +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525457, EXMP_CP_RC.counterpartyid#12525458, EXMP_CP_RC.counterpartysourcesystemidentifier#12525459, EXMP_CP_RC.deliveryentity#12525460, EXMP_CP_RC.exemptionconditionidrc#12525461, EXMP_CP_RC.exemptionidrc#12525462, EXMP_CP_RC.exemptionnamerc#12525463, EXMP_CP_RC.exemptiontyperc#12525464, EXMP_CP_RC.globalcounterpartyidentifier#12525465, EXMP_CP_RC.intercompanyflag#12525466, EXMP_CP_RC.lastperformingpdmodelcode#12525467, EXMP_CP_RC.pdmodelcode#12525468, EXMP_CP_RC.reportingdate#12525469, EXMP_CP_RC.sourcedexemptionid#12525470, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525471, EXMP_CP_RC_LOWEST.counterpartyid#12525472, EXMP_CP_RC_LOWEST.counterpartyrole#12525473, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525474, EXMP_CP_RC_LOWEST.creditfacility#12525475, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525476, EXMP_CP_RC_LOWEST.deliveryentity#12525477, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525478, EXMP_CP_RC_LOWEST.exemptionidrc#12525479, EXMP_CP_RC_LOWEST.exemptionnamerc#12525480, EXMP_CP_RC_LOWEST.exemptiontyperc#12525481, ... 17 more fields]\n\n\nJVM stacktrace:\norg.apache.spark.sql.catalyst.ExtendedAnalysisException\n\tat org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)\n\tat scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)\n\tat scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:933)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:416)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:416)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:478)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:478)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:294)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:668)\n\tat org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:151)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$4(QueryExecution.scala:668)\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1307)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:661)\n\tat com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:658)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:658)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:288)\n\tat com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:287)\n\tat scala.util.Try$.apply(Try.scala:210)\n\tat org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)\n\tat org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)\n\tat org.apache.spark.util.LazyTry.get(LazyTry.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:321)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:267)\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)\n\tat org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)\n\tat org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)\n\tat org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)\n\tat org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)\n\tat org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)\n\tat org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)\n\tat com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)\n\tat com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)\n\tat scala.util.Using$.resource(Using.scala:261)\n\tat com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)", "context": {"errorClass": "UNRESOLVED_COLUMN.WITH_SUGGESTION"}, "exception": {"class": "_MultiThreadedRendezvous", "msg": "<_MultiThreadedRendezvous of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`LocalFacilityIdentifier` cannot be resolved. Did you mean one of the following? [`INT_CF_LINKS`.`deliveryentity`, `INT_CF_LINKS`.`liabilitypercentage`, `EXMP_CP_RC`.`deliveryentity`, `EXMP_CP_RC`.`pdmodelcode`, `rank_num_Processid_RC`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 19 more fields]\n      +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 18 more fields]\n         +- Project [baselcreditriskapproach#12525307, counterpartyid#125...\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_message:\"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`LocalFacilityIdentifier` cannot be resolved. Did you mean one of the following? [`INT_CF_LINKS`.`deliveryentity`, `INT_CF_LINKS`.`liabilitypercentage`, `EXMP_CP_RC`.`deliveryentity`, `EXMP_CP_RC`.`pdmodelcode`, `rank_num_Processid_RC`]. SQLSTATE: 42703; line 1 pos 0;\\n\\'GlobalLimit 1\\n+- \\'LocalLimit 1\\n   +- \\'Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 19 more fields]\\n      +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 18 more fields]\\n         +- Project [baselcreditriskapproach#12525307, counterpartyid#125...\", grpc_status:13, created_time:\"2025-08-12T09:22:34.023322859+00:00\"}\"\n>", "stacktrace": [{"class": null, "method": "_execute_and_fetch_as_iterator", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "1932"}, {"class": null, "method": "__next__", "file": "<frozen _collections_abc>", "line": "356"}, {"class": null, "method": "send", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "141"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "202"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "174"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "307"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "279"}, {"class": null, "method": "<lambda>", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "175"}, {"class": null, "method": "__iter__", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "658"}, {"class": null, "method": "__next__", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "540"}, {"class": null, "method": "_next", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "966"}]}}
2025-08-12 09:22:34 [ERROR] _log:  [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`LocalFacilityIdentifier` cannot be resolved. Did you mean one of the following? [`INT_CF_LINKS`.`deliveryentity`, `INT_CF_LINKS`.`liabilitypercentage`, `EXMP_CP_RC`.`deliveryentity`, `EXMP_CP_RC`.`pdmodelcode`, `rank_num_Processid_RC`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 19 more fields]
      +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 18 more fields]
         +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 17 more fields]
            +- Project [idx#12525336L, baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, ... 18 more fields]
               +- Join LeftOuter, (idx#12525336L = idx#12525516L)
                  :- Project [idx#12525336L, baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, ... 10 more fields]
                  :  +- Join LeftOuter, (idx#12525336L = idx#12525435L)
                  :     :- SubqueryAlias EXMP_CP_RC
                  :     :  +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, monotonically_increasing_id() AS idx#12525336L]
                  :     :     +- Project [EXMP_CP_RC.baselcreditriskapproach#12525265 AS baselcreditriskapproach#12525307, EXMP_CP_RC.counterpartyid#12525266 AS counterpartyid#12525308, EXMP_CP_RC.counterpartysourcesystemidentifier#12525267 AS counterpartysourcesystemidentifier#12525309, EXMP_CP_RC.deliveryentity#12525268 AS deliveryentity#12525310, EXMP_CP_RC.exemptionconditionidrc#12525269 AS exemptionconditionidrc#12525311, EXMP_CP_RC.exemptionidrc#12525270 AS exemptionidrc#12525312, EXMP_CP_RC.exemptionnamerc#12525271 AS exemptionnamerc#12525313, EXMP_CP_RC.exemptiontyperc#12525272 AS exemptiontyperc#12525314, EXMP_CP_RC.globalcounterpartyidentifier#12525273 AS globalcounterpartyidentifier#12525315, EXMP_CP_RC.intercompanyflag#12525274 AS intercompanyflag#12525316, EXMP_CP_RC.lastperformingpdmodelcode#12525275 AS lastperformingpdmodelcode#12525317, EXMP_CP_RC.pdmodelcode#12525276 AS pdmodelcode#12525318, EXMP_CP_RC.reportingdate#12525277 AS reportingdate#12525319, EXMP_CP_RC.sourcedexemptionid#12525278 AS sourcedexemptionid#12525320]
                  :     :        +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525265, EXMP_CP_RC.counterpartyid#12525266, EXMP_CP_RC.counterpartysourcesystemidentifier#12525267, EXMP_CP_RC.deliveryentity#12525268, EXMP_CP_RC.exemptionconditionidrc#12525269, EXMP_CP_RC.exemptionidrc#12525270, EXMP_CP_RC.exemptionnamerc#12525271, EXMP_CP_RC.exemptiontyperc#12525272, EXMP_CP_RC.globalcounterpartyidentifier#12525273, EXMP_CP_RC.intercompanyflag#12525274, EXMP_CP_RC.lastperformingpdmodelcode#12525275, EXMP_CP_RC.pdmodelcode#12525276, EXMP_CP_RC.reportingdate#12525277, EXMP_CP_RC.sourcedexemptionid#12525278, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525279, EXMP_CP_RC_LOWEST.counterpartyid#12525280, EXMP_CP_RC_LOWEST.counterpartyrole#12525281, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525282, EXMP_CP_RC_LOWEST.creditfacility#12525283, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525284, EXMP_CP_RC_LOWEST.deliveryentity#12525285, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525286, EXMP_CP_RC_LOWEST.exemptionidrc#12525287, EXMP_CP_RC_LOWEST.exemptionnamerc#12525288, EXMP_CP_RC_LOWEST.exemptiontyperc#12525289, ... 17 more fields]
                  :     +- SubqueryAlias EXMP_CP_RC_LOWEST
                  :        +- Project [baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, globalcounterpartyidentifier#12525405, intercompanyflag#12525406, lastperformingpdmodelcode#12525407, liabilitypercentage#12525408, participatingcounterparty#12525409, participatingcounterpartysourcesystemidentifier#12525410, pdmodelcode#12525411, reportingdate#12525412, sourcedexemptionid#12525413, monotonically_increasing_id() AS idx#12525435L]
                  :           +- Project [EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525366 AS baselcreditriskapproach#12525394, EXMP_CP_RC_LOWEST.counterpartyid#12525367 AS counterpartyid#12525395, EXMP_CP_RC_LOWEST.counterpartyrole#12525368 AS counterpartyrole#12525396, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525369 AS counterpartysourcesystemidentifier#12525397, EXMP_CP_RC_LOWEST.creditfacility#12525370 AS creditfacility#12525398, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525371 AS creditfacilitysourcesystemidentifier#12525399, EXMP_CP_RC_LOWEST.deliveryentity#12525372 AS deliveryentity#12525400, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525373 AS exemptionconditionidrc#12525401, EXMP_CP_RC_LOWEST.exemptionidrc#12525374 AS exemptionidrc#12525402, EXMP_CP_RC_LOWEST.exemptionnamerc#12525375 AS exemptionnamerc#12525403, EXMP_CP_RC_LOWEST.exemptiontyperc#12525376 AS exemptiontyperc#12525404, EXMP_CP_RC_LOWEST.globalcounterpartyidentifier#12525377 AS globalcounterpartyidentifier#12525405, EXMP_CP_RC_LOWEST.intercompanyflag#12525378 AS intercompanyflag#12525406, EXMP_CP_RC_LOWEST.lastperformingpdmodelcode#12525379 AS lastperformingpdmodelcode#12525407, EXMP_CP_RC_LOWEST.liabilitypercentage#12525380 AS liabilitypercentage#12525408, EXMP_CP_RC_LOWEST.participatingcounterparty#12525381 AS participatingcounterparty#12525409, EXMP_CP_RC_LOWEST.participatingcounterpartysourcesystemidentifier#12525382 AS participatingcounterpartysourcesystemidentifier#12525410, EXMP_CP_RC_LOWEST.pdmodelcode#12525383 AS pdmodelcode#12525411, EXMP_CP_RC_LOWEST.reportingdate#12525384 AS reportingdate#12525412, EXMP_CP_RC_LOWEST.sourcedexemptionid#12525385 AS sourcedexemptionid#12525413]
                  :              +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525352, EXMP_CP_RC.counterpartyid#12525353, EXMP_CP_RC.counterpartysourcesystemidentifier#12525354, EXMP_CP_RC.deliveryentity#12525355, EXMP_CP_RC.exemptionconditionidrc#12525356, EXMP_CP_RC.exemptionidrc#12525357, EXMP_CP_RC.exemptionnamerc#12525358, EXMP_CP_RC.exemptiontyperc#12525359, EXMP_CP_RC.globalcounterpartyidentifier#12525360, EXMP_CP_RC.intercompanyflag#12525361, EXMP_CP_RC.lastperformingpdmodelcode#12525362, EXMP_CP_RC.pdmodelcode#12525363, EXMP_CP_RC.reportingdate#12525364, EXMP_CP_RC.sourcedexemptionid#12525365, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525366, EXMP_CP_RC_LOWEST.counterpartyid#12525367, EXMP_CP_RC_LOWEST.counterpartyrole#12525368, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525369, EXMP_CP_RC_LOWEST.creditfacility#12525370, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525371, EXMP_CP_RC_LOWEST.deliveryentity#12525372, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525373, EXMP_CP_RC_LOWEST.exemptionidrc#12525374, EXMP_CP_RC_LOWEST.exemptionnamerc#12525375, EXMP_CP_RC_LOWEST.exemptiontyperc#12525376, ... 17 more fields]
                  +- SubqueryAlias INT_CF_LINKS
                     +- Project [counterpartyrole#12525499, creditfacility#12525500, creditfacilitysourcesystemidentifier#12525501, deliveryentity#12525502, liabilitypercentage#12525503, participatingcounterparty#12525504, participatingcounterpartysourcesystemidentifier#12525505, reportingdate#12525506, monotonically_increasing_id() AS idx#12525516L]
                        +- Project [INT_CF_LINKS.counterpartyrole#12525491 AS counterpartyrole#12525499, INT_CF_LINKS.creditfacility#12525492 AS creditfacility#12525500, INT_CF_LINKS.creditfacilitysourcesystemidentifier#12525493 AS creditfacilitysourcesystemidentifier#12525501, INT_CF_LINKS.deliveryentity#12525494 AS deliveryentity#12525502, INT_CF_LINKS.liabilitypercentage#12525495 AS liabilitypercentage#12525503, INT_CF_LINKS.participatingcounterparty#12525496 AS participatingcounterparty#12525504, INT_CF_LINKS.participatingcounterpartysourcesystemidentifier#12525497 AS participatingcounterpartysourcesystemidentifier#12525505, INT_CF_LINKS.reportingdate#12525498 AS reportingdate#12525506]
                           +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525457, EXMP_CP_RC.counterpartyid#12525458, EXMP_CP_RC.counterpartysourcesystemidentifier#12525459, EXMP_CP_RC.deliveryentity#12525460, EXMP_CP_RC.exemptionconditionidrc#12525461, EXMP_CP_RC.exemptionidrc#12525462, EXMP_CP_RC.exemptionnamerc#12525463, EXMP_CP_RC.exemptiontyperc#12525464, EXMP_CP_RC.globalcounterpartyidentifier#12525465, EXMP_CP_RC.intercompanyflag#12525466, EXMP_CP_RC.lastperformingpdmodelcode#12525467, EXMP_CP_RC.pdmodelcode#12525468, EXMP_CP_RC.reportingdate#12525469, EXMP_CP_RC.sourcedexemptionid#12525470, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525471, EXMP_CP_RC_LOWEST.counterpartyid#12525472, EXMP_CP_RC_LOWEST.counterpartyrole#12525473, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525474, EXMP_CP_RC_LOWEST.creditfacility#12525475, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525476, EXMP_CP_RC_LOWEST.deliveryentity#12525477, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525478, EXMP_CP_RC_LOWEST.exemptionidrc#12525479, EXMP_CP_RC_LOWEST.exemptionnamerc#12525480, EXMP_CP_RC_LOWEST.exemptiontyperc#12525481, ... 17 more fields]


JVM stacktrace:
org.apache.spark.sql.catalyst.ExtendedAnalysisException
	at org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:416)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:416)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:478)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:478)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:294)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:668)
	at org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:151)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$4(QueryExecution.scala:668)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1307)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:661)
	at com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:658)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:658)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:288)
	at com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:287)
	at scala.util.Try$.apply(Try.scala:210)
	at org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)
	at org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)
	at org.apache.spark.util.LazyTry.get(LazyTry.scala:58)
	at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:321)
	at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:267)
	at org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)
	at org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)
	at org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)
	at org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)
	at org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)
	at org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)
	at scala.util.Using$.resource(Using.scala:261)
	at com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)
Traceback (most recent call last):
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 1932, in _execute_and_fetch_as_iterator
    for b in generator:
  File "<frozen _collections_abc>", line 356, in __next__
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 141, in send
    if not self._has_next():
           ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 202, in _has_next
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 174, in _has_next
    self._current = self._call_iter(
                    ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 307, in _call_iter
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 279, in _call_iter
    return iter_fun()
           ^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 175, in <lambda>
    lambda: next(self._iterator)  # type: ignore[arg-type]
            ^^^^^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 658, in __iter__
    for response in self._call:
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 540, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 966, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.INTERNAL
	details = "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`LocalFacilityIdentifier` cannot be resolved. Did you mean one of the following? [`INT_CF_LINKS`.`deliveryentity`, `INT_CF_LINKS`.`liabilitypercentage`, `EXMP_CP_RC`.`deliveryentity`, `EXMP_CP_RC`.`pdmodelcode`, `rank_num_Processid_RC`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 19 more fields]
      +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 18 more fields]
         +- Project [baselcreditriskapproach#12525307, counterpartyid#125..."
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_message:"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`LocalFacilityIdentifier` cannot be resolved. Did you mean one of the following? [`INT_CF_LINKS`.`deliveryentity`, `INT_CF_LINKS`.`liabilitypercentage`, `EXMP_CP_RC`.`deliveryentity`, `EXMP_CP_RC`.`pdmodelcode`, `rank_num_Processid_RC`]. SQLSTATE: 42703; line 1 pos 0;\n\'GlobalLimit 1\n+- \'LocalLimit 1\n   +- \'Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 19 more fields]\n      +- Project [baselcreditriskapproach#12525307, counterpartyid#12525308, counterpartysourcesystemidentifier#12525309, deliveryentity#12525310, exemptionconditionidrc#12525311, exemptionidrc#12525312, exemptionnamerc#12525313, exemptiontyperc#12525314, globalcounterpartyidentifier#12525315, intercompanyflag#12525316, lastperformingpdmodelcode#12525317, pdmodelcode#12525318, reportingdate#12525319, sourcedexemptionid#12525320, baselcreditriskapproach#12525394, counterpartyid#12525395, counterpartyrole#12525396, counterpartysourcesystemidentifier#12525397, creditfacility#12525398, creditfacilitysourcesystemidentifier#12525399, deliveryentity#12525400, exemptionconditionidrc#12525401, exemptionidrc#12525402, exemptionnamerc#12525403, exemptiontyperc#12525404, ... 18 more fields]\n         +- Project [baselcreditriskapproach#12525307, counterpartyid#125...", grpc_status:13, created_time:"2025-08-12T09:22:34.023322859+00:00"}"
>
{"ts": "2025-08-12 09:22:34.125", "level": "ERROR", "logger": "SQLQueryContextLogger", "msg": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`SourceSystemIdentifier` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC`.`pdmodelcode`, `EXMP_CP_RC`.`exemptionidrc`, `rank_num_Processid_RC`, `EXMP_CP_RC`.`deliveryentity`, `INT_CF_LINKS`.`deliveryentity`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 19 more fields]\n      +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 18 more fields]\n         +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 17 more fields]\n            +- Project [idx#12525774L, baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, ... 18 more fields]\n               +- Join LeftOuter, (idx#12525774L = idx#12525954L)\n                  :- Project [idx#12525774L, baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, ... 10 more fields]\n                  :  +- Join LeftOuter, (idx#12525774L = idx#12525873L)\n                  :     :- SubqueryAlias EXMP_CP_RC\n                  :     :  +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, monotonically_increasing_id() AS idx#12525774L]\n                  :     :     +- Project [EXMP_CP_RC.baselcreditriskapproach#12525703 AS baselcreditriskapproach#12525745, EXMP_CP_RC.counterpartyid#12525704 AS counterpartyid#12525746, EXMP_CP_RC.counterpartysourcesystemidentifier#12525705 AS counterpartysourcesystemidentifier#12525747, EXMP_CP_RC.deliveryentity#12525706 AS deliveryentity#12525748, EXMP_CP_RC.exemptionconditionidrc#12525707 AS exemptionconditionidrc#12525749, EXMP_CP_RC.exemptionidrc#12525708 AS exemptionidrc#12525750, EXMP_CP_RC.exemptionnamerc#12525709 AS exemptionnamerc#12525751, EXMP_CP_RC.exemptiontyperc#12525710 AS exemptiontyperc#12525752, EXMP_CP_RC.globalcounterpartyidentifier#12525711 AS globalcounterpartyidentifier#12525753, EXMP_CP_RC.intercompanyflag#12525712 AS intercompanyflag#12525754, EXMP_CP_RC.lastperformingpdmodelcode#12525713 AS lastperformingpdmodelcode#12525755, EXMP_CP_RC.pdmodelcode#12525714 AS pdmodelcode#12525756, EXMP_CP_RC.reportingdate#12525715 AS reportingdate#12525757, EXMP_CP_RC.sourcedexemptionid#12525716 AS sourcedexemptionid#12525758]\n                  :     :        +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525703, EXMP_CP_RC.counterpartyid#12525704, EXMP_CP_RC.counterpartysourcesystemidentifier#12525705, EXMP_CP_RC.deliveryentity#12525706, EXMP_CP_RC.exemptionconditionidrc#12525707, EXMP_CP_RC.exemptionidrc#12525708, EXMP_CP_RC.exemptionnamerc#12525709, EXMP_CP_RC.exemptiontyperc#12525710, EXMP_CP_RC.globalcounterpartyidentifier#12525711, EXMP_CP_RC.intercompanyflag#12525712, EXMP_CP_RC.lastperformingpdmodelcode#12525713, EXMP_CP_RC.pdmodelcode#12525714, EXMP_CP_RC.reportingdate#12525715, EXMP_CP_RC.sourcedexemptionid#12525716, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525717, EXMP_CP_RC_LOWEST.counterpartyid#12525718, EXMP_CP_RC_LOWEST.counterpartyrole#12525719, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525720, EXMP_CP_RC_LOWEST.creditfacility#12525721, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525722, EXMP_CP_RC_LOWEST.deliveryentity#12525723, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525724, EXMP_CP_RC_LOWEST.exemptionidrc#12525725, EXMP_CP_RC_LOWEST.exemptionnamerc#12525726, EXMP_CP_RC_LOWEST.exemptiontyperc#12525727, ... 17 more fields]\n                  :     +- SubqueryAlias EXMP_CP_RC_LOWEST\n                  :        +- Project [baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, globalcounterpartyidentifier#12525843, intercompanyflag#12525844, lastperformingpdmodelcode#12525845, liabilitypercentage#12525846, participatingcounterparty#12525847, participatingcounterpartysourcesystemidentifier#12525848, pdmodelcode#12525849, reportingdate#12525850, sourcedexemptionid#12525851, monotonically_increasing_id() AS idx#12525873L]\n                  :           +- Project [EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525804 AS baselcreditriskapproach#12525832, EXMP_CP_RC_LOWEST.counterpartyid#12525805 AS counterpartyid#12525833, EXMP_CP_RC_LOWEST.counterpartyrole#12525806 AS counterpartyrole#12525834, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525807 AS counterpartysourcesystemidentifier#12525835, EXMP_CP_RC_LOWEST.creditfacility#12525808 AS creditfacility#12525836, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525809 AS creditfacilitysourcesystemidentifier#12525837, EXMP_CP_RC_LOWEST.deliveryentity#12525810 AS deliveryentity#12525838, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525811 AS exemptionconditionidrc#12525839, EXMP_CP_RC_LOWEST.exemptionidrc#12525812 AS exemptionidrc#12525840, EXMP_CP_RC_LOWEST.exemptionnamerc#12525813 AS exemptionnamerc#12525841, EXMP_CP_RC_LOWEST.exemptiontyperc#12525814 AS exemptiontyperc#12525842, EXMP_CP_RC_LOWEST.globalcounterpartyidentifier#12525815 AS globalcounterpartyidentifier#12525843, EXMP_CP_RC_LOWEST.intercompanyflag#12525816 AS intercompanyflag#12525844, EXMP_CP_RC_LOWEST.lastperformingpdmodelcode#12525817 AS lastperformingpdmodelcode#12525845, EXMP_CP_RC_LOWEST.liabilitypercentage#12525818 AS liabilitypercentage#12525846, EXMP_CP_RC_LOWEST.participatingcounterparty#12525819 AS participatingcounterparty#12525847, EXMP_CP_RC_LOWEST.participatingcounterpartysourcesystemidentifier#12525820 AS participatingcounterpartysourcesystemidentifier#12525848, EXMP_CP_RC_LOWEST.pdmodelcode#12525821 AS pdmodelcode#12525849, EXMP_CP_RC_LOWEST.reportingdate#12525822 AS reportingdate#12525850, EXMP_CP_RC_LOWEST.sourcedexemptionid#12525823 AS sourcedexemptionid#12525851]\n                  :              +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525790, EXMP_CP_RC.counterpartyid#12525791, EXMP_CP_RC.counterpartysourcesystemidentifier#12525792, EXMP_CP_RC.deliveryentity#12525793, EXMP_CP_RC.exemptionconditionidrc#12525794, EXMP_CP_RC.exemptionidrc#12525795, EXMP_CP_RC.exemptionnamerc#12525796, EXMP_CP_RC.exemptiontyperc#12525797, EXMP_CP_RC.globalcounterpartyidentifier#12525798, EXMP_CP_RC.intercompanyflag#12525799, EXMP_CP_RC.lastperformingpdmodelcode#12525800, EXMP_CP_RC.pdmodelcode#12525801, EXMP_CP_RC.reportingdate#12525802, EXMP_CP_RC.sourcedexemptionid#12525803, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525804, EXMP_CP_RC_LOWEST.counterpartyid#12525805, EXMP_CP_RC_LOWEST.counterpartyrole#12525806, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525807, EXMP_CP_RC_LOWEST.creditfacility#12525808, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525809, EXMP_CP_RC_LOWEST.deliveryentity#12525810, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525811, EXMP_CP_RC_LOWEST.exemptionidrc#12525812, EXMP_CP_RC_LOWEST.exemptionnamerc#12525813, EXMP_CP_RC_LOWEST.exemptiontyperc#12525814, ... 17 more fields]\n                  +- SubqueryAlias INT_CF_LINKS\n                     +- Project [counterpartyrole#12525937, creditfacility#12525938, creditfacilitysourcesystemidentifier#12525939, deliveryentity#12525940, liabilitypercentage#12525941, participatingcounterparty#12525942, participatingcounterpartysourcesystemidentifier#12525943, reportingdate#12525944, monotonically_increasing_id() AS idx#12525954L]\n                        +- Project [INT_CF_LINKS.counterpartyrole#12525929 AS counterpartyrole#12525937, INT_CF_LINKS.creditfacility#12525930 AS creditfacility#12525938, INT_CF_LINKS.creditfacilitysourcesystemidentifier#12525931 AS creditfacilitysourcesystemidentifier#12525939, INT_CF_LINKS.deliveryentity#12525932 AS deliveryentity#12525940, INT_CF_LINKS.liabilitypercentage#12525933 AS liabilitypercentage#12525941, INT_CF_LINKS.participatingcounterparty#12525934 AS participatingcounterparty#12525942, INT_CF_LINKS.participatingcounterpartysourcesystemidentifier#12525935 AS participatingcounterpartysourcesystemidentifier#12525943, INT_CF_LINKS.reportingdate#12525936 AS reportingdate#12525944]\n                           +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525895, EXMP_CP_RC.counterpartyid#12525896, EXMP_CP_RC.counterpartysourcesystemidentifier#12525897, EXMP_CP_RC.deliveryentity#12525898, EXMP_CP_RC.exemptionconditionidrc#12525899, EXMP_CP_RC.exemptionidrc#12525900, EXMP_CP_RC.exemptionnamerc#12525901, EXMP_CP_RC.exemptiontyperc#12525902, EXMP_CP_RC.globalcounterpartyidentifier#12525903, EXMP_CP_RC.intercompanyflag#12525904, EXMP_CP_RC.lastperformingpdmodelcode#12525905, EXMP_CP_RC.pdmodelcode#12525906, EXMP_CP_RC.reportingdate#12525907, EXMP_CP_RC.sourcedexemptionid#12525908, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525909, EXMP_CP_RC_LOWEST.counterpartyid#12525910, EXMP_CP_RC_LOWEST.counterpartyrole#12525911, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525912, EXMP_CP_RC_LOWEST.creditfacility#12525913, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525914, EXMP_CP_RC_LOWEST.deliveryentity#12525915, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525916, EXMP_CP_RC_LOWEST.exemptionidrc#12525917, EXMP_CP_RC_LOWEST.exemptionnamerc#12525918, EXMP_CP_RC_LOWEST.exemptiontyperc#12525919, ... 17 more fields]\n\n\nJVM stacktrace:\norg.apache.spark.sql.catalyst.ExtendedAnalysisException\n\tat org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)\n\tat scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)\n\tat scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:933)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:416)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:416)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:478)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:478)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:294)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:668)\n\tat org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:151)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$4(QueryExecution.scala:668)\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1307)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:661)\n\tat com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:658)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:658)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:288)\n\tat com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:287)\n\tat scala.util.Try$.apply(Try.scala:210)\n\tat org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)\n\tat org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)\n\tat org.apache.spark.util.LazyTry.get(LazyTry.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:321)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:267)\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)\n\tat org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)\n\tat org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)\n\tat org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)\n\tat org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)\n\tat org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)\n\tat org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)\n\tat com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)\n\tat com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)\n\tat scala.util.Using$.resource(Using.scala:261)\n\tat com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)", "context": {"errorClass": "UNRESOLVED_COLUMN.WITH_SUGGESTION"}, "exception": {"class": "_MultiThreadedRendezvous", "msg": "<_MultiThreadedRendezvous of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`SourceSystemIdentifier` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC`.`pdmodelcode`, `EXMP_CP_RC`.`exemptionidrc`, `rank_num_Processid_RC`, `EXMP_CP_RC`.`deliveryentity`, `INT_CF_LINKS`.`deliveryentity`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 19 more fields]\n      +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 18 more fields]\n         +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, co...\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {created_time:\"2025-08-12T09:22:34.118559272+00:00\", grpc_status:13, grpc_message:\"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`SourceSystemIdentifier` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC`.`pdmodelcode`, `EXMP_CP_RC`.`exemptionidrc`, `rank_num_Processid_RC`, `EXMP_CP_RC`.`deliveryentity`, `INT_CF_LINKS`.`deliveryentity`]. SQLSTATE: 42703; line 1 pos 0;\\n\\'GlobalLimit 1\\n+- \\'LocalLimit 1\\n   +- \\'Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 19 more fields]\\n      +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 18 more fields]\\n         +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, co...\"}\"\n>", "stacktrace": [{"class": null, "method": "_execute_and_fetch_as_iterator", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "1932"}, {"class": null, "method": "__next__", "file": "<frozen _collections_abc>", "line": "356"}, {"class": null, "method": "send", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "141"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "202"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "174"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "307"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "279"}, {"class": null, "method": "<lambda>", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "175"}, {"class": null, "method": "__iter__", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "658"}, {"class": null, "method": "__next__", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "540"}, {"class": null, "method": "_next", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "966"}]}}
2025-08-12 09:22:34 [ERROR] _log:  [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`SourceSystemIdentifier` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC`.`pdmodelcode`, `EXMP_CP_RC`.`exemptionidrc`, `rank_num_Processid_RC`, `EXMP_CP_RC`.`deliveryentity`, `INT_CF_LINKS`.`deliveryentity`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 19 more fields]
      +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 18 more fields]
         +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 17 more fields]
            +- Project [idx#12525774L, baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, ... 18 more fields]
               +- Join LeftOuter, (idx#12525774L = idx#12525954L)
                  :- Project [idx#12525774L, baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, ... 10 more fields]
                  :  +- Join LeftOuter, (idx#12525774L = idx#12525873L)
                  :     :- SubqueryAlias EXMP_CP_RC
                  :     :  +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, monotonically_increasing_id() AS idx#12525774L]
                  :     :     +- Project [EXMP_CP_RC.baselcreditriskapproach#12525703 AS baselcreditriskapproach#12525745, EXMP_CP_RC.counterpartyid#12525704 AS counterpartyid#12525746, EXMP_CP_RC.counterpartysourcesystemidentifier#12525705 AS counterpartysourcesystemidentifier#12525747, EXMP_CP_RC.deliveryentity#12525706 AS deliveryentity#12525748, EXMP_CP_RC.exemptionconditionidrc#12525707 AS exemptionconditionidrc#12525749, EXMP_CP_RC.exemptionidrc#12525708 AS exemptionidrc#12525750, EXMP_CP_RC.exemptionnamerc#12525709 AS exemptionnamerc#12525751, EXMP_CP_RC.exemptiontyperc#12525710 AS exemptiontyperc#12525752, EXMP_CP_RC.globalcounterpartyidentifier#12525711 AS globalcounterpartyidentifier#12525753, EXMP_CP_RC.intercompanyflag#12525712 AS intercompanyflag#12525754, EXMP_CP_RC.lastperformingpdmodelcode#12525713 AS lastperformingpdmodelcode#12525755, EXMP_CP_RC.pdmodelcode#12525714 AS pdmodelcode#12525756, EXMP_CP_RC.reportingdate#12525715 AS reportingdate#12525757, EXMP_CP_RC.sourcedexemptionid#12525716 AS sourcedexemptionid#12525758]
                  :     :        +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525703, EXMP_CP_RC.counterpartyid#12525704, EXMP_CP_RC.counterpartysourcesystemidentifier#12525705, EXMP_CP_RC.deliveryentity#12525706, EXMP_CP_RC.exemptionconditionidrc#12525707, EXMP_CP_RC.exemptionidrc#12525708, EXMP_CP_RC.exemptionnamerc#12525709, EXMP_CP_RC.exemptiontyperc#12525710, EXMP_CP_RC.globalcounterpartyidentifier#12525711, EXMP_CP_RC.intercompanyflag#12525712, EXMP_CP_RC.lastperformingpdmodelcode#12525713, EXMP_CP_RC.pdmodelcode#12525714, EXMP_CP_RC.reportingdate#12525715, EXMP_CP_RC.sourcedexemptionid#12525716, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525717, EXMP_CP_RC_LOWEST.counterpartyid#12525718, EXMP_CP_RC_LOWEST.counterpartyrole#12525719, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525720, EXMP_CP_RC_LOWEST.creditfacility#12525721, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525722, EXMP_CP_RC_LOWEST.deliveryentity#12525723, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525724, EXMP_CP_RC_LOWEST.exemptionidrc#12525725, EXMP_CP_RC_LOWEST.exemptionnamerc#12525726, EXMP_CP_RC_LOWEST.exemptiontyperc#12525727, ... 17 more fields]
                  :     +- SubqueryAlias EXMP_CP_RC_LOWEST
                  :        +- Project [baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, globalcounterpartyidentifier#12525843, intercompanyflag#12525844, lastperformingpdmodelcode#12525845, liabilitypercentage#12525846, participatingcounterparty#12525847, participatingcounterpartysourcesystemidentifier#12525848, pdmodelcode#12525849, reportingdate#12525850, sourcedexemptionid#12525851, monotonically_increasing_id() AS idx#12525873L]
                  :           +- Project [EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525804 AS baselcreditriskapproach#12525832, EXMP_CP_RC_LOWEST.counterpartyid#12525805 AS counterpartyid#12525833, EXMP_CP_RC_LOWEST.counterpartyrole#12525806 AS counterpartyrole#12525834, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525807 AS counterpartysourcesystemidentifier#12525835, EXMP_CP_RC_LOWEST.creditfacility#12525808 AS creditfacility#12525836, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525809 AS creditfacilitysourcesystemidentifier#12525837, EXMP_CP_RC_LOWEST.deliveryentity#12525810 AS deliveryentity#12525838, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525811 AS exemptionconditionidrc#12525839, EXMP_CP_RC_LOWEST.exemptionidrc#12525812 AS exemptionidrc#12525840, EXMP_CP_RC_LOWEST.exemptionnamerc#12525813 AS exemptionnamerc#12525841, EXMP_CP_RC_LOWEST.exemptiontyperc#12525814 AS exemptiontyperc#12525842, EXMP_CP_RC_LOWEST.globalcounterpartyidentifier#12525815 AS globalcounterpartyidentifier#12525843, EXMP_CP_RC_LOWEST.intercompanyflag#12525816 AS intercompanyflag#12525844, EXMP_CP_RC_LOWEST.lastperformingpdmodelcode#12525817 AS lastperformingpdmodelcode#12525845, EXMP_CP_RC_LOWEST.liabilitypercentage#12525818 AS liabilitypercentage#12525846, EXMP_CP_RC_LOWEST.participatingcounterparty#12525819 AS participatingcounterparty#12525847, EXMP_CP_RC_LOWEST.participatingcounterpartysourcesystemidentifier#12525820 AS participatingcounterpartysourcesystemidentifier#12525848, EXMP_CP_RC_LOWEST.pdmodelcode#12525821 AS pdmodelcode#12525849, EXMP_CP_RC_LOWEST.reportingdate#12525822 AS reportingdate#12525850, EXMP_CP_RC_LOWEST.sourcedexemptionid#12525823 AS sourcedexemptionid#12525851]
                  :              +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525790, EXMP_CP_RC.counterpartyid#12525791, EXMP_CP_RC.counterpartysourcesystemidentifier#12525792, EXMP_CP_RC.deliveryentity#12525793, EXMP_CP_RC.exemptionconditionidrc#12525794, EXMP_CP_RC.exemptionidrc#12525795, EXMP_CP_RC.exemptionnamerc#12525796, EXMP_CP_RC.exemptiontyperc#12525797, EXMP_CP_RC.globalcounterpartyidentifier#12525798, EXMP_CP_RC.intercompanyflag#12525799, EXMP_CP_RC.lastperformingpdmodelcode#12525800, EXMP_CP_RC.pdmodelcode#12525801, EXMP_CP_RC.reportingdate#12525802, EXMP_CP_RC.sourcedexemptionid#12525803, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525804, EXMP_CP_RC_LOWEST.counterpartyid#12525805, EXMP_CP_RC_LOWEST.counterpartyrole#12525806, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525807, EXMP_CP_RC_LOWEST.creditfacility#12525808, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525809, EXMP_CP_RC_LOWEST.deliveryentity#12525810, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525811, EXMP_CP_RC_LOWEST.exemptionidrc#12525812, EXMP_CP_RC_LOWEST.exemptionnamerc#12525813, EXMP_CP_RC_LOWEST.exemptiontyperc#12525814, ... 17 more fields]
                  +- SubqueryAlias INT_CF_LINKS
                     +- Project [counterpartyrole#12525937, creditfacility#12525938, creditfacilitysourcesystemidentifier#12525939, deliveryentity#12525940, liabilitypercentage#12525941, participatingcounterparty#12525942, participatingcounterpartysourcesystemidentifier#12525943, reportingdate#12525944, monotonically_increasing_id() AS idx#12525954L]
                        +- Project [INT_CF_LINKS.counterpartyrole#12525929 AS counterpartyrole#12525937, INT_CF_LINKS.creditfacility#12525930 AS creditfacility#12525938, INT_CF_LINKS.creditfacilitysourcesystemidentifier#12525931 AS creditfacilitysourcesystemidentifier#12525939, INT_CF_LINKS.deliveryentity#12525932 AS deliveryentity#12525940, INT_CF_LINKS.liabilitypercentage#12525933 AS liabilitypercentage#12525941, INT_CF_LINKS.participatingcounterparty#12525934 AS participatingcounterparty#12525942, INT_CF_LINKS.participatingcounterpartysourcesystemidentifier#12525935 AS participatingcounterpartysourcesystemidentifier#12525943, INT_CF_LINKS.reportingdate#12525936 AS reportingdate#12525944]
                           +- LocalRelation <empty>, [EXMP_CP_RC.baselcreditriskapproach#12525895, EXMP_CP_RC.counterpartyid#12525896, EXMP_CP_RC.counterpartysourcesystemidentifier#12525897, EXMP_CP_RC.deliveryentity#12525898, EXMP_CP_RC.exemptionconditionidrc#12525899, EXMP_CP_RC.exemptionidrc#12525900, EXMP_CP_RC.exemptionnamerc#12525901, EXMP_CP_RC.exemptiontyperc#12525902, EXMP_CP_RC.globalcounterpartyidentifier#12525903, EXMP_CP_RC.intercompanyflag#12525904, EXMP_CP_RC.lastperformingpdmodelcode#12525905, EXMP_CP_RC.pdmodelcode#12525906, EXMP_CP_RC.reportingdate#12525907, EXMP_CP_RC.sourcedexemptionid#12525908, EXMP_CP_RC_LOWEST.baselcreditriskapproach#12525909, EXMP_CP_RC_LOWEST.counterpartyid#12525910, EXMP_CP_RC_LOWEST.counterpartyrole#12525911, EXMP_CP_RC_LOWEST.counterpartysourcesystemidentifier#12525912, EXMP_CP_RC_LOWEST.creditfacility#12525913, EXMP_CP_RC_LOWEST.creditfacilitysourcesystemidentifier#12525914, EXMP_CP_RC_LOWEST.deliveryentity#12525915, EXMP_CP_RC_LOWEST.exemptionconditionidrc#12525916, EXMP_CP_RC_LOWEST.exemptionidrc#12525917, EXMP_CP_RC_LOWEST.exemptionnamerc#12525918, EXMP_CP_RC_LOWEST.exemptiontyperc#12525919, ... 17 more fields]


JVM stacktrace:
org.apache.spark.sql.catalyst.ExtendedAnalysisException
	at org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:416)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:416)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:478)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:478)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:294)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:668)
	at org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:151)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$4(QueryExecution.scala:668)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1307)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:661)
	at com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:658)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:658)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:288)
	at com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:287)
	at scala.util.Try$.apply(Try.scala:210)
	at org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)
	at org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)
	at org.apache.spark.util.LazyTry.get(LazyTry.scala:58)
	at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:321)
	at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:267)
	at org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)
	at org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)
	at org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)
	at org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)
	at org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)
	at org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)
	at scala.util.Using$.resource(Using.scala:261)
	at com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)
Traceback (most recent call last):
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 1932, in _execute_and_fetch_as_iterator
    for b in generator:
  File "<frozen _collections_abc>", line 356, in __next__
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 141, in send
    if not self._has_next():
           ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 202, in _has_next
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 174, in _has_next
    self._current = self._call_iter(
                    ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 307, in _call_iter
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 279, in _call_iter
    return iter_fun()
           ^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 175, in <lambda>
    lambda: next(self._iterator)  # type: ignore[arg-type]
            ^^^^^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 658, in __iter__
    for response in self._call:
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 540, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 966, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.INTERNAL
	details = "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`SourceSystemIdentifier` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC`.`pdmodelcode`, `EXMP_CP_RC`.`exemptionidrc`, `rank_num_Processid_RC`, `EXMP_CP_RC`.`deliveryentity`, `INT_CF_LINKS`.`deliveryentity`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 19 more fields]
      +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 18 more fields]
         +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, co..."
	debug_error_string = "UNKNOWN:Error received from peer  {created_time:"2025-08-12T09:22:34.118559272+00:00", grpc_status:13, grpc_message:"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`SourceSystemIdentifier` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC`.`pdmodelcode`, `EXMP_CP_RC`.`exemptionidrc`, `rank_num_Processid_RC`, `EXMP_CP_RC`.`deliveryentity`, `INT_CF_LINKS`.`deliveryentity`]. SQLSTATE: 42703; line 1 pos 0;\n\'GlobalLimit 1\n+- \'LocalLimit 1\n   +- \'Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 19 more fields]\n      +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, counterpartysourcesystemidentifier#12525747, deliveryentity#12525748, exemptionconditionidrc#12525749, exemptionidrc#12525750, exemptionnamerc#12525751, exemptiontyperc#12525752, globalcounterpartyidentifier#12525753, intercompanyflag#12525754, lastperformingpdmodelcode#12525755, pdmodelcode#12525756, reportingdate#12525757, sourcedexemptionid#12525758, baselcreditriskapproach#12525832, counterpartyid#12525833, counterpartyrole#12525834, counterpartysourcesystemidentifier#12525835, creditfacility#12525836, creditfacilitysourcesystemidentifier#12525837, deliveryentity#12525838, exemptionconditionidrc#12525839, exemptionidrc#12525840, exemptionnamerc#12525841, exemptiontyperc#12525842, ... 18 more fields]\n         +- Project [baselcreditriskapproach#12525745, counterpartyid#12525746, co..."}"
>
2025-08-12 09:22:34 [ERROR] validate_sql_expressions:  Problem with expression(s):
2025-08-12 09:22:34 [ERROR] validate_sql_expressions:  CF.LocalFacilityIdentifier = EXMP_CP_RC_LOWEST.CreditFacility: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`LocalFacilityIdentifier` cannot be resolved. Did you mean one of the following? [`INT_CF_LINKS`.`deliveryentity`, `INT_CF_LINKS`.`liabilitypercentage`, `EXMP_CP_RC`.`deliveryentity`, `EXMP_CP_RC`.`pdmodelcode`, `rank_num_Processid_RC`]. SQLSTATE: 42703
CF.SourceSystemIdentifier = EXMP_CP_RC_LOWEST.CreditFacilitySourceSystemIdentifier: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`SourceSystemIdentifier` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC`.`pdmodelcode`, `EXMP_CP_RC`.`exemptionidrc`, `rank_num_Processid_RC`, `EXMP_CP_RC`.`deliveryentity`, `INT_CF_LINKS`.`deliveryentity`]. SQLSTATE: 42703
