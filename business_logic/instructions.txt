{"ts": "2025-08-12 13:30:47.749", "level": "ERROR", "logger": "SQLQueryContextLogger", "msg": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`DeliveryEntity` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`ReportingEntity`]. SQLSTATE: 42703; line 1 pos 0;\n'Filter ((isnotnull('1286EXMP.exemption_condition_id) OR (isnotnull('var_lowest_ExemptionClaimConditonID_CP_RC) AND ('ExemptionConditionIdRC = 'var_lowest_ExemptionClaimConditonID_FAC_RC))) OR ('ExemptionConditionIdRC = 'var_lowest_ExemptionClaimConditonID_CP_RC))\n+- 'Project ['CF.DeliveryEntity AS DeliveryEntity#3022619, 'CF.ReportingDate AS ReportingDate#3022620, 'CF.ReportingEntity AS ReportingEntity#3022621, 'CF.LocalFacilityIdentifier AS CreditFacilityID#3022622, 'CF.SourceSystemIdentifier AS CreditFacilitySourceSystemIdentifier#3022623, 'CF.CounterpartyID AS CounterpartyID#3022624, 'CF.CounterpartySourceSystemIdentifier AS CounterpartySourceSystemIdentifier#3022625, 'CF.BaselIIProductType AS BaselProductType#3022626, 'CF.PlNplIndicator AS PlNplIndicator#3022627, 'CF.SpecialisedLendingType AS SpecialisedLendingType#3022628, 'CF.ExemptionFromAdvancedInternalRatingBasedApproach AS SourcedExemptionId#3022629, 'PD_UCR.PDModelCode AS PDModelCode#3022630, 'PD_UCR.LastPerformingPDModelCode AS LastPerformingPDModelCode#3022631, 'IC.InterCompanyFlag AS InterCompanyFlag#3022632, 'LGD.LGDModelCode AS LGDModelCode#3022633, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN BaselCreditRiskApproach#3023193 END, CASE WHEN ('1286EXMP.basel_approach = STD) THEN SA WHEN ('1286EXMP.basel_approach = FOU) THEN FIRB WHEN ('1286EXMP.basel_approach = IRB) THEN AIRB ELSE '1286EXMP.basel_approach END) AS BaselCreditRiskApproach#3022634, 'least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) AS ExemptionConditionIdRC#3022635, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN ExemptionIdRC#3023195 END, '1286EXMP.exemption_id) AS ExemptionIdRC#3022636, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN ExemptionNameRC#3023196 END, '1286EXMP.exemption_name) AS ExemptionNameRC#3022637, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN ExemptionTypeRC#3023197 END, CASE WHEN ('1286EXMP.exemption_end_date = 9999-12-31) THEN P ELSE T END) AS ExemptionTypeRC#3022638]\n   +- Window [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019, DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041, CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100, CounterpartyID#3023117, ... 57 more fields], [CreditFacility#3023179]\n      +- Project [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019, DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041, CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100, CounterpartyID#3023117, ... 56 more fields]\n         +- SubqueryAlias EXMP_CP_RC_JOINED\n            +- Join LeftOuter, ((ParticipatingCounterparty#3023182 = CounterpartyID#3023186) AND (ParticipatingCounterpartySourceSystemIdentifier#3023183 = CounterpartySourceSystemIdentifier#3023187))\n               :- Join LeftOuter, ((LocalFacilityIdentifier#3022922 = CreditFacility#3023179) AND (SourceSystemIdentifier#3023002 = CreditFacilitySourceSystemIdentifier#3023180))\n               :  :- Window [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019, DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041, CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100, CounterpartyID#3023117, ... 34 more fields], [LocalFacilityIdentifier#3022922]\n               :  :  +- Project [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019, DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041, CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100, CounterpartyID#3023117, ... 34 more fields]\n               :  :     +- Join LeftOuter, ((((((((((((reporting_entity_id#3023156 = ReportingEntity#3022999) OR (reporting_entity_id#3023156 = *)) AND ((b2_pd_type_id#3023157 = BaselIIProductType#3022937) OR (b2_pd_type_id#3023157 = *))) AND ((lgd_rtg_model#3023162 = LGDModelCode#3023140) OR (lgd_rtg_model#3023162 = *))) AND ((pl_npl_indicator#3023174 = PlNplIndicator#3022995) OR (pl_npl_indicator#3023174 = *))) AND ((specialised_lending_type#3023175 = SpecialisedLendingType#3023003) OR (specialised_lending_type#3023175 = *))) AND ((cr_pd_program#3023160 = ProductProgram#3022997) OR (cr_pd_program#3023160 = *))) AND (((pd_rtg_model#3023155 = PDModelCode#3023099) OR (pd_rtg_model#3023155 = LastPerformingPDModelCode#3023100)) OR (pd_rtg_model#3023155 = *))) AND ((b2_cpty_type_id#3023159 = BaselIICounterpartyType#3023032) OR (b2_cpty_type_id#3023159 = *))) AND (((intercompany_flag#3023165 = InterCompanyFlag#3023121) = cast(Y as boolean)) OR (intercompany_flag#3023165 = *))) AND ((upper(sourced_exemption_id#3023173) = upper(coalesce(ExemptionFromAdvancedInternalRatingBasedApproach#3022963, ExemptionFromAdvancedInternalRatingBasedApproach#3023041))) OR (sourced_exemption_id#3023173 = *))) AND (((concat(ctpty_ssc#3023167, ctpty_uid#3023166) = LocalId#3023050) OR ((ctpty_ssc#3023167 = EPR) AND (ltrim(ctpty_uid#3023166, Some(0)) = ltrim(GlobalCounterpartyIdentifier#3023043, Some(0))))) OR (ctpty_uid#3023166 = *)))\n               :  :        :- Join LeftOuter, ((LocalFacilityIdentifier#3022922 = CreditFacilityID#3023132) AND (SourceSystemIdentifier#3023002 = CreditFacilitySourceSystemIdentifier#3023133))\n               :  :        :  :- Join LeftOuter, ((CounterpartyID#3023020 = CounterpartyID#3023117) AND (CounterpartySourceSystemIdentifier#3023021 = CounterpartySourceSystemIdentifier#3023118))\n               :  :        :  :  :- Join LeftOuter, ((CounterpartyID#3023020 = CounterpartyID#3023092) AND (CounterpartySourceSystemIdentifier#3023021 = CounterpartySourceSystemIdentifier#3023093))\n               :  :        :  :  :  :- Join LeftOuter, ((CounterpartyID#3023020 = LocalId#3023050) AND (CounterpartySourceSystemIdentifier#3023021 = SourceSystemIdentifier#3023073))\n               :  :        :  :  :  :  :- SubqueryAlias CF\n               :  :        :  :  :  :  :  +- Project [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019]\n               :  :        :  :  :  :  :     +- Filter (SubFacilityFlag#3023019 = N)\n               :  :        :  :  :  :  :        +- SubqueryAlias bsrc_d.int_202505.mainbank_integrated_creditfacility\n               :  :        :  :  :  :  :           +- Relation bsrc_d.int_202505.mainbank_integrated_creditfacility[DeliveryEntity#3022920,ReportingDate#3022921,LocalFacilityIdentifier#3022922,Default#3022923,DefaultDate#3022924,DefaultEndDate#3022925,NonperformingEndDate#3022926,NonperformingStartDate#3022927,PerformingIndicator#3022928,AccruedFeesAmountDebitCreditIndicator#3022929,AccruedFeesAmountReportingAmount#3022930,AccruedFeesAmountReportingCurrency#3022931,AccruedFeesAmountTransactionAmount#3022932,AccruedFeesAmountTransactionCurrency#3022933,AlternativeLocalReferenceIdentifier#3022934,ApprovedLossGivenDefaultRatingDate#3022935,ArrangementParticipationType#3022936,BaselIIProductType#3022937,BookType#3022938,BorrowingBaseReportingAmount#3022939,BorrowingBaseReportingCurrency#3022940,BorrowingBaseTransactionAmount#3022941,BorrowingBaseTransactionCurrency#3022942,BusinessSegment#3022943,ContractStatus#3022944,... 77 more fields] parquet\n               :  :        :  :  :  :  +- SubqueryAlias INT_CP\n               :  :        :  :  :  :     +- Project [DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041]\n               :  :        :  :  :  :        +- SubqueryAlias bsrc_d.int_202505.mainbank_integrated_counterparty\n               :  :        :  :  :  :           +- Relation bsrc_d.int_202505.mainbank_integrated_counterparty[DeliveryEntity#3023022,ReportingDate#3023023,AacAlphaCode#3023024,AlternativeLocalReferenceIdentifier#3023025,AnnualTurnoverReportingAmount#3023026,AnnualTurnoverReportingCurrency#3023027,AnnualTurnoverTransactionAmount#3023028,AnnualTurnoverTransactionCurrency#3023029,ApprovedUniformCounterpartyRating#3023030,ApprovedUniformCounterpartyRatingExpirationDate#3023031,BaselIICounterpartyType#3023032,BcdbId#3023033,CommonEquityTier1Ratio#3023034,CounterpartyName#3023035,CountryOfIncorporation#3023036,CountryOfResidence#3023037,Default#3023038,DefaultDate#3023039,DefaultEndDate#3023040,ExemptionFromAdvancedInternalRatingBasedApproach#3023041,FrCounterpartySegmentation#3023042,GlobalCounterpartyIdentifier#3023043,GlobalOrganisationID#3023044,ImmediateParentOrganisation#3023045,ImmediateParentOrganisationIndicator#3023046,... 43 more fields] parquet\n               :  :        :  :  :  +- SubqueryAlias PD_UCR\n               :  :        :  :  :     +- Project [CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100]\n               :  :        :  :  :        +- SubqueryAlias bsrc_d.int_202505.mainbank_pd_ucr_step3\n               :  :        :  :  :           +- Relation bsrc_d.int_202505.mainbank_pd_ucr_step3[DeliveryEntity#3023090,ReportingDate#3023091,CounterpartyID#3023092,CounterpartySourceSystemIdentifier#3023093,BcdbId#3023094,AacAlphaCode#3023095,GlobalCounterpartyIdentifier#3023096,InterCompanyIndicator#3023097,Default#3023098,PDModelCode#3023099,LastPerformingPDModelCode#3023100,ApprovedUniformCounterpartyRating#3023101,UCRStep1#3023102,UCRStep2#3023103,UniformCounterpartyRating#3023104,ProbabilityOfDefaultBeforeConservatism#3023105,ProbabilityOfDefault#3023106,UniformCounterpartyRatingDate#3023107,UniformCounterpartyRatingExpiryDate#3023108,PDMarginOfConservatism#3023109,UCRCase#3023110,RatingSourceCounterpartyID#3023111,RatingSourceCounterpartySourceSystemIdentifier#3023112,fairid#3023113,UniquePDRatingId#3023114,... 1 more fields] parquet\n               :  :        :  :  +- SubqueryAlias IC\n               :  :        :  :     +- Project [CounterpartyID#3023117, CounterpartySourceSystemIdentifier#3023118, InterCompanyFlag#3023121]\n               :  :        :  :        +- SubqueryAlias bsrc_d.int_202505.mainbank_intercompany\n               :  :        :  :           +- Relation bsrc_d.int_202505.mainbank_intercompany[DeliveryEntity#3023116,CounterpartyID#3023117,CounterpartySourceSystemIdentifier#3023118,InsighterId#3023119,GlobalCounterpartyIdentifier#3023120,InterCompanyFlag#3023121,CounterpartyName#3023122,BaselCounterpartyType#3023123,CountryOfIncorporation#3023124,RealCompanyActivitySector#3023125,UltimateParent#3023126,ReportingEntity#3023127,InterCompanyType#3023128] parquet\n               :  :        :  +- SubqueryAlias LGD\n               :  :        :     +- Project [CreditFacilityID#3023132, CreditFacilitySourceSystemIdentifier#3023133, CounterpartyID#3023135, CounterpartySourceSystemIdentifier#3023136, LGDModelCode#3023140]\n               :  :        :        +- SubqueryAlias bsrc_d.int_202505.mainbank_lgd\n               :  :        :           +- Relation bsrc_d.int_202505.mainbank_lgd[DeliveryEntity#3023129,ReportingDate#3023130,ReportingEntity#3023131,CreditFacilityID#3023132,CreditFacilitySourceSystemIdentifier#3023133,GlobalFacilityIdentifier#3023134,CounterpartyID#3023135,CounterpartySourceSystemIdentifier#3023136,BaselCounterpartyType#3023137,ProbabilityOfDefaultModel#3023138,PlNplIndicator#3023139,LGDModelCode#3023140,LGDSubModelCode#3023141,LGDClass#3023142,DownturnLossGivenDefault#3023143,ThroughTheCycleLossGivenDefault#3023144,LossGivenDefaultRatingApprovalDate#3023145,LossGivenDefaultExpiryDate#3023146,LGDMarginOfConservatism#3023147,LGDType#3023148,LGDSource#3023149] parquet\n               :  :        +- SubqueryAlias `1286EXMP`\n               :  :           +- Project [EXEMPTION_CONDITION_ID#3023150, EXEMPTION_ID#3023151, EXEMPTION_NAME#3023152, EXEMPTION_END_DATE#3023153, SOURCE_SYS_COMP_ID#3023154, PD_RTG_MODEL#3023155, REPORTING_ENTITY_ID#3023156, B2_PD_TYPE_ID#3023157, RPRT_CAR_ACCCODE_ID#3023158, B2_CPTY_TYPE_ID#3023159, CR_PD_PROGRAM#3023160, CUSTOMER_MARKET_SEGMENT_ID#3023161, LGD_RTG_MODEL#3023162, LEGAL_ENTITY#3023163, EX_FBN_FLAG#3023164, INTERCOMPANY_FLAG#3023165, CTPTY_UID#3023166, CTPTY_SSC#3023167, BASEL_APPROACH#3023168, EC_MODEL_INPUT_INDICATOR#3023169, EC_PROXIED_INDICATOR#3023170, TIME_STAMP#3023171, MIN_TURNOVER#3023172, SOURCED_EXEMPTION_ID#3023173, PL_NPL_INDICATOR#3023174, ... 1 more fields]\n               :  :              +- SubqueryAlias bsrc_d.stg_202505.bsl_andes_1286_b2_exmp_cond\n               :  :                 +- Relation bsrc_d.stg_202505.bsl_andes_1286_b2_exmp_cond[EXEMPTION_CONDITION_ID#3023150,EXEMPTION_ID#3023151,EXEMPTION_NAME#3023152,EXEMPTION_END_DATE#3023153,SOURCE_SYS_COMP_ID#3023154,PD_RTG_MODEL#3023155,REPORTING_ENTITY_ID#3023156,B2_PD_TYPE_ID#3023157,RPRT_CAR_ACCCODE_ID#3023158,B2_CPTY_TYPE_ID#3023159,CR_PD_PROGRAM#3023160,CUSTOMER_MARKET_SEGMENT_ID#3023161,LGD_RTG_MODEL#3023162,LEGAL_ENTITY#3023163,EX_FBN_FLAG#3023164,INTERCOMPANY_FLAG#3023165,CTPTY_UID#3023166,CTPTY_SSC#3023167,BASEL_APPROACH#3023168,EC_MODEL_INPUT_INDICATOR#3023169,EC_PROXIED_INDICATOR#3023170,TIME_STAMP#3023171,MIN_TURNOVER#3023172,SOURCED_EXEMPTION_ID#3023173,PL_NPL_INDICATOR#3023174,... 1 more fields] parquet\n               :  +- SubqueryAlias INT_CF_LINKS\n               :     +- Project [DeliveryEntity#3023176, ReportingDate#3023177, CounterpartyRole#3023178, CreditFacility#3023179, CreditFacilitySourceSystemIdentifier#3023180, LiabilityPercentage#3023181, ParticipatingCounterparty#3023182, ParticipatingCounterpartySourceSystemIdentifier#3023183]\n               :        +- SubqueryAlias bsrc_d.int_202505.mainbank_integrated_creditfacility_links\n               :           +- Relation bsrc_d.int_202505.mainbank_integrated_creditfacility_links[DeliveryEntity#3023176,ReportingDate#3023177,CounterpartyRole#3023178,CreditFacility#3023179,CreditFacilitySourceSystemIdentifier#3023180,LiabilityPercentage#3023181,ParticipatingCounterparty#3023182,ParticipatingCounterpartySourceSystemIdentifier#3023183] parquet\n               +- SubqueryAlias EXMP_CP_RC\n                  +- Project [DeliveryEntity#3023184, ReportingDate#3023185, CounterpartyID#3023186, CounterpartySourceSystemIdentifier#3023187, GlobalCounterpartyIdentifier#3023188, SourcedExemptionId#3023189, PDModelCode#3023190, LastPerformingPDModelCode#3023191, IntercompanyFlag#3023192, BaselCreditRiskApproach#3023193, ExemptionConditionIdRC#3023194, ExemptionIdRC#3023195, ExemptionNameRC#3023196, ExemptionTypeRC#3023197]\n                     +- SubqueryAlias bsrc_d.enrich_202505.mainbank_exemptionclaim_counterparty_rc\n                        +- Relation bsrc_d.enrich_202505.mainbank_exemptionclaim_counterparty_rc[DeliveryEntity#3023184,ReportingDate#3023185,CounterpartyID#3023186,CounterpartySourceSystemIdentifier#3023187,GlobalCounterpartyIdentifier#3023188,SourcedExemptionId#3023189,PDModelCode#3023190,LastPerformingPDModelCode#3023191,IntercompanyFlag#3023192,BaselCreditRiskApproach#3023193,ExemptionConditionIdRC#3023194,ExemptionIdRC#3023195,ExemptionNameRC#3023196,ExemptionTypeRC#3023197] parquet\n\n\nJVM stacktrace:\norg.apache.spark.sql.catalyst.ExtendedAnalysisException\n\tat org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)\n\tat scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)\n\tat scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:933)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:416)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:416)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:478)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:478)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:294)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:668)\n\tat org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:151)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$4(QueryExecution.scala:668)\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1307)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:661)\n\tat com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:658)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:658)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:288)\n\tat com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:287)\n\tat scala.util.Try$.apply(Try.scala:210)\n\tat org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)\n\tat org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)\n\tat org.apache.spark.util.LazyTry.get(LazyTry.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:321)\n\tat org.apache.spark.sql.connect.planner.SparkConnectPlanner.transformDeduplicate(SparkConnectPlanner.scala:1643)\n\tat org.apache.spark.sql.connect.planner.SparkConnectPlanner.$anonfun$transformRelation$1(SparkConnectPlanner.scala:198)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$usePlanCache$7(SessionHolder.scala:614)\n\tat org.apache.spark.sql.connect.service.SessionHolder.measureSubtreeRelationNodes(SessionHolder.scala:630)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$usePlanCache$5(SessionHolder.scala:613)\n\tat scala.Option.getOrElse(Option.scala:201)\n\tat org.apache.spark.sql.connect.service.SessionHolder.usePlanCache(SessionHolder.scala:611)\n\tat org.apache.spark.sql.connect.planner.SparkConnectPlanner.transformRelation(SparkConnectPlanner.scala:185)\n\tat org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.transformRelation$1(SparkConnectAnalyzeHandler.scala:119)\n\tat org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.process(SparkConnectAnalyzeHandler.scala:130)\n\tat org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.$anonfun$handle$3(SparkConnectAnalyzeHandler.scala:104)\n\tat org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.$anonfun$handle$3$adapted(SparkConnectAnalyzeHandler.scala:66)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)\n\tat org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)\n\tat org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)\n\tat org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)\n\tat org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)\n\tat org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)\n\tat org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.$anonfun$handle$1(SparkConnectAnalyzeHandler.scala:66)\n\tat org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.$anonfun$handle$1$adapted(SparkConnectAnalyzeHandler.scala:51)\n\tat com.databricks.spark.connect.logging.rpc.SparkConnectRpcMetricsCollectorUtils$.collectMetrics(SparkConnectRpcMetricsCollector.scala:258)\n\tat org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.handle(SparkConnectAnalyzeHandler.scala:50)\n\tat org.apache.spark.sql.connect.service.SparkConnectService.analyzePlan(SparkConnectService.scala:109)\n\tat org.apache.spark.connect.proto.SparkConnectServiceGrpc$MethodHandlers.invoke(SparkConnectServiceGrpc.java:801)\n\tat grpc_shaded.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n\tat grpc_shaded.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat grpc_shaded.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat grpc_shaded.io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat grpc_shaded.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n\tat grpc_shaded.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n\tat grpc_shaded.io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n\tat com.databricks.spark.connect.service.AuthenticationInterceptor$AuthenticatedServerCallListener.$anonfun$onHalfClose$1(AuthenticationInterceptor.scala:381)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)\n\tat com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)\n\tat com.databricks.spark.connect.service.RequestContext.$anonfun$runWith$3(RequestContext.scala:337)\n\tat com.databricks.spark.connect.service.RequestContext$.com$databricks$spark$connect$service$RequestContext$$withLocalProperties(RequestContext.scala:537)\n\tat com.databricks.spark.connect.service.RequestContext.$anonfun$runWith$2(RequestContext.scala:337)\n\tat com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)\n\tat com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)\n\tat com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)\n\tat com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)\n\tat com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)\n\tat com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)\n\tat com.databricks.spark.util.UniverseAttributionContextWrapper.withValue(AttributionContextUtils.scala:242)\n\tat com.databricks.spark.connect.service.RequestContext.$anonfun$runWith$1(RequestContext.scala:336)\n\tat com.databricks.spark.connect.service.RequestContext.withContext(RequestContext.scala:349)\n\tat com.databricks.spark.connect.service.RequestContext.runWith(RequestContext.scala:329)\n\tat com.databricks.spark.connect.service.AuthenticationInterceptor$AuthenticatedServerCallListener.onHalfClose(AuthenticationInterceptor.scala:381)\n\tat grpc_shaded.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)\n\tat grpc_shaded.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)\n\tat grpc_shaded.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat grpc_shaded.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat org.apache.spark.util.threads.SparkThreadLocalCapturingRunnable.$anonfun$run$1(SparkThreadLocalForwardingThreadPoolExecutor.scala:165)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)\n\tat org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.$anonfun$runWithCaptured$6(SparkThreadLocalForwardingThreadPoolExecutor.scala:119)\n\tat com.databricks.sql.transaction.tahoe.mst.MSTThreadHelper$.runWithMstTxnId(MSTThreadHelper.scala:57)\n\tat org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.$anonfun$runWithCaptured$5(SparkThreadLocalForwardingThreadPoolExecutor.scala:118)\n\tat com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)\n\tat org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.$anonfun$runWithCaptured$4(SparkThreadLocalForwardingThreadPoolExecutor.scala:117)\n\tat com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)\n\tat org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.runWithCaptured(SparkThreadLocalForwardingThreadPoolExecutor.scala:116)\n\tat org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.runWithCaptured$(SparkThreadLocalForwardingThreadPoolExecutor.scala:93)\n\tat org.apache.spark.util.threads.SparkThreadLocalCapturingRunnable.runWithCaptured(SparkThreadLocalForwardingThreadPoolExecutor.scala:162)\n\tat org.apache.spark.util.threads.SparkThreadLocalCapturingRunnable.run(SparkThreadLocalForwardingThreadPoolExecutor.scala:165)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.lang.Thread.run(Thread.java:840)", "context": {"errorClass": "UNRESOLVED_COLUMN.WITH_SUGGESTION"}, "exception": {"class": "_InactiveRpcError", "msg": "<_InactiveRpcError of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`DeliveryEntity` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`ReportingEntity`]. SQLSTATE: 42703; line 1 pos 0;\n'Filter ((isnotnull('1286EXMP.exemption_condition_id) OR (isnotnull('var_lowest_ExemptionClaimConditonID_CP_RC) AND ('ExemptionConditionIdRC = 'var_lowest_ExemptionClaimConditonID_FAC_RC))) OR ('ExemptionConditionIdRC = 'var_lowest_ExemptionClaimConditonID_CP_RC))\n+- 'Project ['CF.DeliveryEntity AS DeliveryEntity#3022619, 'CF.ReportingDate AS ReportingDate#3022620, 'CF.ReportingEntity AS ReportingEntity#3022621, 'CF.LocalFacilityIdentifier AS CreditFacilityID#3022622, 'CF.SourceSystemIdentifier AS CreditFacilitySourceSystemIdentifier#3022623, 'CF.CounterpartyID AS CounterpartyID#3022624, 'CF.CounterpartySourceSystemIdentifier AS CounterpartySourceSystemIdentifier#3022625, 'CF.BaselIIProductType AS BaselProductType#3022626, 'CF.PlNplIndicator AS PlNplIndicator#3022627, 'CF.SpecialisedLendingType AS SpecialisedLendingType#3022628, 'CF.ExemptionFromAdvancedInternalRatingBasedApproach AS SourcedExemptionId#3022629, 'PD_UCR.PDModelCode AS PDModelCode#3022630, 'PD_UCR.LastPerformingPDModelCode AS LastPerformingPDModelCode#3022631, 'IC.InterCompanyFlag AS InterCompanyFlag#3022632, 'LGD.LGDModelCode AS LGDModelCode#3022633, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN BaselCreditRiskApproach#3023193 END, CASE WHEN ('1286EXMP.basel_approach = STD) THEN SA WHEN ('1286EXMP.basel_approach = FOU) THEN FIRB WHEN ('1286EXMP.basel_approach = IRB) THEN AIRB ELSE '1286EXMP.basel_approach END) AS BaselCreditRiskApproach#3022634, 'least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) AS E...\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_message:\"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`DeliveryEntity` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`ReportingEntity`]. SQLSTATE: 42703; line 1 pos 0;\\n\\'Filter ((isnotnull(\\'1286EXMP.exemption_condition_id) OR (isnotnull(\\'var_lowest_ExemptionClaimConditonID_CP_RC) AND (\\'ExemptionConditionIdRC = \\'var_lowest_ExemptionClaimConditonID_FAC_RC))) OR (\\'ExemptionConditionIdRC = \\'var_lowest_ExemptionClaimConditonID_CP_RC))\\n+- \\'Project [\\'CF.DeliveryEntity AS DeliveryEntity#3022619, \\'CF.ReportingDate AS ReportingDate#3022620, \\'CF.ReportingEntity AS ReportingEntity#3022621, \\'CF.LocalFacilityIdentifier AS CreditFacilityID#3022622, \\'CF.SourceSystemIdentifier AS CreditFacilitySourceSystemIdentifier#3022623, \\'CF.CounterpartyID AS CounterpartyID#3022624, \\'CF.CounterpartySourceSystemIdentifier AS CounterpartySourceSystemIdentifier#3022625, \\'CF.BaselIIProductType AS BaselProductType#3022626, \\'CF.PlNplIndicator AS PlNplIndicator#3022627, \\'CF.SpecialisedLendingType AS SpecialisedLendingType#3022628, \\'CF.ExemptionFromAdvancedInternalRatingBasedApproach AS SourcedExemptionId#3022629, \\'PD_UCR.PDModelCode AS PDModelCode#3022630, \\'PD_UCR.LastPerformingPDModelCode AS LastPerformingPDModelCode#3022631, \\'IC.InterCompanyFlag AS InterCompanyFlag#3022632, \\'LGD.LGDModelCode AS LGDModelCode#3022633, \\'coalesce(CASE WHEN (\\'least(\\'1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN BaselCreditRiskApproach#3023193 END, CASE WHEN (\\'1286EXMP.basel_approach = STD) THEN SA WHEN (\\'1286EXMP.basel_approach = FOU) THEN FIRB WHEN (\\'1286EXMP.basel_approach = IRB) THEN AIRB ELSE \\'1286EXMP.basel_approach END) AS BaselCreditRiskApproach#3022634, \\'least(\\'1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) AS E...\", grpc_status:13, created_time:\"2025-08-12T13:30:47.74302953+00:00\"}\"\n>", "stacktrace": [{"class": null, "method": "_analyze", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "1736"}, {"class": null, "method": "__call__", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_interceptor.py", "line": "277"}, {"class": null, "method": "_with_call", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_interceptor.py", "line": "332"}, {"class": null, "method": "result", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "437"}, {"class": null, "method": "continuation", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_interceptor.py", "line": "315"}, {"class": null, "method": "with_call", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "1177"}, {"class": null, "method": "_end_unary_response_blocking", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "1003"}]}}
2025-08-12 13:30:47 [ERROR] _log:  [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`DeliveryEntity` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`ReportingEntity`]. SQLSTATE: 42703; line 1 pos 0;
'Filter ((isnotnull('1286EXMP.exemption_condition_id) OR (isnotnull('var_lowest_ExemptionClaimConditonID_CP_RC) AND ('ExemptionConditionIdRC = 'var_lowest_ExemptionClaimConditonID_FAC_RC))) OR ('ExemptionConditionIdRC = 'var_lowest_ExemptionClaimConditonID_CP_RC))
+- 'Project ['CF.DeliveryEntity AS DeliveryEntity#3022619, 'CF.ReportingDate AS ReportingDate#3022620, 'CF.ReportingEntity AS ReportingEntity#3022621, 'CF.LocalFacilityIdentifier AS CreditFacilityID#3022622, 'CF.SourceSystemIdentifier AS CreditFacilitySourceSystemIdentifier#3022623, 'CF.CounterpartyID AS CounterpartyID#3022624, 'CF.CounterpartySourceSystemIdentifier AS CounterpartySourceSystemIdentifier#3022625, 'CF.BaselIIProductType AS BaselProductType#3022626, 'CF.PlNplIndicator AS PlNplIndicator#3022627, 'CF.SpecialisedLendingType AS SpecialisedLendingType#3022628, 'CF.ExemptionFromAdvancedInternalRatingBasedApproach AS SourcedExemptionId#3022629, 'PD_UCR.PDModelCode AS PDModelCode#3022630, 'PD_UCR.LastPerformingPDModelCode AS LastPerformingPDModelCode#3022631, 'IC.InterCompanyFlag AS InterCompanyFlag#3022632, 'LGD.LGDModelCode AS LGDModelCode#3022633, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN BaselCreditRiskApproach#3023193 END, CASE WHEN ('1286EXMP.basel_approach = STD) THEN SA WHEN ('1286EXMP.basel_approach = FOU) THEN FIRB WHEN ('1286EXMP.basel_approach = IRB) THEN AIRB ELSE '1286EXMP.basel_approach END) AS BaselCreditRiskApproach#3022634, 'least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) AS ExemptionConditionIdRC#3022635, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN ExemptionIdRC#3023195 END, '1286EXMP.exemption_id) AS ExemptionIdRC#3022636, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN ExemptionNameRC#3023196 END, '1286EXMP.exemption_name) AS ExemptionNameRC#3022637, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN ExemptionTypeRC#3023197 END, CASE WHEN ('1286EXMP.exemption_end_date = 9999-12-31) THEN P ELSE T END) AS ExemptionTypeRC#3022638]
   +- Window [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019, DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041, CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100, CounterpartyID#3023117, ... 57 more fields], [CreditFacility#3023179]
      +- Project [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019, DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041, CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100, CounterpartyID#3023117, ... 56 more fields]
         +- SubqueryAlias EXMP_CP_RC_JOINED
            +- Join LeftOuter, ((ParticipatingCounterparty#3023182 = CounterpartyID#3023186) AND (ParticipatingCounterpartySourceSystemIdentifier#3023183 = CounterpartySourceSystemIdentifier#3023187))
               :- Join LeftOuter, ((LocalFacilityIdentifier#3022922 = CreditFacility#3023179) AND (SourceSystemIdentifier#3023002 = CreditFacilitySourceSystemIdentifier#3023180))
               :  :- Window [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019, DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041, CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100, CounterpartyID#3023117, ... 34 more fields], [LocalFacilityIdentifier#3022922]
               :  :  +- Project [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019, DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041, CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100, CounterpartyID#3023117, ... 34 more fields]
               :  :     +- Join LeftOuter, ((((((((((((reporting_entity_id#3023156 = ReportingEntity#3022999) OR (reporting_entity_id#3023156 = *)) AND ((b2_pd_type_id#3023157 = BaselIIProductType#3022937) OR (b2_pd_type_id#3023157 = *))) AND ((lgd_rtg_model#3023162 = LGDModelCode#3023140) OR (lgd_rtg_model#3023162 = *))) AND ((pl_npl_indicator#3023174 = PlNplIndicator#3022995) OR (pl_npl_indicator#3023174 = *))) AND ((specialised_lending_type#3023175 = SpecialisedLendingType#3023003) OR (specialised_lending_type#3023175 = *))) AND ((cr_pd_program#3023160 = ProductProgram#3022997) OR (cr_pd_program#3023160 = *))) AND (((pd_rtg_model#3023155 = PDModelCode#3023099) OR (pd_rtg_model#3023155 = LastPerformingPDModelCode#3023100)) OR (pd_rtg_model#3023155 = *))) AND ((b2_cpty_type_id#3023159 = BaselIICounterpartyType#3023032) OR (b2_cpty_type_id#3023159 = *))) AND (((intercompany_flag#3023165 = InterCompanyFlag#3023121) = cast(Y as boolean)) OR (intercompany_flag#3023165 = *))) AND ((upper(sourced_exemption_id#3023173) = upper(coalesce(ExemptionFromAdvancedInternalRatingBasedApproach#3022963, ExemptionFromAdvancedInternalRatingBasedApproach#3023041))) OR (sourced_exemption_id#3023173 = *))) AND (((concat(ctpty_ssc#3023167, ctpty_uid#3023166) = LocalId#3023050) OR ((ctpty_ssc#3023167 = EPR) AND (ltrim(ctpty_uid#3023166, Some(0)) = ltrim(GlobalCounterpartyIdentifier#3023043, Some(0))))) OR (ctpty_uid#3023166 = *)))
               :  :        :- Join LeftOuter, ((LocalFacilityIdentifier#3022922 = CreditFacilityID#3023132) AND (SourceSystemIdentifier#3023002 = CreditFacilitySourceSystemIdentifier#3023133))
               :  :        :  :- Join LeftOuter, ((CounterpartyID#3023020 = CounterpartyID#3023117) AND (CounterpartySourceSystemIdentifier#3023021 = CounterpartySourceSystemIdentifier#3023118))
               :  :        :  :  :- Join LeftOuter, ((CounterpartyID#3023020 = CounterpartyID#3023092) AND (CounterpartySourceSystemIdentifier#3023021 = CounterpartySourceSystemIdentifier#3023093))
               :  :        :  :  :  :- Join LeftOuter, ((CounterpartyID#3023020 = LocalId#3023050) AND (CounterpartySourceSystemIdentifier#3023021 = SourceSystemIdentifier#3023073))
               :  :        :  :  :  :  :- SubqueryAlias CF
               :  :        :  :  :  :  :  +- Project [DeliveryEntity#3022920, ReportingDate#3022921, ReportingEntity#3022999, LocalFacilityIdentifier#3022922, SourceSystemIdentifier#3023002, CounterpartyID#3023020, CounterpartySourceSystemIdentifier#3023021, BaselIIProductType#3022937, PlNplIndicator#3022995, ProductProgram#3022997, SpecialisedLendingType#3023003, ExemptionFromAdvancedInternalRatingBasedApproach#3022963, SubFacilityFlag#3023019]
               :  :        :  :  :  :  :     +- Filter (SubFacilityFlag#3023019 = N)
               :  :        :  :  :  :  :        +- SubqueryAlias bsrc_d.int_202505.mainbank_integrated_creditfacility
               :  :        :  :  :  :  :           +- Relation bsrc_d.int_202505.mainbank_integrated_creditfacility[DeliveryEntity#3022920,ReportingDate#3022921,LocalFacilityIdentifier#3022922,Default#3022923,DefaultDate#3022924,DefaultEndDate#3022925,NonperformingEndDate#3022926,NonperformingStartDate#3022927,PerformingIndicator#3022928,AccruedFeesAmountDebitCreditIndicator#3022929,AccruedFeesAmountReportingAmount#3022930,AccruedFeesAmountReportingCurrency#3022931,AccruedFeesAmountTransactionAmount#3022932,AccruedFeesAmountTransactionCurrency#3022933,AlternativeLocalReferenceIdentifier#3022934,ApprovedLossGivenDefaultRatingDate#3022935,ArrangementParticipationType#3022936,BaselIIProductType#3022937,BookType#3022938,BorrowingBaseReportingAmount#3022939,BorrowingBaseReportingCurrency#3022940,BorrowingBaseTransactionAmount#3022941,BorrowingBaseTransactionCurrency#3022942,BusinessSegment#3022943,ContractStatus#3022944,... 77 more fields] parquet
               :  :        :  :  :  :  +- SubqueryAlias INT_CP
               :  :        :  :  :  :     +- Project [DeliveryEntity#3023022, ReportingDate#3023023, LocalId#3023050, SourceSystemIdentifier#3023073, GlobalCounterpartyIdentifier#3023043, BaselIICounterpartyType#3023032, ExemptionFromAdvancedInternalRatingBasedApproach#3023041]
               :  :        :  :  :  :        +- SubqueryAlias bsrc_d.int_202505.mainbank_integrated_counterparty
               :  :        :  :  :  :           +- Relation bsrc_d.int_202505.mainbank_integrated_counterparty[DeliveryEntity#3023022,ReportingDate#3023023,AacAlphaCode#3023024,AlternativeLocalReferenceIdentifier#3023025,AnnualTurnoverReportingAmount#3023026,AnnualTurnoverReportingCurrency#3023027,AnnualTurnoverTransactionAmount#3023028,AnnualTurnoverTransactionCurrency#3023029,ApprovedUniformCounterpartyRating#3023030,ApprovedUniformCounterpartyRatingExpirationDate#3023031,BaselIICounterpartyType#3023032,BcdbId#3023033,CommonEquityTier1Ratio#3023034,CounterpartyName#3023035,CountryOfIncorporation#3023036,CountryOfResidence#3023037,Default#3023038,DefaultDate#3023039,DefaultEndDate#3023040,ExemptionFromAdvancedInternalRatingBasedApproach#3023041,FrCounterpartySegmentation#3023042,GlobalCounterpartyIdentifier#3023043,GlobalOrganisationID#3023044,ImmediateParentOrganisation#3023045,ImmediateParentOrganisationIndicator#3023046,... 43 more fields] parquet
               :  :        :  :  :  +- SubqueryAlias PD_UCR
               :  :        :  :  :     +- Project [CounterpartyID#3023092, CounterpartySourceSystemIdentifier#3023093, PDModelCode#3023099, LastPerformingPDModelCode#3023100]
               :  :        :  :  :        +- SubqueryAlias bsrc_d.int_202505.mainbank_pd_ucr_step3
               :  :        :  :  :           +- Relation bsrc_d.int_202505.mainbank_pd_ucr_step3[DeliveryEntity#3023090,ReportingDate#3023091,CounterpartyID#3023092,CounterpartySourceSystemIdentifier#3023093,BcdbId#3023094,AacAlphaCode#3023095,GlobalCounterpartyIdentifier#3023096,InterCompanyIndicator#3023097,Default#3023098,PDModelCode#3023099,LastPerformingPDModelCode#3023100,ApprovedUniformCounterpartyRating#3023101,UCRStep1#3023102,UCRStep2#3023103,UniformCounterpartyRating#3023104,ProbabilityOfDefaultBeforeConservatism#3023105,ProbabilityOfDefault#3023106,UniformCounterpartyRatingDate#3023107,UniformCounterpartyRatingExpiryDate#3023108,PDMarginOfConservatism#3023109,UCRCase#3023110,RatingSourceCounterpartyID#3023111,RatingSourceCounterpartySourceSystemIdentifier#3023112,fairid#3023113,UniquePDRatingId#3023114,... 1 more fields] parquet
               :  :        :  :  +- SubqueryAlias IC
               :  :        :  :     +- Project [CounterpartyID#3023117, CounterpartySourceSystemIdentifier#3023118, InterCompanyFlag#3023121]
               :  :        :  :        +- SubqueryAlias bsrc_d.int_202505.mainbank_intercompany
               :  :        :  :           +- Relation bsrc_d.int_202505.mainbank_intercompany[DeliveryEntity#3023116,CounterpartyID#3023117,CounterpartySourceSystemIdentifier#3023118,InsighterId#3023119,GlobalCounterpartyIdentifier#3023120,InterCompanyFlag#3023121,CounterpartyName#3023122,BaselCounterpartyType#3023123,CountryOfIncorporation#3023124,RealCompanyActivitySector#3023125,UltimateParent#3023126,ReportingEntity#3023127,InterCompanyType#3023128] parquet
               :  :        :  +- SubqueryAlias LGD
               :  :        :     +- Project [CreditFacilityID#3023132, CreditFacilitySourceSystemIdentifier#3023133, CounterpartyID#3023135, CounterpartySourceSystemIdentifier#3023136, LGDModelCode#3023140]
               :  :        :        +- SubqueryAlias bsrc_d.int_202505.mainbank_lgd
               :  :        :           +- Relation bsrc_d.int_202505.mainbank_lgd[DeliveryEntity#3023129,ReportingDate#3023130,ReportingEntity#3023131,CreditFacilityID#3023132,CreditFacilitySourceSystemIdentifier#3023133,GlobalFacilityIdentifier#3023134,CounterpartyID#3023135,CounterpartySourceSystemIdentifier#3023136,BaselCounterpartyType#3023137,ProbabilityOfDefaultModel#3023138,PlNplIndicator#3023139,LGDModelCode#3023140,LGDSubModelCode#3023141,LGDClass#3023142,DownturnLossGivenDefault#3023143,ThroughTheCycleLossGivenDefault#3023144,LossGivenDefaultRatingApprovalDate#3023145,LossGivenDefaultExpiryDate#3023146,LGDMarginOfConservatism#3023147,LGDType#3023148,LGDSource#3023149] parquet
               :  :        +- SubqueryAlias `1286EXMP`
               :  :           +- Project [EXEMPTION_CONDITION_ID#3023150, EXEMPTION_ID#3023151, EXEMPTION_NAME#3023152, EXEMPTION_END_DATE#3023153, SOURCE_SYS_COMP_ID#3023154, PD_RTG_MODEL#3023155, REPORTING_ENTITY_ID#3023156, B2_PD_TYPE_ID#3023157, RPRT_CAR_ACCCODE_ID#3023158, B2_CPTY_TYPE_ID#3023159, CR_PD_PROGRAM#3023160, CUSTOMER_MARKET_SEGMENT_ID#3023161, LGD_RTG_MODEL#3023162, LEGAL_ENTITY#3023163, EX_FBN_FLAG#3023164, INTERCOMPANY_FLAG#3023165, CTPTY_UID#3023166, CTPTY_SSC#3023167, BASEL_APPROACH#3023168, EC_MODEL_INPUT_INDICATOR#3023169, EC_PROXIED_INDICATOR#3023170, TIME_STAMP#3023171, MIN_TURNOVER#3023172, SOURCED_EXEMPTION_ID#3023173, PL_NPL_INDICATOR#3023174, ... 1 more fields]
               :  :              +- SubqueryAlias bsrc_d.stg_202505.bsl_andes_1286_b2_exmp_cond
               :  :                 +- Relation bsrc_d.stg_202505.bsl_andes_1286_b2_exmp_cond[EXEMPTION_CONDITION_ID#3023150,EXEMPTION_ID#3023151,EXEMPTION_NAME#3023152,EXEMPTION_END_DATE#3023153,SOURCE_SYS_COMP_ID#3023154,PD_RTG_MODEL#3023155,REPORTING_ENTITY_ID#3023156,B2_PD_TYPE_ID#3023157,RPRT_CAR_ACCCODE_ID#3023158,B2_CPTY_TYPE_ID#3023159,CR_PD_PROGRAM#3023160,CUSTOMER_MARKET_SEGMENT_ID#3023161,LGD_RTG_MODEL#3023162,LEGAL_ENTITY#3023163,EX_FBN_FLAG#3023164,INTERCOMPANY_FLAG#3023165,CTPTY_UID#3023166,CTPTY_SSC#3023167,BASEL_APPROACH#3023168,EC_MODEL_INPUT_INDICATOR#3023169,EC_PROXIED_INDICATOR#3023170,TIME_STAMP#3023171,MIN_TURNOVER#3023172,SOURCED_EXEMPTION_ID#3023173,PL_NPL_INDICATOR#3023174,... 1 more fields] parquet
               :  +- SubqueryAlias INT_CF_LINKS
               :     +- Project [DeliveryEntity#3023176, ReportingDate#3023177, CounterpartyRole#3023178, CreditFacility#3023179, CreditFacilitySourceSystemIdentifier#3023180, LiabilityPercentage#3023181, ParticipatingCounterparty#3023182, ParticipatingCounterpartySourceSystemIdentifier#3023183]
               :        +- SubqueryAlias bsrc_d.int_202505.mainbank_integrated_creditfacility_links
               :           +- Relation bsrc_d.int_202505.mainbank_integrated_creditfacility_links[DeliveryEntity#3023176,ReportingDate#3023177,CounterpartyRole#3023178,CreditFacility#3023179,CreditFacilitySourceSystemIdentifier#3023180,LiabilityPercentage#3023181,ParticipatingCounterparty#3023182,ParticipatingCounterpartySourceSystemIdentifier#3023183] parquet
               +- SubqueryAlias EXMP_CP_RC
                  +- Project [DeliveryEntity#3023184, ReportingDate#3023185, CounterpartyID#3023186, CounterpartySourceSystemIdentifier#3023187, GlobalCounterpartyIdentifier#3023188, SourcedExemptionId#3023189, PDModelCode#3023190, LastPerformingPDModelCode#3023191, IntercompanyFlag#3023192, BaselCreditRiskApproach#3023193, ExemptionConditionIdRC#3023194, ExemptionIdRC#3023195, ExemptionNameRC#3023196, ExemptionTypeRC#3023197]
                     +- SubqueryAlias bsrc_d.enrich_202505.mainbank_exemptionclaim_counterparty_rc
                        +- Relation bsrc_d.enrich_202505.mainbank_exemptionclaim_counterparty_rc[DeliveryEntity#3023184,ReportingDate#3023185,CounterpartyID#3023186,CounterpartySourceSystemIdentifier#3023187,GlobalCounterpartyIdentifier#3023188,SourcedExemptionId#3023189,PDModelCode#3023190,LastPerformingPDModelCode#3023191,IntercompanyFlag#3023192,BaselCreditRiskApproach#3023193,ExemptionConditionIdRC#3023194,ExemptionIdRC#3023195,ExemptionNameRC#3023196,ExemptionTypeRC#3023197] parquet


JVM stacktrace:
org.apache.spark.sql.catalyst.ExtendedAnalysisException
	at org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:416)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:416)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:478)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:478)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:294)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:668)
	at org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:151)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$4(QueryExecution.scala:668)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1307)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:661)
	at com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:658)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:658)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:288)
	at com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:287)
	at scala.util.Try$.apply(Try.scala:210)
	at org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)
	at org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)
	at org.apache.spark.util.LazyTry.get(LazyTry.scala:58)
	at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:321)
	at org.apache.spark.sql.connect.planner.SparkConnectPlanner.transformDeduplicate(SparkConnectPlanner.scala:1643)
	at org.apache.spark.sql.connect.planner.SparkConnectPlanner.$anonfun$transformRelation$1(SparkConnectPlanner.scala:198)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$usePlanCache$7(SessionHolder.scala:614)
	at org.apache.spark.sql.connect.service.SessionHolder.measureSubtreeRelationNodes(SessionHolder.scala:630)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$usePlanCache$5(SessionHolder.scala:613)
	at scala.Option.getOrElse(Option.scala:201)
	at org.apache.spark.sql.connect.service.SessionHolder.usePlanCache(SessionHolder.scala:611)
	at org.apache.spark.sql.connect.planner.SparkConnectPlanner.transformRelation(SparkConnectPlanner.scala:185)
	at org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.transformRelation$1(SparkConnectAnalyzeHandler.scala:119)
	at org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.process(SparkConnectAnalyzeHandler.scala:130)
	at org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.$anonfun$handle$3(SparkConnectAnalyzeHandler.scala:104)
	at org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.$anonfun$handle$3$adapted(SparkConnectAnalyzeHandler.scala:66)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)
	at org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)
	at org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)
	at org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)
	at org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)
	at org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.$anonfun$handle$1(SparkConnectAnalyzeHandler.scala:66)
	at org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.$anonfun$handle$1$adapted(SparkConnectAnalyzeHandler.scala:51)
	at com.databricks.spark.connect.logging.rpc.SparkConnectRpcMetricsCollectorUtils$.collectMetrics(SparkConnectRpcMetricsCollector.scala:258)
	at org.apache.spark.sql.connect.service.SparkConnectAnalyzeHandler.handle(SparkConnectAnalyzeHandler.scala:50)
	at org.apache.spark.sql.connect.service.SparkConnectService.analyzePlan(SparkConnectService.scala:109)
	at org.apache.spark.connect.proto.SparkConnectServiceGrpc$MethodHandlers.invoke(SparkConnectServiceGrpc.java:801)
	at grpc_shaded.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)
	at grpc_shaded.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at grpc_shaded.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at grpc_shaded.io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at grpc_shaded.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at grpc_shaded.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at grpc_shaded.io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)
	at com.databricks.spark.connect.service.AuthenticationInterceptor$AuthenticatedServerCallListener.$anonfun$onHalfClose$1(AuthenticationInterceptor.scala:381)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at com.databricks.spark.connect.service.RequestContext.$anonfun$runWith$3(RequestContext.scala:337)
	at com.databricks.spark.connect.service.RequestContext$.com$databricks$spark$connect$service$RequestContext$$withLocalProperties(RequestContext.scala:537)
	at com.databricks.spark.connect.service.RequestContext.$anonfun$runWith$2(RequestContext.scala:337)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.UniverseAttributionContextWrapper.withValue(AttributionContextUtils.scala:242)
	at com.databricks.spark.connect.service.RequestContext.$anonfun$runWith$1(RequestContext.scala:336)
	at com.databricks.spark.connect.service.RequestContext.withContext(RequestContext.scala:349)
	at com.databricks.spark.connect.service.RequestContext.runWith(RequestContext.scala:329)
	at com.databricks.spark.connect.service.AuthenticationInterceptor$AuthenticatedServerCallListener.onHalfClose(AuthenticationInterceptor.scala:381)
	at grpc_shaded.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:351)
	at grpc_shaded.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861)
	at grpc_shaded.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at grpc_shaded.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at org.apache.spark.util.threads.SparkThreadLocalCapturingRunnable.$anonfun$run$1(SparkThreadLocalForwardingThreadPoolExecutor.scala:165)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)
	at org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.$anonfun$runWithCaptured$6(SparkThreadLocalForwardingThreadPoolExecutor.scala:119)
	at com.databricks.sql.transaction.tahoe.mst.MSTThreadHelper$.runWithMstTxnId(MSTThreadHelper.scala:57)
	at org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.$anonfun$runWithCaptured$5(SparkThreadLocalForwardingThreadPoolExecutor.scala:118)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.$anonfun$runWithCaptured$4(SparkThreadLocalForwardingThreadPoolExecutor.scala:117)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.runWithCaptured(SparkThreadLocalForwardingThreadPoolExecutor.scala:116)
	at org.apache.spark.util.threads.SparkThreadLocalCapturingHelper.runWithCaptured$(SparkThreadLocalForwardingThreadPoolExecutor.scala:93)
	at org.apache.spark.util.threads.SparkThreadLocalCapturingRunnable.runWithCaptured(SparkThreadLocalForwardingThreadPoolExecutor.scala:162)
	at org.apache.spark.util.threads.SparkThreadLocalCapturingRunnable.run(SparkThreadLocalForwardingThreadPoolExecutor.scala:165)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.lang.Thread.run(Thread.java:840)
Traceback (most recent call last):
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 1736, in _analyze
    resp = self._stub.AnalyzePlan(req, metadata=self.metadata())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_interceptor.py", line 277, in __call__
    response, ignored_call = self._with_call(
                             ^^^^^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_interceptor.py", line 332, in _with_call
    return call.result(), call
           ^^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 437, in result
    raise self
  File "/databricks/python/lib/python3.12/site-packages/grpc/_interceptor.py", line 315, in continuation
    response, call = self._thunk(new_method).with_call(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 1177, in with_call
    return _end_unary_response_blocking(state, call, True, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 1003, in _end_unary_response_blocking
    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.INTERNAL
	details = "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`DeliveryEntity` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`ReportingEntity`]. SQLSTATE: 42703; line 1 pos 0;
'Filter ((isnotnull('1286EXMP.exemption_condition_id) OR (isnotnull('var_lowest_ExemptionClaimConditonID_CP_RC) AND ('ExemptionConditionIdRC = 'var_lowest_ExemptionClaimConditonID_FAC_RC))) OR ('ExemptionConditionIdRC = 'var_lowest_ExemptionClaimConditonID_CP_RC))
+- 'Project ['CF.DeliveryEntity AS DeliveryEntity#3022619, 'CF.ReportingDate AS ReportingDate#3022620, 'CF.ReportingEntity AS ReportingEntity#3022621, 'CF.LocalFacilityIdentifier AS CreditFacilityID#3022622, 'CF.SourceSystemIdentifier AS CreditFacilitySourceSystemIdentifier#3022623, 'CF.CounterpartyID AS CounterpartyID#3022624, 'CF.CounterpartySourceSystemIdentifier AS CounterpartySourceSystemIdentifier#3022625, 'CF.BaselIIProductType AS BaselProductType#3022626, 'CF.PlNplIndicator AS PlNplIndicator#3022627, 'CF.SpecialisedLendingType AS SpecialisedLendingType#3022628, 'CF.ExemptionFromAdvancedInternalRatingBasedApproach AS SourcedExemptionId#3022629, 'PD_UCR.PDModelCode AS PDModelCode#3022630, 'PD_UCR.LastPerformingPDModelCode AS LastPerformingPDModelCode#3022631, 'IC.InterCompanyFlag AS InterCompanyFlag#3022632, 'LGD.LGDModelCode AS LGDModelCode#3022633, 'coalesce(CASE WHEN ('least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN BaselCreditRiskApproach#3023193 END, CASE WHEN ('1286EXMP.basel_approach = STD) THEN SA WHEN ('1286EXMP.basel_approach = FOU) THEN FIRB WHEN ('1286EXMP.basel_approach = IRB) THEN AIRB ELSE '1286EXMP.basel_approach END) AS BaselCreditRiskApproach#3022634, 'least('1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) AS E..."
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_message:"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `CF`.`DeliveryEntity` cannot be resolved. Did you mean one of the following? [`EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`DeliveryEntity`, `EXMP_CP_RC_JOINED`.`ReportingEntity`]. SQLSTATE: 42703; line 1 pos 0;\n\'Filter ((isnotnull(\'1286EXMP.exemption_condition_id) OR (isnotnull(\'var_lowest_ExemptionClaimConditonID_CP_RC) AND (\'ExemptionConditionIdRC = \'var_lowest_ExemptionClaimConditonID_FAC_RC))) OR (\'ExemptionConditionIdRC = \'var_lowest_ExemptionClaimConditonID_CP_RC))\n+- \'Project [\'CF.DeliveryEntity AS DeliveryEntity#3022619, \'CF.ReportingDate AS ReportingDate#3022620, \'CF.ReportingEntity AS ReportingEntity#3022621, \'CF.LocalFacilityIdentifier AS CreditFacilityID#3022622, \'CF.SourceSystemIdentifier AS CreditFacilitySourceSystemIdentifier#3022623, \'CF.CounterpartyID AS CounterpartyID#3022624, \'CF.CounterpartySourceSystemIdentifier AS CounterpartySourceSystemIdentifier#3022625, \'CF.BaselIIProductType AS BaselProductType#3022626, \'CF.PlNplIndicator AS PlNplIndicator#3022627, \'CF.SpecialisedLendingType AS SpecialisedLendingType#3022628, \'CF.ExemptionFromAdvancedInternalRatingBasedApproach AS SourcedExemptionId#3022629, \'PD_UCR.PDModelCode AS PDModelCode#3022630, \'PD_UCR.LastPerformingPDModelCode AS LastPerformingPDModelCode#3022631, \'IC.InterCompanyFlag AS InterCompanyFlag#3022632, \'LGD.LGDModelCode AS LGDModelCode#3022633, \'coalesce(CASE WHEN (\'least(\'1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) = var_lowest_ExemptionClaimConditonID_CP_RC#3022618) THEN BaselCreditRiskApproach#3023193 END, CASE WHEN (\'1286EXMP.basel_approach = STD) THEN SA WHEN (\'1286EXMP.basel_approach = FOU) THEN FIRB WHEN (\'1286EXMP.basel_approach = IRB) THEN AIRB ELSE \'1286EXMP.basel_approach END) AS BaselCreditRiskApproach#3022634, \'least(\'1286EXMP.exemption_condition_id, var_lowest_ExemptionClaimConditonID_CP_RC#3022618) AS E...", grpc_status:13, created_time:"2025-08-12T13:30:47.74302953+00:00"}"
>
