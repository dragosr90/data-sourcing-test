target: int_{{ RUN_MONTH }}.{{ DELIVERY_ENTITY }}_integrated_facility

sources:
  - alias: SSF_CF
    columns:
    - DeliveryEntity
    - LocalFacilityIdentifier
    - Default
    - DefaultDate
    - DefaultEndDate
    - NonperformingEndDate
    - NonperformingStartDate
    - PerformingIndicator
    - ReportingDate
    - AccruedFeesAmountDebitCreditIndicator
    - AccruedFeesAmountReportingAmount
    - AccruedFeesAmountReportingCurrency
    - AccruedFeesAmountTransactionAmount
    - AccruedFeesAmountTransactionCurrency
    - AlternativeLocalReferenceIdentifier
    - ApprovedLossGivenDefaultRatingDate
    - ArrangementParticipationType
    - BaselIIProductType
    - BookType
    - BorrowingBaseReportingAmount
    - BorrowingBaseReportingCurrency
    - BorrowingBaseTransactionAmount
    - BorrowingBaseTransactionCurrency
    - BusinessSegment
    - ContractStatus
    - ContractStatusDate
    - CreditAgreement
    - CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
    - CreditConversionFactor
    - CreditLimitReportingAmount
    - CreditLimitReportingCurrency
    - CreditLimitTransactionAmount
    - CreditLimitTransactionCurrency
    - CreditProductProgramSegment
    - DownturnLossGivenDefault
    - EADAmountBeforeApplicationOfConservatismReportingAmount
    - EADAmountBeforeApplicationOfConservatismReportingCurrency
    - EADAmountBeforeApplicationOfConservatismTransactionAmount
    - EADAmountBeforeApplicationOfConservatismTransactionCurrency
    - EADModelCode
    - ELBEPercentageBeforeApplicationOfConservatism
    - ExemptionFromAdvancedInternalRatingBasedApproach
    - ExposureAtDefaultReportingAmount
    - ExposureAtDefaultReportingCurrency
    - FacilityType
    - Forborne
    - ForborneDate
    - GlobalFacilityIdentifier
    - HighQualityIndicator
    - Ifrs9RiskStage
    - IncomeProducingRealEstateFinance
    - InfrastructuralSupportingFactor
    - InsuredFlag
    - LandAcquisitionDevelopmentAndConstructionExposureFinance
    - LGDMarginOfConservatism
    - LGDModelCode
    - LGDPercentageBeforeConservatism
    - LGDType
    - LoanLossAllowanceRcoa
    - LoanLossAllowanceReportingAmount
    - LoanLossAllowanceReportingCurrency
    - LoanLossAllowanceTransactionAmount
    - LoanLossAllowanceTransactionCurrency
    - LocalReferenceIdentifier
    - LossGivenDefaultClass
    - MaturityDate
    - ParentCreditFacility
    - ParentCreditFacilitySourceSystemIdentifier
    - PDMarginOfConservatism
    - PDModelCode
    - PDPercentageBeforeConservatism
    - PensionerFlag
    - PlNplIndicator
    - ProbabilityOfDefault
    - ProductProgram
    - ProjectFinancePhaseIndicator
    - ReportingEntity
    - Revolving
    - RiskWeightedExposureApproach
    - SourceSystemIdentifier
    - SpecialisedLendingType
    - ThroughTheCycleLossGivenDefault
    - TradeDate
    - TypeOfCommitment
    - UnadvisedCreditLimitReportingAmount
    - UnadvisedCreditLimitReportingCurrency
    - UnadvisedCreditLimitTransactionAmount
    - UnadvisedCreditLimitTransactionCurrency
    - UndrawnRcoa
    - UndrawnReportingAmount
    - UndrawnReportingCurrency
    - UndrawnTransactionAmount
    - UndrawnTransactionCurrency
    source: stg_{{ RUN_MONTH }}.ssf_{{ DELIVERY_ENTITY }}_cf
  - alias: SSF_FACILITY_ROLLUP
    columns:
    - DeliveryEntity
    - LocalFacilityIdentifier
    - ParentCreditFacility
    - HighestExistingFacility
    source: int_{{ RUN_MONTH }}.ssf_facility_rollup_{{ DELIVERY_ENTITY }}
  - alias: SSF_DUMMY_FACILITY
    columns:
    - DeliveryEntity
    - LocalFacilityIdentifier
    - Default
    - DefaultDate
    - DefaultEndDate
    - NonperformingEndDate
    - NonperformingStartDate
    - PerformingIndicator
    - ReportingDate
    - AccruedFeesAmountDebitCreditIndicator
    - AccruedFeesAmountReportingAmount
    - AccruedFeesAmountReportingCurrency
    - AccruedFeesAmountTransactionAmount
    - AccruedFeesAmountTransactionCurrency
    - AlternativeLocalReferenceIdentifier
    - ApprovedLossGivenDefaultRatingDate
    - ArrangementParticipationType
    - BaselIIProductType
    - BookType
    - BorrowingBaseReportingAmount
    - BorrowingBaseReportingCurrency
    - BorrowingBaseTransactionAmount
    - BorrowingBaseTransactionCurrency
    - BusinessSegment
    - ContractStatus
    - ContractStatusDate
    - CreditAgreement
    - CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
    - CreditConversionFactor
    - CreditLimitReportingAmount
    - CreditLimitReportingCurrency
    - CreditLimitTransactionAmount
    - CreditLimitTransactionCurrency
    - CreditProductProgramSegment
    - DownturnLossGivenDefault
    - EADAmountBeforeApplicationOfConservatismReportingAmount
    - EADAmountBeforeApplicationOfConservatismReportingCurrency
    - EADAmountBeforeApplicationOfConservatismTransactionAmount
    - EADAmountBeforeApplicationOfConservatismTransactionCurrency
    - EADModelCode
    - ELBEPercentageBeforeApplicationOfConservatism
    - ExemptionFromAdvancedInternalRatingBasedApproach
    - ExposureAtDefaultReportingAmount
    - ExposureAtDefaultReportingCurrency
    - FacilityType
    - Forborne
    - ForborneDate
    - GlobalFacilityIdentifier
    - HighQualityIndicator
    - Ifrs9RiskStage
    - IncomeProducingRealEstateFinance
    - InfrastructuralSupportingFactor
    - InsuredFlag
    - LandAcquisitionDevelopmentAndConstructionExposureFinance
    - LGDMarginOfConservatism
    - LGDModelCode
    - LGDPercentageBeforeConservatism
    - LGDType
    - LoanLossAllowanceRcoa
    - LoanLossAllowanceReportingAmount
    - LoanLossAllowanceReportingCurrency
    - LoanLossAllowanceTransactionAmount
    - LoanLossAllowanceTransactionCurrency
    - LocalReferenceIdentifier
    - LossGivenDefaultClass
    - MaturityDate
    - ParentCreditFacility
    - ParentCreditFacilitySourceSystemIdentifier
    - PDMarginOfConservatism
    - PDModelCode
    - PDPercentageBeforeConservatism
    - PensionerFlag
    - PlNplIndicator
    - ProbabilityOfDefault
    - ProductProgram
    - ProjectFinancePhaseIndicator
    - ReportingEntity
    - Revolving
    - RiskWeightedExposureApproach
    - SourceSystemIdentifier
    - SpecialisedLendingType
    - ThroughTheCycleLossGivenDefault
    - TradeDate
    - TypeOfCommitment
    - UnadvisedCreditLimitReportingAmount
    - UnadvisedCreditLimitReportingCurrency
    - UnadvisedCreditLimitTransactionAmount
    - UnadvisedCreditLimitTransactionCurrency
    - UndrawnRcoa
    - UndrawnReportingAmount
    - UndrawnReportingCurrency
    - UndrawnTransactionAmount
    - UndrawnTransactionCurrency
    source: int_{{ RUN_MONTH }}.{{ DELIVERY_ENTITY }}_dummy_facility

transformations:
  - aggregation:
      group: [HighestExistingFacility]
      column_mapping:
        DeliveryEntity: first(DeliveryEntity)
        HighestExistingFacility: first(HighestExistingFacility)
      source: SSF_FACILITY_ROLLUP
      alias: DISTINCT_HIGHEST_FACILITIES
  - join:
      left_source: SSF_CF
      right_source: DISTINCT_HIGHEST_FACILITIES
      condition:
      - SSF_CF.LocalFacilityIdentifier = DISTINCT_HIGHEST_FACILITIES.HighestExistingFacility
      how: inner
      alias: CF_WITH_HIGHEST_FACILITIES
  - union:
      alias: FINAL_UNION
      column_mapping:
        CF_WITH_HIGHEST_FACILITIES:
          DeliveryEntity: DeliveryEntity
          LocalFacilityIdentifier: LocalFacilityIdentifier
          Default: Default
          DefaultDate: DefaultDate
          DefaultEndDate: DefaultEndDate
          NonperformingEndDate: NonperformingEndDate
          NonperformingStartDate: NonperformingStartDate
          PerformingIndicator: PerformingIndicator
          ReportingDate: ReportingDate
          AccruedFeesAmountDebitCreditIndicator: AccruedFeesAmountDebitCreditIndicator
          AccruedFeesAmountReportingAmount: AccruedFeesAmountReportingAmount
          AccruedFeesAmountReportingCurrency: AccruedFeesAmountReportingCurrency
          AccruedFeesAmountTransactionAmount: AccruedFeesAmountTransactionAmount
          AccruedFeesAmountTransactionCurrency: AccruedFeesAmountTransactionCurrency
          AlternativeLocalReferenceIdentifier: AlternativeLocalReferenceIdentifier
          ApprovedLossGivenDefaultRatingDate: ApprovedLossGivenDefaultRatingDate
          ArrangementParticipationType: ArrangementParticipationType
          BaselIIProductType: BaselIIProductType
          BookType: BookType
          BorrowingBaseReportingAmount: BorrowingBaseReportingAmount
          BorrowingBaseReportingCurrency: BorrowingBaseReportingCurrency
          BorrowingBaseTransactionAmount: BorrowingBaseTransactionAmount
          BorrowingBaseTransactionCurrency: BorrowingBaseTransactionCurrency
          BusinessSegment: BusinessSegment
          ContractStatus: ContractStatus
          ContractStatusDate: ContractStatusDate
          CreditAgreement: CreditAgreement
          CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator: CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
          CreditConversionFactor: CreditConversionFactor
          CreditLimitReportingAmount: CreditLimitReportingAmount
          CreditLimitReportingCurrency: CreditLimitReportingCurrency
          CreditLimitTransactionAmount: CreditLimitTransactionAmount
          CreditLimitTransactionCurrency: CreditLimitTransactionCurrency
          CreditProductProgramSegment: CreditProductProgramSegment
          DownturnLossGivenDefault: DownturnLossGivenDefault
          EADAmountBeforeApplicationOfConservatismReportingAmount: EADAmountBeforeApplicationOfConservatismReportingAmount
          EADAmountBeforeApplicationOfConservatismReportingCurrency: EADAmountBeforeApplicationOfConservatismReportingCurrency
          EADAmountBeforeApplicationOfConservatismTransactionAmount: EADAmountBeforeApplicationOfConservatismTransactionAmount
          EADAmountBeforeApplicationOfConservatismTransactionCurrency: EADAmountBeforeApplicationOfConservatismTransactionCurrency
          EADModelCode: EADModelCode
          ELBEPercentageBeforeApplicationOfConservatism: ELBEPercentageBeforeApplicationOfConservatism
          ExemptionFromAdvancedInternalRatingBasedApproach: ExemptionFromAdvancedInternalRatingBasedApproach
          ExposureAtDefaultReportingAmount: ExposureAtDefaultReportingAmount
          ExposureAtDefaultReportingCurrency: ExposureAtDefaultReportingCurrency
          FacilityType: FacilityType
          Forborne: Forborne
          ForborneDate: ForborneDate
          GlobalFacilityIdentifier: GlobalFacilityIdentifier
          HighQualityIndicator: HighQualityIndicator
          Ifrs9RiskStage: Ifrs9RiskStage
          IncomeProducingRealEstateFinance: IncomeProducingRealEstateFinance
          InfrastructuralSupportingFactor: InfrastructuralSupportingFactor
          InsuredFlag: InsuredFlag
          LandAcquisitionDevelopmentAndConstructionExposureFinance: LandAcquisitionDevelopmentAndConstructionExposureFinance
          LGDMarginOfConservatism: LGDMarginOfConservatism
          LGDModelCode: LGDModelCode
          LGDPercentageBeforeConservatism: LGDPercentageBeforeConservatism
          LGDType: LGDType
          LoanLossAllowanceRcoa: LoanLossAllowanceRcoa
          LoanLossAllowanceReportingAmount: LoanLossAllowanceReportingAmount
          LoanLossAllowanceReportingCurrency: LoanLossAllowanceReportingCurrency
          LoanLossAllowanceTransactionAmount: LoanLossAllowanceTransactionAmount
          LoanLossAllowanceTransactionCurrency: LoanLossAllowanceTransactionCurrency
          LocalReferenceIdentifier: LocalReferenceIdentifier
          LossGivenDefaultClass: LossGivenDefaultClass
          MaturityDate: MaturityDate
          ParentCreditFacility: ParentCreditFacility
          ParentCreditFacilitySourceSystemIdentifier: ParentCreditFacilitySourceSystemIdentifier
          PDMarginOfConservatism: PDMarginOfConservatism
          PDModelCode: PDModelCode
          PDPercentageBeforeConservatism: PDPercentageBeforeConservatism
          PensionerFlag: PensionerFlag
          PlNplIndicator: PlNplIndicator
          ProbabilityOfDefault: ProbabilityOfDefault
          ProductProgram: ProductProgram
          ProjectFinancePhaseIndicator: ProjectFinancePhaseIndicator
          ReportingEntity: ReportingEntity
          Revolving: Revolving
          RiskWeightedExposureApproach: RiskWeightedExposureApproach
          SourceSystemIdentifier: SourceSystemIdentifier
          SpecialisedLendingType: SpecialisedLendingType
          ThroughTheCycleLossGivenDefault: ThroughTheCycleLossGivenDefault
          TradeDate: TradeDate
          TypeOfCommitment: TypeOfCommitment
          UnadvisedCreditLimitReportingAmount: UnadvisedCreditLimitReportingAmount
          UnadvisedCreditLimitReportingCurrency: UnadvisedCreditLimitReportingCurrency
          UnadvisedCreditLimitTransactionAmount: UnadvisedCreditLimitTransactionAmount
          UnadvisedCreditLimitTransactionCurrency: UnadvisedCreditLimitTransactionCurrency
          UndrawnRcoa: UndrawnRcoa
          UndrawnReportingAmount: UndrawnReportingAmount
          UndrawnReportingCurrency: UndrawnReportingCurrency
          UndrawnTransactionAmount: UndrawnTransactionAmount
          UndrawnTransactionCurrency: UndrawnTransactionCurrency
        SSF_DUMMY_FACILITY:
          DeliveryEntity: DeliveryEntity
          LocalFacilityIdentifier: LocalFacilityIdentifier
          Default: Default
          DefaultDate: DefaultDate
          DefaultEndDate: DefaultEndDate
          NonperformingEndDate: NonperformingEndDate
          NonperformingStartDate: NonperformingStartDate
          PerformingIndicator: PerformingIndicator
          ReportingDate: ReportingDate
          AccruedFeesAmountDebitCreditIndicator: AccruedFeesAmountDebitCreditIndicator
          AccruedFeesAmountReportingAmount: AccruedFeesAmountReportingAmount
          AccruedFeesAmountReportingCurrency: AccruedFeesAmountReportingCurrency
          AccruedFeesAmountTransactionAmount: AccruedFeesAmountTransactionAmount
          AccruedFeesAmountTransactionCurrency: AccruedFeesAmountTransactionCurrency
          AlternativeLocalReferenceIdentifier: AlternativeLocalReferenceIdentifier
          ApprovedLossGivenDefaultRatingDate: ApprovedLossGivenDefaultRatingDate
          ArrangementParticipationType: ArrangementParticipationType
          BaselIIProductType: BaselIIProductType
          BookType: BookType
          BorrowingBaseReportingAmount: BorrowingBaseReportingAmount
          BorrowingBaseReportingCurrency: BorrowingBaseReportingCurrency
          BorrowingBaseTransactionAmount: BorrowingBaseTransactionAmount
          BorrowingBaseTransactionCurrency: BorrowingBaseTransactionCurrency
          BusinessSegment: BusinessSegment
          ContractStatus: ContractStatus
          ContractStatusDate: ContractStatusDate
          CreditAgreement: CreditAgreement
          CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator: CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
          CreditConversionFactor: CreditConversionFactor
          CreditLimitReportingAmount: CreditLimitReportingAmount
          CreditLimitReportingCurrency: CreditLimitReportingCurrency
          CreditLimitTransactionAmount: CreditLimitTransactionAmount
          CreditLimitTransactionCurrency: CreditLimitTransactionCurrency
          CreditProductProgramSegment: CreditProductProgramSegment
          DownturnLossGivenDefault: DownturnLossGivenDefault
          EADAmountBeforeApplicationOfConservatismReportingAmount: EADAmountBeforeApplicationOfConservatismReportingAmount
          EADAmountBeforeApplicationOfConservatismReportingCurrency: EADAmountBeforeApplicationOfConservatismReportingCurrency
          EADAmountBeforeApplicationOfConservatismTransactionAmount: EADAmountBeforeApplicationOfConservatismTransactionAmount
          EADAmountBeforeApplicationOfConservatismTransactionCurrency: EADAmountBeforeApplicationOfConservatismTransactionCurrency
          EADModelCode: EADModelCode
          ELBEPercentageBeforeApplicationOfConservatism: ELBEPercentageBeforeApplicationOfConservatism
          ExemptionFromAdvancedInternalRatingBasedApproach: ExemptionFromAdvancedInternalRatingBasedApproach
          ExposureAtDefaultReportingAmount: ExposureAtDefaultReportingAmount
          ExposureAtDefaultReportingCurrency: ExposureAtDefaultReportingCurrency
          FacilityType: FacilityType
          Forborne: Forborne
          ForborneDate: ForborneDate
          GlobalFacilityIdentifier: GlobalFacilityIdentifier
          HighQualityIndicator: HighQualityIndicator
          Ifrs9RiskStage: Ifrs9RiskStage
          IncomeProducingRealEstateFinance: IncomeProducingRealEstateFinance
          InfrastructuralSupportingFactor: InfrastructuralSupportingFactor
          InsuredFlag: InsuredFlag
          LandAcquisitionDevelopmentAndConstructionExposureFinance: LandAcquisitionDevelopmentAndConstructionExposureFinance
          LGDMarginOfConservatism: LGDMarginOfConservatism
          LGDModelCode: LGDModelCode
          LGDPercentageBeforeConservatism: LGDPercentageBeforeConservatism
          LGDType: LGDType
          LoanLossAllowanceRcoa: LoanLossAllowanceRcoa
          LoanLossAllowanceReportingAmount: LoanLossAllowanceReportingAmount
          LoanLossAllowanceReportingCurrency: LoanLossAllowanceReportingCurrency
          LoanLossAllowanceTransactionAmount: LoanLossAllowanceTransactionAmount
          LoanLossAllowanceTransactionCurrency: LoanLossAllowanceTransactionCurrency
          LocalReferenceIdentifier: LocalReferenceIdentifier
          LossGivenDefaultClass: LossGivenDefaultClass
          MaturityDate: MaturityDate
          ParentCreditFacility: ParentCreditFacility
          ParentCreditFacilitySourceSystemIdentifier: ParentCreditFacilitySourceSystemIdentifier
          PDMarginOfConservatism: PDMarginOfConservatism
          PDModelCode: PDModelCode
          PDPercentageBeforeConservatism: PDPercentageBeforeConservatism
          PensionerFlag: PensionerFlag
          PlNplIndicator: PlNplIndicator
          ProbabilityOfDefault: ProbabilityOfDefault
          ProductProgram: ProductProgram
          ProjectFinancePhaseIndicator: ProjectFinancePhaseIndicator
          ReportingEntity: ReportingEntity
          Revolving: Revolving
          RiskWeightedExposureApproach: RiskWeightedExposureApproach
          SourceSystemIdentifier: SourceSystemIdentifier
          SpecialisedLendingType: SpecialisedLendingType
          ThroughTheCycleLossGivenDefault: ThroughTheCycleLossGivenDefault
          TradeDate: TradeDate
          TypeOfCommitment: TypeOfCommitment
          UnadvisedCreditLimitReportingAmount: UnadvisedCreditLimitReportingAmount
          UnadvisedCreditLimitReportingCurrency: UnadvisedCreditLimitReportingCurrency
          UnadvisedCreditLimitTransactionAmount: UnadvisedCreditLimitTransactionAmount
          UnadvisedCreditLimitTransactionCurrency: UnadvisedCreditLimitTransactionCurrency
          UndrawnRcoa: UndrawnRcoa
          UndrawnReportingAmount: UndrawnReportingAmount
          UndrawnReportingCurrency: UndrawnReportingCurrency
          UndrawnTransactionAmount: UndrawnTransactionAmount
          UndrawnTransactionCurrency: UndrawnTransactionCurrency

expressions:
  DeliveryEntity: FINAL_UNION.DeliveryEntity
  LocalFacilityIdentifier: FINAL_UNION.LocalFacilityIdentifier
  Default: FINAL_UNION.Default
  DefaultDate: FINAL_UNION.DefaultDate
  DefaultEndDate: FINAL_UNION.DefaultEndDate
  NonperformingEndDate: FINAL_UNION.NonperformingEndDate
  NonperformingStartDate: FINAL_UNION.NonperformingStartDate
  PerformingIndicator: FINAL_UNION.PerformingIndicator
  ReportingDate: FINAL_UNION.ReportingDate
  AccruedFeesAmountDebitCreditIndicator: FINAL_UNION.AccruedFeesAmountDebitCreditIndicator
  AccruedFeesAmountReportingAmount: FINAL_UNION.AccruedFeesAmountReportingAmount
  AccruedFeesAmountReportingCurrency: FINAL_UNION.AccruedFeesAmountReportingCurrency
  AccruedFeesAmountTransactionAmount: FINAL_UNION.AccruedFeesAmountTransactionAmount
  AccruedFeesAmountTransactionCurrency: FINAL_UNION.AccruedFeesAmountTransactionCurrency
  AlternativeLocalReferenceIdentifier: FINAL_UNION.AlternativeLocalReferenceIdentifier
  ApprovedLossGivenDefaultRatingDate: FINAL_UNION.ApprovedLossGivenDefaultRatingDate
  ArrangementParticipationType: FINAL_UNION.ArrangementParticipationType
  BaselIIProductType: FINAL_UNION.BaselIIProductType
  BookType: FINAL_UNION.BookType
  BorrowingBaseReportingAmount: FINAL_UNION.BorrowingBaseReportingAmount
  BorrowingBaseReportingCurrency: FINAL_UNION.BorrowingBaseReportingCurrency
  BorrowingBaseTransactionAmount: FINAL_UNION.BorrowingBaseTransactionAmount
  BorrowingBaseTransactionCurrency: FINAL_UNION.BorrowingBaseTransactionCurrency
  BusinessSegment: FINAL_UNION.BusinessSegment
  ContractStatus: FINAL_UNION.ContractStatus
  ContractStatusDate: FINAL_UNION.ContractStatusDate
  CreditAgreement: FINAL_UNION.CreditAgreement
  CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator: FINAL_UNION.CreditAssessmentForDrawDownUnderUnadvisedCreditLimitIndicator
  CreditConversionFactor: FINAL_UNION.CreditConversionFactor
  CreditLimitReportingAmount: FINAL_UNION.CreditLimitReportingAmount
  CreditLimitReportingCurrency: FINAL_UNION.CreditLimitReportingCurrency
  CreditLimitTransactionAmount: FINAL_UNION.CreditLimitTransactionAmount
  CreditLimitTransactionCurrency: FINAL_UNION.CreditLimitTransactionCurrency
  CreditProductProgramSegment: FINAL_UNION.CreditProductProgramSegment
  DownturnLossGivenDefault: FINAL_UNION.DownturnLossGivenDefault
  EADAmountBeforeApplicationOfConservatismReportingAmount: FINAL_UNION.EADAmountBeforeApplicationOfConservatismReportingAmount
  EADAmountBeforeApplicationOfConservatismReportingCurrency: FINAL_UNION.EADAmountBeforeApplicationOfConservatismReportingCurrency
  EADAmountBeforeApplicationOfConservatismTransactionAmount: FINAL_UNION.EADAmountBeforeApplicationOfConservatismTransactionAmount
  EADAmountBeforeApplicationOfConservatismTransactionCurrency: FINAL_UNION.EADAmountBeforeApplicationOfConservatismTransactionCurrency
  EADModelCode: FINAL_UNION.EADModelCode
  ELBEPercentageBeforeApplicationOfConservatism: FINAL_UNION.ELBEPercentageBeforeApplicationOfConservatism
  ExemptionFromAdvancedInternalRatingBasedApproach: FINAL_UNION.ExemptionFromAdvancedInternalRatingBasedApproach
  ExposureAtDefaultReportingAmount: FINAL_UNION.ExposureAtDefaultReportingAmount
  ExposureAtDefaultReportingCurrency: FINAL_UNION.ExposureAtDefaultReportingCurrency
  FacilityType: FINAL_UNION.FacilityType
  Forborne: FINAL_UNION.Forborne
  ForborneDate: FINAL_UNION.ForborneDate
  GlobalFacilityIdentifier: FINAL_UNION.GlobalFacilityIdentifier
  HighQualityIndicator: FINAL_UNION.HighQualityIndicator
  Ifrs9RiskStage: FINAL_UNION.Ifrs9RiskStage
  IncomeProducingRealEstateFinance: FINAL_UNION.IncomeProducingRealEstateFinance
  InfrastructuralSupportingFactor: FINAL_UNION.InfrastructuralSupportingFactor
  InsuredFlag: FINAL_UNION.InsuredFlag
  LandAcquisitionDevelopmentAndConstructionExposureFinance: FINAL_UNION.LandAcquisitionDevelopmentAndConstructionExposureFinance
  LGDMarginOfConservatism: FINAL_UNION.LGDMarginOfConservatism
  LGDModelCode: FINAL_UNION.LGDModelCode
  LGDPercentageBeforeConservatism: FINAL_UNION.LGDPercentageBeforeConservatism
  LGDType: FINAL_UNION.LGDType
  LoanLossAllowanceRcoa: FINAL_UNION.LoanLossAllowanceRcoa
  LoanLossAllowanceReportingAmount: FINAL_UNION.LoanLossAllowanceReportingAmount
  LoanLossAllowanceReportingCurrency: FINAL_UNION.LoanLossAllowanceReportingCurrency
  LoanLossAllowanceTransactionAmount: FINAL_UNION.LoanLossAllowanceTransactionAmount
  LoanLossAllowanceTransactionCurrency: FINAL_UNION.LoanLossAllowanceTransactionCurrency
  LocalReferenceIdentifier: FINAL_UNION.LocalReferenceIdentifier
  LossGivenDefaultClass: FINAL_UNION.LossGivenDefaultClass
  MaturityDate: FINAL_UNION.MaturityDate
  ParentCreditFacility: FINAL_UNION.ParentCreditFacility
  ParentCreditFacilitySourceSystemIdentifier: FINAL_UNION.ParentCreditFacilitySourceSystemIdentifier
  PDMarginOfConservatism: FINAL_UNION.PDMarginOfConservatism
  PDModelCode: FINAL_UNION.PDModelCode
  PDPercentageBeforeConservatism: FINAL_UNION.PDPercentageBeforeConservatism
  PensionerFlag: FINAL_UNION.PensionerFlag
  PlNplIndicator: FINAL_UNION.PlNplIndicator
  ProbabilityOfDefault: FINAL_UNION.ProbabilityOfDefault
  ProductProgram: FINAL_UNION.ProductProgram
  ProjectFinancePhaseIndicator: FINAL_UNION.ProjectFinancePhaseIndicator
  ReportingEntity: FINAL_UNION.ReportingEntity
  Revolving: FINAL_UNION.Revolving
  RiskWeightedExposureApproach: FINAL_UNION.RiskWeightedExposureApproach
  SourceSystemIdentifier: FINAL_UNION.SourceSystemIdentifier
  SpecialisedLendingType: FINAL_UNION.SpecialisedLendingType
  ThroughTheCycleLossGivenDefault: FINAL_UNION.ThroughTheCycleLossGivenDefault
  TradeDate: FINAL_UNION.TradeDate
  TypeOfCommitment: FINAL_UNION.TypeOfCommitment
  UnadvisedCreditLimitReportingAmount: FINAL_UNION.UnadvisedCreditLimitReportingAmount
  UnadvisedCreditLimitReportingCurrency: FINAL_UNION.UnadvisedCreditLimitReportingCurrency
  UnadvisedCreditLimitTransactionAmount: FINAL_UNION.UnadvisedCreditLimitTransactionAmount
  UnadvisedCreditLimitTransactionCurrency: FINAL_UNION.UnadvisedCreditLimitTransactionCurrency
  UndrawnRcoa: FINAL_UNION.UndrawnRcoa
  UndrawnReportingAmount: FINAL_UNION.UndrawnReportingAmount
  UndrawnReportingCurrency: FINAL_UNION.UndrawnReportingCurrency
  UndrawnTransactionAmount: FINAL_UNION.UndrawnTransactionAmount
  UndrawnTransactionCurrency: FINAL_UNION.UndrawnTransactionCurrency

drop_duplicates: true

filter_target:
- DeliveryEntity = '{{ DELIVERY_ENTITY }}'
