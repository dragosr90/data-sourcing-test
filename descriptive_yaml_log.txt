3:
Validate YAML


validate_business_logic_mapping(spark, business_logic_dict)


2025-05-20 12:55:14 [INFO] validate:  YAML format validated successfully
2025-05-20 12:55:18 [INFO] validate:  Sources validated successfully
2025-05-20 12:55:19 [INFO] validate_add_variables:  Variables validated successfully
2025-05-20 12:55:19 [INFO] validate_aggregation:  Aggregations validated successfully
2025-05-20 12:55:20 [INFO] validate_join:  Joins validated successfully
2025-05-20 12:55:20 [INFO] validate_aggregation:  Aggregations validated successfully
2025-05-20 12:55:20 [ERROR] validate_sql_expressions:  Problem with expression(s):
2025-05-20 12:55:20 [ERROR] validate_sql_expressions:  min(HIST_ALL_RATINGS.RATING_ID): [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `HIST_ALL_RATINGS`.`COMPANY_ID` cannot be resolved. Did you mean one of the following? [`HIST_PERF_RATINGS`.`COMPANY_ID`, `HIST_PERF_RATINGS`.`RATING_ID`, `HIST_PERF_RATINGS`.`PORTFOLIO`, `HIST_PERF_RATINGS`.`APPROVED_UCR`, `HIST_PERF_RATINGS`.`BUSINESSLINE`]. SQLSTATE: 42703
2025-05-20 12:55:20 [ERROR] validate_aggregation:  Issue with aggregated data LOWEST_RATING
2025-05-20 12:55:20 [ERROR] validate_sql_expressions:  Problem with expression(s):
2025-05-20 12:55:20 [ERROR] validate_sql_expressions:  LOWEST_RATING.PORTFOLIO = HIST_ALL_RATING.PORTFOLIO: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `HIST_ALL_RATING`.`PORTFOLIO` cannot be resolved. Did you mean one of the following? [`HIST_ALL_RATINGS`.`PORTFOLIO`, `LOWEST_RATING`.`PORTFOLIO`, `HIST_ALL_RATINGS`.`RATING_ID`, `HIST_ALL_RATINGS`.`COMPANY_ID`, `HIST_ALL_RATINGS`.`BUSINESSLINE`]. SQLSTATE: 42703
LOWEST_RATING.BUSINESSLINE = HIST_ALL_RATING.BUSINESSLINE: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `HIST_ALL_RATING`.`BUSINESSLINE` cannot be resolved. Did you mean one of the following? [`HIST_ALL_RATINGS`.`BUSINESSLINE`, `LOWEST_RATING`.`BUSINESSLINE`, `HIST_ALL_RATINGS`.`PORTFOLIO`, `HIST_ALL_RATINGS`.`RATING_ID`, `HIST_ALL_RATINGS`.`COMPANY_ID`]. SQLSTATE: 42703
LOWEST_RATING.min_rating_id = HIST_ALL_RATING.RATING_ID: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `HIST_ALL_RATING`.`RATING_ID` cannot be resolved. Did you mean one of the following? [`HIST_ALL_RATINGS`.`RATING_ID`, `HIST_ALL_RATINGS`.`COMPANY_ID`, `HIST_ALL_RATINGS`.`PORTFOLIO`, `HIST_ALL_RATINGS`.`BUSINESSLINE`, `LOWEST_RATING`.`COMPANY_ID`]. SQLSTATE: 42703
2025-05-20 12:55:21 [INFO] validate_aggregation:  Aggregations validated successfully
2025-05-20 12:55:21 [INFO] validate_join:  Joins validated successfully
2025-05-20 12:55:21 [INFO] validate_join:  Joins validated successfully
False
