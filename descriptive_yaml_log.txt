11:
Validate YAML
validate_business_logic_mapping(spark, business_logic_dict)

2025-04-29 08:29:23 [INFO] validate:  YAML format validated successfully
2025-04-29 08:29:30 [INFO] validate:  Sources validated successfully
2025-04-29 08:29:31 [INFO] validate_join:  Joins validated successfully
2025-04-29 08:29:31 [INFO] validate_join:  Joins validated successfully
2025-04-29 08:29:31 [INFO] validate_join:  Joins validated successfully
2025-04-29 08:29:32 [ERROR] validate_sql_expressions:  Problem with expression(s):
2025-04-29 08:29:32 [ERROR] validate_sql_expressions:  case when FACILITY_CF_JOIN.Default is not null and FACILITY_CF_JOIN.Default = 'Y' then TRUE else FALSE end: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `FACILITY_CF_JOIN`.`Default` cannot be resolved. Did you mean one of the following? [`FACILITY_CF_CFXCP_JOIN`.`Default`, `ALL_JOINS`.`Default`, `FACILITY_CF_CFXCP_JOIN`.`DefaultDate`, `ALL_JOINS`.`DefaultDate`, `FACILITY_CF_CFXCP_JOIN`.`DefaultEndDate`]. SQLSTATE: 42703
case when FACILITY_CF_JOIN.Default is not null and FACILITY_CF_JOIN.Default = 'Y' then 'ssf_ihubbe1_cf' else null end: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `FACILITY_CF_JOIN`.`Default` cannot be resolved. Did you mean one of the following? [`FACILITY_CF_CFXCP_JOIN`.`Default`, `ALL_JOINS`.`Default`, `FACILITY_CF_CFXCP_JOIN`.`DefaultDate`, `ALL_JOINS`.`DefaultDate`, `FACILITY_CF_CFXCP_JOIN`.`DefaultEndDate`]. SQLSTATE: 42703
case when FACILITY_CF_JOIN.Default is not null and FACILITY_CF_JOIN.Default = 'Y' then 'stg_202412.ssf_ihubbe1_cf' else 'Joined rollup (int_202412.ssf_facility_rollup_ihubbe1 and CF (stg_202412.ssf_ihubbe1_cf))' end: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `FACILITY_CF_JOIN`.`Default` cannot be resolved. Did you mean one of the following? [`FACILITY_CF_CFXCP_JOIN`.`Default`, `ALL_JOINS`.`Default`, `FACILITY_CF_CFXCP_JOIN`.`DefaultDate`, `ALL_JOINS`.`DefaultDate`, `FACILITY_CF_CFXCP_JOIN`.`DefaultEndDate`]. SQLSTATE: 42703
False