11:
Validate YAML
validate_business_logic_mapping(spark, business_logic_dict)
2025-04-28 13:56:57 [INFO] validate:  YAML format validated successfully
2025-04-28 13:57:03 [INFO] validate:  Sources validated successfully
2025-04-28 13:57:04 [INFO] validate_join:  Joins validated successfully
2025-04-28 13:57:05 [ERROR] validate_sql_expressions:  Problem with expression(s):
2025-04-28 13:57:05 [ERROR] validate_sql_expressions:  SSF_CF.DeliveryEntity: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `SSF_CF`.`DeliveryEntity` cannot be resolved. Did you mean one of the following? [`SSF_CFXCP`.`delivery_entity`, `FACILITY_CF_JOIN`.`DeliveryEntity`, `SSF_CFXCP`.`creditfacility`, `FACILITY_CF_JOIN`.`Default`, `FACILITY_CF_JOIN`.`DefaultDate`]. SQLSTATE: 42703
SSF_CF.LocalFacilityIdentifier: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `SSF_CF`.`LocalFacilityIdentifier` cannot be resolved. Did you mean one of the following? [`FACILITY_CF_JOIN`.`LocalFacilityIdentifier`, `SSF_CFXCP`.`delivery_entity`, `SSF_CFXCP`.`creditfacility`, `FACILITY_CF_JOIN`.`Default`, `SSF_CFXCP`.`participatingcounterparty`]. SQLSTATE: 42703
2025-04-28 13:57:06 [ERROR] validate_sql_expressions:  Problem with expression(s):
2025-04-28 13:57:06 [ERROR] validate_sql_expressions:  SSF_CFXCP.delivery_entity: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `SSF_CFXCP`.`delivery_entity` cannot be resolved. Did you mean one of the following? [`SSF_COUNTERPARTY`.`DeliveryEntity`, `FACILITY_CF_CFXCP_JOIN`.`delivery_entity`, `SSF_COUNTERPARTY`.`Default`, `FACILITY_CF_CFXCP_JOIN`.`DeliveryEntity`, `SSF_COUNTERPARTY`.`DefaultDate`]. SQLSTATE: 42703
SSF_CFXCP.participatingcounterparty: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `SSF_CFXCP`.`participatingcounterparty` cannot be resolved. Did you mean one of the following? [`FACILITY_CF_CFXCP_JOIN`.`participatingcounterparty`, `SSF_COUNTERPARTY`.`DefaultDate`, `SSF_COUNTERPARTY`.`Default`, `SSF_COUNTERPARTY`.`DefaultEndDate`, `SSF_COUNTERPARTY`.`DeliveryEntity`]. SQLSTATE: 42703
2025-04-28 13:57:06 [ERROR] validate_sql_expressions:  Problem with expression(s):
2025-04-28 13:57:06 [ERROR] validate_sql_expressions:  case when SSF_CF.Default is not null and SSF_CF.Default = 'Y' then TRUE else FALSE end: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `SSF_CF`.`Default` cannot be resolved. Did you mean one of the following? [`ALL_JOINS`.`Default`, `SSF_COUNTERPARTY`.`Default`, `ALL_JOINS`.`DefaultDate`, `SSF_COUNTERPARTY`.`DefaultDate`, `ALL_JOINS`.`DefaultEndDate`]. SQLSTATE: 42703
case when var_is_default_filled then 'ssf_fbs_cf' else null end: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `var_is_default_filled` cannot be resolved. Did you mean one of the following? [`ALL_JOINS`.`Default`, `ALL_JOINS`.`DefaultDate`, `ALL_JOINS`.`DefaultEndDate`, `ALL_JOINS`.`creditfacility`, `SSF_COUNTERPARTY`.`Default`]. SQLSTATE: 42703
case when var_is_default_filled then 'stg_202412.ssf_fbs_cf' else 'Joined rollup (int_202412.ssf_facility_rollup_fbs and CF (stg_202412.ssf_fbs_cf))' end: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `var_is_default_filled` cannot be resolved. Did you mean one of the following? [`ALL_JOINS`.`Default`, `ALL_JOINS`.`DefaultDate`, `ALL_JOINS`.`DefaultEndDate`, `ALL_JOINS`.`creditfacility`, `SSF_COUNTERPARTY`.`Default`]. SQLSTATE: 42703
False