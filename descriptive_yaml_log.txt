3:
Validate YAML


validate_business_logic_mapping(spark, business_logic_dict)

2025-05-16 13:05:39 [INFO] validate:  YAML format validated successfully
2025-05-16 13:05:41 [INFO] validate:  Sources validated successfully
2025-05-16 13:05:41 [INFO] validate_add_variables:  Variables validated successfully
2025-05-16 13:05:41 [INFO] send_command:  Exception while sending command.
Traceback (most recent call last):
  File "/databricks/python/lib/python3.11/site-packages/IPython/core/interactiveshell.py", line 3526, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "/home/spark-51fbb64a-285d-48ef-beb8-aa/.ipykernel/33213/command-5742057650143326-1989910526", line 1, in <module>
    validate_business_logic_mapping(spark, business_logic_dict)
  File "/Workspace/Users/dragos-cosmin.raduta@nl.abnamro.com/bsrc-etl/src/validate/run_all.py", line 44, in validate_business_logic_mapping
    return all(
           ^^^^
  File "/Workspace/Users/dragos-cosmin.raduta@nl.abnamro.com/bsrc-etl/src/validate/run_all.py", line 45, in <genexpr>
    _validate_logic_element(c, spark, business_logic)
  File "/Workspace/Users/dragos-cosmin.raduta@nl.abnamro.com/bsrc-etl/src/validate/run_all.py", line 42, in _validate_logic_element
    return cls(spark, business_logic).validate()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Workspace/Users/dragos-cosmin.raduta@nl.abnamro.com/bsrc-etl/src/validate/transformations.py", line 188, in validate
    self.validate_transformation_step(
  File "/Workspace/Users/dragos-cosmin.raduta@nl.abnamro.com/bsrc-etl/src/validate/transformations.py", line 221, in validate_transformation_step
    return getattr(self, f_name)(
           ^^^^^^^^^^^^^^^^^^^^^^
TypeError: Transformations.validate_aggregation() missing 1 required positional argument: 'column_mapping'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/databricks/spark/python/lib/py4j-0.10.9.7-src.zip/py4j/clientserver.py", line 528, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/databricks/spark/python/lib/py4j-0.10.9.7-src.zip/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/lib/py4j-0.10.9.7-src.zip/py4j/clientserver.py", line 531, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
TypeError: Transformations.validate_aggregation() missing 1 required positional argument: 'column_mapping'
File <command-5742057650143326>, line 1
----> 1 validate_business_logic_mapping(spark, business_logic_dict)
File /Workspace/Users/dragos-cosmin.raduta@nl.abnamro.com/bsrc-etl/src/validate/transformations.py:221, in Transformations.validate_transformation_step(self, tf, available_sources, available_variables)
    219 f_name = f"validate_{tf_step}"
    220 kwgs = get_required_arguments(tf, self, f_name)
--> 221 return getattr(self, f_name)(
    222     **kwgs,
    223     available_sources=available_sources,
    224     available_variables=available_variables,
    225 )
