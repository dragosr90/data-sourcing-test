(bsrc-etl-venv) PS C:\Users\B25712\bsrc-etl-venv\bsrc-etl> pytest test/scripts/test_run_mapping.py
=========================================================================================== test session starts ============================================================================================
platform win32 -- Python 3.10.11, pytest-8.3.3, pluggy-1.5.0
rootdir: C:\Users\B25712\bsrc-etl-venv\bsrc-etl
configfile: pyproject.toml
plugins: cov-6.0.0, mock-3.14.0
collected 0 items / 1 error

================================================================================================== ERRORS ================================================================================================== 
____________________________________________________________________________ ERROR collecting test/scripts/test_run_mapping.py _____________________________________________________________________________ 
test\scripts\test_run_mapping.py:6: in <module>
    from abnamro_bsrc_etl.scripts.run_mapping import run_mapping
src\abnamro_bsrc_etl\scripts\run_mapping.py:27: in <module>
    dbutils.notebook.entry_point.getDbutils().notebook().getContext().userName().get()  # type: ignore  # noqa: PGH003
E   NameError: name 'dbutils' is not defined
============================================================================================= warnings summary ============================================================================================= 
..\bsrc-etl-venv\lib\site-packages\holidays\deprecations\v1_incompatibility.py:40
  C:\Users\B25712\bsrc-etl-venv\bsrc-etl-venv\lib\site-packages\holidays\deprecations\v1_incompatibility.py:40: FutureIncompatibilityWarning:

  This is a future version incompatibility warning from Holidays v0.62
  to inform you about an upcoming change in our API versioning strategy that may affect your
  project's dependencies. Starting from version 1.0 onwards, we will be following a loose form of
  Semantic Versioning (SemVer, https://semver.org) to provide clearer communication regarding any
  potential breaking changes.

  This means that while we strive to maintain backward compatibility, there might be occasional
  updates that introduce breaking changes to our API. To ensure the stability of your projects,
  we highly recommend pinning the version of our API that you rely on. You can pin your current
  holidays v0.x dependency (e.g., holidays==0.62) or limit it (e.g., holidays<1.0) in order to
  avoid potentially unwanted upgrade to the version 1.0 when it's released (ETA 2025Q1-Q2).

  If you have any questions or concerns regarding this change, please don't hesitate to reach out
  to us via https://github.com/vacanza/holidays/discussions/1800.

    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform win32, python 3.10.11-final-0 ----------
Name                                                             Stmts   Miss  Cover   Missing
----------------------------------------------------------------------------------------------
src\__init__.py                                                      0      0   100%
src\abnamro_bsrc_etl\__init__.py                                     0      0   100%
src\abnamro_bsrc_etl\config\__init__.py                              0      0   100%
src\abnamro_bsrc_etl\config\business_logic.py                       54      0   100%
src\abnamro_bsrc_etl\config\constants.py                             5      1    80%   5
src\abnamro_bsrc_etl\config\exceptions.py                           37     37     0%   1-91
src\abnamro_bsrc_etl\config\process.py                               7      7     0%   1-10
src\abnamro_bsrc_etl\config\schema.py                                5      2    60%   51-52
src\abnamro_bsrc_etl\config\ssf_tables.py                            2      2     0%   1-37
src\abnamro_bsrc_etl\dq\__init__.py                                  0      0   100%
src\abnamro_bsrc_etl\dq\dq_validation.py                           153    135    12%   47-109, 163-193, 209-261, 277-298, 330-362, 384-404, 426-498
src\abnamro_bsrc_etl\extract\__init__.py                             0      0   100%
src\abnamro_bsrc_etl\extract\master_data_sql.py                     96     71    26%   31-33, 37-38, 42, 59-88, 109-137, 149-156, 162-164, 188, 222-231, 285-300, 329-356
src\abnamro_bsrc_etl\month_setup\__init__.py                         0      0   100%
src\abnamro_bsrc_etl\month_setup\dial_derive_snapshotdate.py        36     27    25%   12-18, 28-37, 47-50, 69-85
src\abnamro_bsrc_etl\month_setup\metadata_log_tables.py             40     28    30%   23-84, 88-159, 166-203
src\abnamro_bsrc_etl\month_setup\setup_new_month.py                 29     29     0%   1-94
src\abnamro_bsrc_etl\scripts\__init__.py                             0      0   100%
src\abnamro_bsrc_etl\scripts\check_dependencies.py                  26     26     0%   1-186
src\abnamro_bsrc_etl\scripts\dial_check_delayed_files.py            27     27     0%   1-69
src\abnamro_bsrc_etl\scripts\dial_staging_process.py                65     65     0%   1-280
src\abnamro_bsrc_etl\scripts\export_tine_tables.py                  33     33     0%   1-123
src\abnamro_bsrc_etl\scripts\new_month_setup.py                      7      7     0%   1-18
src\abnamro_bsrc_etl\scripts\nonssf_staging_process.py              63     63     0%   1-279
src\abnamro_bsrc_etl\scripts\run_mapping.py                         38     25    34%   29-148
src\abnamro_bsrc_etl\scripts\ssf_staging_process.py                 58     58     0%   1-234
src\abnamro_bsrc_etl\scripts\ssf_staging_process_xml.py             24     24     0%   1-60
src\abnamro_bsrc_etl\staging\__init__.py                             0      0   100%
src\abnamro_bsrc_etl\staging\extract_base.py                        77     77     0%   1-420
src\abnamro_bsrc_etl\staging\extract_dial_data.py                   77     77     0%   1-360
src\abnamro_bsrc_etl\staging\extract_nonssf_data.py                153    153     0%   1-514
src\abnamro_bsrc_etl\staging\extract_ssf_data.py                   179    179     0%   1-622
src\abnamro_bsrc_etl\staging\status.py                              58     58     0%   1-162
src\abnamro_bsrc_etl\transform\__init__.py                           0      0   100%
src\abnamro_bsrc_etl\transform\complex_types.py                     15     15     0%   1-62
src\abnamro_bsrc_etl\transform\table_write_and_comment.py           79     64    19%   24-42, 47-123, 128-129, 137-149, 160-195, 202-205, 222-237
src\abnamro_bsrc_etl\transform\transform_business_logic_sql.py       9      4    56%   13-25
src\abnamro_bsrc_etl\utils\__init__.py                               0      0   100%
src\abnamro_bsrc_etl\utils\alias_util.py                            18     10    44%   14-19, 58-78, 101-109
src\abnamro_bsrc_etl\utils\azure_utils.py                            5      5     0%   1-13
src\abnamro_bsrc_etl\utils\export_parquet.py                        22     22     0%   1-68
src\abnamro_bsrc_etl\utils\get_dbutils.py                            6      6     0%   1-11
src\abnamro_bsrc_etl\utils\get_env.py                               12      6    50%   22-32, 48, 64, 84
src\abnamro_bsrc_etl\utils\logging_util.py                          10      0   100%
src\abnamro_bsrc_etl\utils\parameter_utils.py                       25     19    24%   33-53, 79-84, 105-116
src\abnamro_bsrc_etl\utils\parse_yaml.py                            53     42    21%   13-16, 21-42, 67-109, 134, 162-170
src\abnamro_bsrc_etl\utils\sources_util.py                          56     40    29%   18-28, 39, 52-53, 65-68, 81, 106-110, 122, 135-139, 149, 173-193, 201-218
src\abnamro_bsrc_etl\utils\table_logging.py                         19     11    42%   25-37, 54-56
src\abnamro_bsrc_etl\utils\table_schema.py                           6      6     0%   1-16
src\abnamro_bsrc_etl\utils\transformations_util.py                  20     12    40%   20-25, 39, 51, 65-68
src\abnamro_bsrc_etl\utils\xml_utils.py                             86     86     0%   1-219
src\abnamro_bsrc_etl\validate\__init__.py                            0      0   100%
src\abnamro_bsrc_etl\validate\base.py                                5      2    60%   6-7
src\abnamro_bsrc_etl\validate\expressions.py                        34     23    32%   24-27, 33-75
src\abnamro_bsrc_etl\validate\run_all.py                            15      5    67%   41-48
src\abnamro_bsrc_etl\validate\sources.py                            33     24    27%   12-13, 25-51, 54-67
src\abnamro_bsrc_etl\validate\transformations.py                   200    170    15%   52-54, 65-73, 76-94, 97-102, 119-168, 172-180, 183-236, 244-247, 259-269, 280-297, 307-317, 327-354, 362-370, 381-405, 426-431, 450-456, 476-487, 525-547, 574-593
src\abnamro_bsrc_etl\validate\validate_sql.py                       63     49    22%   23-63, 75-95, 118-124, 130
src\abnamro_bsrc_etl\validate\yaml.py                               19     14    26%   8, 11-34
----------------------------------------------------------------------------------------------
TOTAL                                                             2159   1846    14%
Coverage HTML written to dir htmlcov

========================================================================================= short test summary info ========================================================================================== 
ERROR test/scripts/test_run_mapping.py - NameError: name 'dbutils' is not defined
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 
======================================================================================= 1 warning, 1 error in 3.77s ========================================================================================
