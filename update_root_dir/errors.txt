SystemExit: 1
An exception has occurred, use %tb to see the full traceback.

SystemExit: 1

Workload failed, see run output for details
2025-09-12 13:45:18 [INFO] standardize_delivery_entity:  Standardized delivery entity 'FRP' to 'frp'
2025-09-12 13:45:18 [INFO] validate:  YAML format validated successfully
2025-09-12 13:45:20 [INFO] validate:  Sources validated successfully
2025-09-12 13:45:20 [INFO] validate_add_variables:  Variables validated successfully
2025-09-12 13:45:21 [INFO] validate_filter_conditions:  Filter conditions validated successfully
2025-09-12 13:45:21 [INFO] validate_filter:  Filter conditions validated successfully
2025-09-12 13:45:21 [INFO] validate_join:  Joins validated successfully
2025-09-12 13:45:21 [INFO] validate_add_variables:  Variables validated successfully
2025-09-12 13:45:21 [INFO] validate_pivot:  Pivot validated successfully
2025-09-12 13:45:21 [INFO] validate_add_variables:  Variables validated successfully
2025-09-12 13:45:23 [INFO] validate_aggregation:  Aggregations validated successfully
2025-09-12 13:45:23 [INFO] validate_join:  Joins validated successfully
2025-09-12 13:45:23 [INFO] validate_add_variables:  Variables validated successfully
2025-09-12 13:45:23 [INFO] validate:  Transformations validated successfully

2025-09-12 13:45:18 [INFO] standardize_delivery_entity:  Standardized delivery entity 'FRP' to 'frp'
2025-09-12 13:45:18 [INFO] validate:  YAML format validated successfully
2025-09-12 13:45:20 [INFO] validate:  Sources validated successfully
2025-09-12 13:45:20 [INFO] validate_add_variables:  Variables validated successfully
2025-09-12 13:45:21 [INFO] validate_filter_conditions:  Filter conditions validated successfully
2025-09-12 13:45:21 [INFO] validate_filter:  Filter conditions validated successfully
2025-09-12 13:45:21 [INFO] validate_join:  Joins validated successfully
2025-09-12 13:45:21 [INFO] validate_add_variables:  Variables validated successfully
2025-09-12 13:45:21 [INFO] validate_pivot:  Pivot validated successfully
2025-09-12 13:45:21 [INFO] validate_add_variables:  Variables validated successfully
2025-09-12 13:45:23 [INFO] validate_aggregation:  Aggregations validated successfully
2025-09-12 13:45:23 [INFO] validate_join:  Joins validated successfully
2025-09-12 13:45:23 [INFO] validate_add_variables:  Variables validated successfully
2025-09-12 13:45:23 [INFO] validate:  Transformations validated successfully


{"ts": "2025-09-12 13:45:24.023", "level": "ERROR", "logger": "SQLQueryContextLogger", "msg": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`BookType` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`book`, `DERIVATIVE`.`_valid`, `DERIVATIVE`.`md5code`, `DERIVATIVE`.`runid`, `DERIVATIVE`.`upi`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 37 more fields]\n      +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 36 more fields]\n         +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 35 more fields]\n            +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 34 more fields]\n               +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 33 more fields]\n                  +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 32 more fields]\n                     +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 31 more fields]\n                        +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 30 more fields]\n                           +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 29 more fields]\n                              +- Project [idx#372275L, ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, ... 30 more fields]\n                                 +- Join LeftOuter, (idx#372275L = idx#372430L)\n                                    :- SubqueryAlias AMOUNT_AGG\n                                    :  +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, monotonically_increasing_id() AS idx#372275L]\n                                    :     +- Project [AMOUNT_AGG.ai#372200 AS ai#372254, AMOUNT_AGG.derivativetrade#372201 AS derivativetrade#372255, AMOUNT_AGG.dirty_replacement_cost#372202 AS dirty_replacement_cost#372256, AMOUNT_AGG.fee_cd#372203 AS fee_cd#372257, AMOUNT_AGG.fee_et#372204 AS fee_et#372258, AMOUNT_AGG.mtmkt#372205 AS mtmkt#372259, AMOUNT_AGG.mtmkt_rcoa#372206 AS mtmkt_rcoa#372260, AMOUNT_AGG.notional#372207 AS notional#372261, AMOUNT_AGG.notional_rcoa#372208 AS notional_rcoa#372262, AMOUNT_AGG.notionaltransactioncurrency#372209 AS notionaltransactioncurrency#372263]\n                                    :        +- LocalRelation <empty>, [AMOUNT_AGG.ai#372200, AMOUNT_AGG.derivativetrade#372201, AMOUNT_AGG.dirty_replacement_cost#372202, AMOUNT_AGG.fee_cd#372203, AMOUNT_AGG.fee_et#372204, AMOUNT_AGG.mtmkt#372205, AMOUNT_AGG.mtmkt_rcoa#372206, AMOUNT_AGG.notional#372207, AMOUNT_AGG.notional_rcoa#372208, AMOUNT_AGG.notionaltransactioncurrency#372209, DERIVATIVE._load_dts#372210, DERIVATIVE._load_end_dts#372211, DERIVATIVE._row_hash#372212, DERIVATIVE._valid#372213, DERIVATIVE._valid_from#372214, DERIVATIVE._valid_to#372215, DERIVATIVE.accountinghedgemethod#372216, DERIVATIVE.accountinghedgerelationshipidentifier#372217, DERIVATIVE.accountinghedgerelationshiptype#372218, DERIVATIVE.accountingstandard#372219, DERIVATIVE.agreementpackageidentifier#372220, DERIVATIVE.book#372221, DERIVATIVE.businesssegment#372222, DERIVATIVE.buysellindicator#372223, DERIVATIVE.counterparty#372224, ... 29 more fields]\n                                    +- SubqueryAlias DERIVATIVE\n                                       +- Project [_load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, counterpartysourcesystemidentifier#372356, creditsupportannex#372357, creditsupportannexsourcesystemidentifier#372358, deliveryentity#372359, deliveryset#372360, derivativeagreementidentifier#372361, derivativetradeidentifier#372362, fairvaluehierarchy#372363, filename#372364, filereportingperiod#372365, ... 20 more fields]\n                                          +- Project [DERIVATIVE._load_dts#372297 AS _load_dts#372341, DERIVATIVE._load_end_dts#372298 AS _load_end_dts#372342, DERIVATIVE._row_hash#372299 AS _row_hash#372343, DERIVATIVE._valid#372300 AS _valid#372344, DERIVATIVE._valid_from#372301 AS _valid_from#372345, DERIVATIVE._valid_to#372302 AS _valid_to#372346, DERIVATIVE.accountinghedgemethod#372303 AS accountinghedgemethod#372347, DERIVATIVE.accountinghedgerelationshipidentifier#372304 AS accountinghedgerelationshipidentifier#372348, DERIVATIVE.accountinghedgerelationshiptype#372305 AS accountinghedgerelationshiptype#372349, DERIVATIVE.accountingstandard#372306 AS accountingstandard#372350, DERIVATIVE.agreementpackageidentifier#372307 AS agreementpackageidentifier#372351, DERIVATIVE.book#372308 AS book#372352, DERIVATIVE.businesssegment#372309 AS businesssegment#372353, DERIVATIVE.buysellindicator#372310 AS buysellindicator#372354, DERIVATIVE.counterparty#372311 AS counterparty#372355, DERIVATIVE.counterpartysourcesystemidentifier#372312 AS counterpartysourcesystemidentifier#372356, DERIVATIVE.creditsupportannex#372313 AS creditsupportannex#372357, DERIVATIVE.creditsupportannexsourcesystemidentifier#372314 AS creditsupportannexsourcesystemidentifier#372358, DERIVATIVE.deliveryentity#372315 AS deliveryentity#372359, DERIVATIVE.deliveryset#372316 AS deliveryset#372360, DERIVATIVE.derivativeagreementidentifier#372317 AS derivativeagreementidentifier#372361, DERIVATIVE.derivativetradeidentifier#372318 AS derivativetradeidentifier#372362, DERIVATIVE.fairvaluehierarchy#372319 AS fairvaluehierarchy#372363, DERIVATIVE.filename#372320 AS filename#372364, DERIVATIVE.filereportingperiod#372321 AS filereportingperiod#372365, ... 19 more fields]\n                                             +- LocalRelation <empty>, [AMOUNT_AGG.ai#372287, AMOUNT_AGG.derivativetrade#372288, AMOUNT_AGG.dirty_replacement_cost#372289, AMOUNT_AGG.fee_cd#372290, AMOUNT_AGG.fee_et#372291, AMOUNT_AGG.mtmkt#372292, AMOUNT_AGG.mtmkt_rcoa#372293, AMOUNT_AGG.notional#372294, AMOUNT_AGG.notional_rcoa#372295, AMOUNT_AGG.notionaltransactioncurrency#372296, DERIVATIVE._load_dts#372297, DERIVATIVE._load_end_dts#372298, DERIVATIVE._row_hash#372299, DERIVATIVE._valid#372300, DERIVATIVE._valid_from#372301, DERIVATIVE._valid_to#372302, DERIVATIVE.accountinghedgemethod#372303, DERIVATIVE.accountinghedgerelationshipidentifier#372304, DERIVATIVE.accountinghedgerelationshiptype#372305, DERIVATIVE.accountingstandard#372306, DERIVATIVE.agreementpackageidentifier#372307, DERIVATIVE.book#372308, DERIVATIVE.businesssegment#372309, DERIVATIVE.buysellindicator#372310, DERIVATIVE.counterparty#372311, ... 29 more fields]\n\n\nJVM stacktrace:\norg.apache.spark.sql.catalyst.ExtendedAnalysisException\n\tat org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)\n\tat scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)\n\tat scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:933)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:487)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:487)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:308)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$6(QueryExecution.scala:703)\n\tat org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:152)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:703)\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1342)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:696)\n\tat com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:692)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:692)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:295)\n\tat com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:294)\n\tat scala.util.Try$.apply(Try.scala:210)\n\tat org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)\n\tat org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)\n\tat org.apache.spark.util.LazyTry.get(LazyTry.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:340)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:274)\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)\n\tat org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)\n\tat org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)\n\tat org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)\n\tat org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)\n\tat org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)\n\tat org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)\n\tat com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)\n\tat com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)\n\tat scala.util.Using$.resource(Using.scala:261)\n\tat com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)", "context": {"errorClass": "UNRESOLVED_COLUMN.WITH_SUGGESTION"}, "exception": {"class": "_MultiThreadedRendezvous", "msg": "<_MultiThreadedRendezvous of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`BookType` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`book`, `DERIVATIVE`.`_valid`, `DERIVATIVE`.`md5code`, `DERIVATIVE`.`runid`, `DERIVATIVE`.`upi`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 37 more fields]\n      +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 36 more fields]\n         +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350...\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_message:\"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`BookType` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`book`, `DERIVATIVE`.`_valid`, `DERIVATIVE`.`md5code`, `DERIVATIVE`.`runid`, `DERIVATIVE`.`upi`]. SQLSTATE: 42703; line 1 pos 0;\\n\\'GlobalLimit 1\\n+- \\'LocalLimit 1\\n   +- \\'Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 37 more fields]\\n      +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 36 more fields]\\n         +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350...\", grpc_status:13, created_time:\"2025-09-12T13:45:23.965874702+00:00\"}\"\n>", "stacktrace": [{"class": null, "method": "_execute_and_fetch_as_iterator", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "1932"}, {"class": null, "method": "__next__", "file": "<frozen _collections_abc>", "line": "356"}, {"class": null, "method": "send", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "141"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "202"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "174"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "307"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "279"}, {"class": null, "method": "<lambda>", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "175"}, {"class": null, "method": "__iter__", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "658"}, {"class": null, "method": "__next__", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "540"}, {"class": null, "method": "_next", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "966"}]}}


2025-09-12 13:45:24 [ERROR] _log:  [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`BookType` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`book`, `DERIVATIVE`.`_valid`, `DERIVATIVE`.`md5code`, `DERIVATIVE`.`runid`, `DERIVATIVE`.`upi`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 37 more fields]
      +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 36 more fields]
         +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 35 more fields]
            +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 34 more fields]
               +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 33 more fields]
                  +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 32 more fields]
                     +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 31 more fields]
                        +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 30 more fields]
                           +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 29 more fields]
                              +- Project [idx#372275L, ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, ... 30 more fields]
                                 +- Join LeftOuter, (idx#372275L = idx#372430L)
                                    :- SubqueryAlias AMOUNT_AGG
                                    :  +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, monotonically_increasing_id() AS idx#372275L]
                                    :     +- Project [AMOUNT_AGG.ai#372200 AS ai#372254, AMOUNT_AGG.derivativetrade#372201 AS derivativetrade#372255, AMOUNT_AGG.dirty_replacement_cost#372202 AS dirty_replacement_cost#372256, AMOUNT_AGG.fee_cd#372203 AS fee_cd#372257, AMOUNT_AGG.fee_et#372204 AS fee_et#372258, AMOUNT_AGG.mtmkt#372205 AS mtmkt#372259, AMOUNT_AGG.mtmkt_rcoa#372206 AS mtmkt_rcoa#372260, AMOUNT_AGG.notional#372207 AS notional#372261, AMOUNT_AGG.notional_rcoa#372208 AS notional_rcoa#372262, AMOUNT_AGG.notionaltransactioncurrency#372209 AS notionaltransactioncurrency#372263]
                                    :        +- LocalRelation <empty>, [AMOUNT_AGG.ai#372200, AMOUNT_AGG.derivativetrade#372201, AMOUNT_AGG.dirty_replacement_cost#372202, AMOUNT_AGG.fee_cd#372203, AMOUNT_AGG.fee_et#372204, AMOUNT_AGG.mtmkt#372205, AMOUNT_AGG.mtmkt_rcoa#372206, AMOUNT_AGG.notional#372207, AMOUNT_AGG.notional_rcoa#372208, AMOUNT_AGG.notionaltransactioncurrency#372209, DERIVATIVE._load_dts#372210, DERIVATIVE._load_end_dts#372211, DERIVATIVE._row_hash#372212, DERIVATIVE._valid#372213, DERIVATIVE._valid_from#372214, DERIVATIVE._valid_to#372215, DERIVATIVE.accountinghedgemethod#372216, DERIVATIVE.accountinghedgerelationshipidentifier#372217, DERIVATIVE.accountinghedgerelationshiptype#372218, DERIVATIVE.accountingstandard#372219, DERIVATIVE.agreementpackageidentifier#372220, DERIVATIVE.book#372221, DERIVATIVE.businesssegment#372222, DERIVATIVE.buysellindicator#372223, DERIVATIVE.counterparty#372224, ... 29 more fields]
                                    +- SubqueryAlias DERIVATIVE
                                       +- Project [_load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, counterpartysourcesystemidentifier#372356, creditsupportannex#372357, creditsupportannexsourcesystemidentifier#372358, deliveryentity#372359, deliveryset#372360, derivativeagreementidentifier#372361, derivativetradeidentifier#372362, fairvaluehierarchy#372363, filename#372364, filereportingperiod#372365, ... 20 more fields]
                                          +- Project [DERIVATIVE._load_dts#372297 AS _load_dts#372341, DERIVATIVE._load_end_dts#372298 AS _load_end_dts#372342, DERIVATIVE._row_hash#372299 AS _row_hash#372343, DERIVATIVE._valid#372300 AS _valid#372344, DERIVATIVE._valid_from#372301 AS _valid_from#372345, DERIVATIVE._valid_to#372302 AS _valid_to#372346, DERIVATIVE.accountinghedgemethod#372303 AS accountinghedgemethod#372347, DERIVATIVE.accountinghedgerelationshipidentifier#372304 AS accountinghedgerelationshipidentifier#372348, DERIVATIVE.accountinghedgerelationshiptype#372305 AS accountinghedgerelationshiptype#372349, DERIVATIVE.accountingstandard#372306 AS accountingstandard#372350, DERIVATIVE.agreementpackageidentifier#372307 AS agreementpackageidentifier#372351, DERIVATIVE.book#372308 AS book#372352, DERIVATIVE.businesssegment#372309 AS businesssegment#372353, DERIVATIVE.buysellindicator#372310 AS buysellindicator#372354, DERIVATIVE.counterparty#372311 AS counterparty#372355, DERIVATIVE.counterpartysourcesystemidentifier#372312 AS counterpartysourcesystemidentifier#372356, DERIVATIVE.creditsupportannex#372313 AS creditsupportannex#372357, DERIVATIVE.creditsupportannexsourcesystemidentifier#372314 AS creditsupportannexsourcesystemidentifier#372358, DERIVATIVE.deliveryentity#372315 AS deliveryentity#372359, DERIVATIVE.deliveryset#372316 AS deliveryset#372360, DERIVATIVE.derivativeagreementidentifier#372317 AS derivativeagreementidentifier#372361, DERIVATIVE.derivativetradeidentifier#372318 AS derivativetradeidentifier#372362, DERIVATIVE.fairvaluehierarchy#372319 AS fairvaluehierarchy#372363, DERIVATIVE.filename#372320 AS filename#372364, DERIVATIVE.filereportingperiod#372321 AS filereportingperiod#372365, ... 19 more fields]
                                             +- LocalRelation <empty>, [AMOUNT_AGG.ai#372287, AMOUNT_AGG.derivativetrade#372288, AMOUNT_AGG.dirty_replacement_cost#372289, AMOUNT_AGG.fee_cd#372290, AMOUNT_AGG.fee_et#372291, AMOUNT_AGG.mtmkt#372292, AMOUNT_AGG.mtmkt_rcoa#372293, AMOUNT_AGG.notional#372294, AMOUNT_AGG.notional_rcoa#372295, AMOUNT_AGG.notionaltransactioncurrency#372296, DERIVATIVE._load_dts#372297, DERIVATIVE._load_end_dts#372298, DERIVATIVE._row_hash#372299, DERIVATIVE._valid#372300, DERIVATIVE._valid_from#372301, DERIVATIVE._valid_to#372302, DERIVATIVE.accountinghedgemethod#372303, DERIVATIVE.accountinghedgerelationshipidentifier#372304, DERIVATIVE.accountinghedgerelationshiptype#372305, DERIVATIVE.accountingstandard#372306, DERIVATIVE.agreementpackageidentifier#372307, DERIVATIVE.book#372308, DERIVATIVE.businesssegment#372309, DERIVATIVE.buysellindicator#372310, DERIVATIVE.counterparty#372311, ... 29 more fields]


JVM stacktrace:
org.apache.spark.sql.catalyst.ExtendedAnalysisException
	at org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:425)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:425)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:487)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:487)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:308)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$6(QueryExecution.scala:703)
	at org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:152)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:703)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1342)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:696)
	at com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:692)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:692)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:295)
	at com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:294)
	at scala.util.Try$.apply(Try.scala:210)
	at org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)
	at org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)
	at org.apache.spark.util.LazyTry.get(LazyTry.scala:58)
	at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:340)
	at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:274)
	at org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)
	at org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)
	at org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)
	at org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)
	at org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)
	at org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)
	at scala.util.Using$.resource(Using.scala:261)
	at com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)
Traceback (most recent call last):
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 1932, in _execute_and_fetch_as_iterator
    for b in generator:
  File "<frozen _collections_abc>", line 356, in __next__
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 141, in send
    if not self._has_next():
           ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 202, in _has_next
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 174, in _has_next
    self._current = self._call_iter(
                    ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 307, in _call_iter
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 279, in _call_iter
    return iter_fun()
           ^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 175, in <lambda>
    lambda: next(self._iterator)  # type: ignore[arg-type]
            ^^^^^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 658, in __iter__
    for response in self._call:
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 540, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 966, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.INTERNAL
	details = "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`BookType` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`book`, `DERIVATIVE`.`_valid`, `DERIVATIVE`.`md5code`, `DERIVATIVE`.`runid`, `DERIVATIVE`.`upi`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 37 more fields]
      +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 36 more fields]
         +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350..."
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_message:"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`BookType` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`book`, `DERIVATIVE`.`_valid`, `DERIVATIVE`.`md5code`, `DERIVATIVE`.`runid`, `DERIVATIVE`.`upi`]. SQLSTATE: 42703; line 1 pos 0;\n\'GlobalLimit 1\n+- \'LocalLimit 1\n   +- \'Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 37 more fields]\n      +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350, agreementpackageidentifier#372351, book#372352, businesssegment#372353, buysellindicator#372354, counterparty#372355, ... 36 more fields]\n         +- Project [ai#372254, derivativetrade#372255, dirty_replacement_cost#372256, fee_cd#372257, fee_et#372258, mtmkt#372259, mtmkt_rcoa#372260, notional#372261, notional_rcoa#372262, notionaltransactioncurrency#372263, _load_dts#372341, _load_end_dts#372342, _row_hash#372343, _valid#372344, _valid_from#372345, _valid_to#372346, accountinghedgemethod#372347, accountinghedgerelationshipidentifier#372348, accountinghedgerelationshiptype#372349, accountingstandard#372350...", grpc_status:13, created_time:"2025-09-12T13:45:23.965874702+00:00"}"
>


{"ts": "2025-09-12 13:45:24.615", "level": "ERROR", "logger": "SQLQueryContextLogger", "msg": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`CurrentDerivativeTradeIdentifier` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`derivativetradeidentifier`, `DerivativeTradeIdentifier`, `DERIVATIVE`.`derivativeagreementidentifier`, `DERIVATIVE`.`agreementpackageidentifier`, `DERIVATIVE`.`sourcesystemidentifier`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 41 more fields]\n      +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 40 more fields]\n         +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 39 more fields]\n            +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 38 more fields]\n               +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 37 more fields]\n                  +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 36 more fields]\n                     +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 35 more fields]\n                        +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 34 more fields]\n                           +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 33 more fields]\n                              +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 32 more fields]\n                                 +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 31 more fields]\n                                    +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 30 more fields]\n                                       +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 29 more fields]\n                                          +- Project [idx#375110L, ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, ... 30 more fields]\n                                             +- Join LeftOuter, (idx#375110L = idx#375265L)\n                                                :- SubqueryAlias AMOUNT_AGG\n                                                :  +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, monotonically_increasing_id() AS idx#375110L]\n                                                :     +- Project [AMOUNT_AGG.ai#375035 AS ai#375089, AMOUNT_AGG.derivativetrade#375036 AS derivativetrade#375090, AMOUNT_AGG.dirty_replacement_cost#375037 AS dirty_replacement_cost#375091, AMOUNT_AGG.fee_cd#375038 AS fee_cd#375092, AMOUNT_AGG.fee_et#375039 AS fee_et#375093, AMOUNT_AGG.mtmkt#375040 AS mtmkt#375094, AMOUNT_AGG.mtmkt_rcoa#375041 AS mtmkt_rcoa#375095, AMOUNT_AGG.notional#375042 AS notional#375096, AMOUNT_AGG.notional_rcoa#375043 AS notional_rcoa#375097, AMOUNT_AGG.notionaltransactioncurrency#375044 AS notionaltransactioncurrency#375098]\n                                                :        +- LocalRelation <empty>, [AMOUNT_AGG.ai#375035, AMOUNT_AGG.derivativetrade#375036, AMOUNT_AGG.dirty_replacement_cost#375037, AMOUNT_AGG.fee_cd#375038, AMOUNT_AGG.fee_et#375039, AMOUNT_AGG.mtmkt#375040, AMOUNT_AGG.mtmkt_rcoa#375041, AMOUNT_AGG.notional#375042, AMOUNT_AGG.notional_rcoa#375043, AMOUNT_AGG.notionaltransactioncurrency#375044, DERIVATIVE._load_dts#375045, DERIVATIVE._load_end_dts#375046, DERIVATIVE._row_hash#375047, DERIVATIVE._valid#375048, DERIVATIVE._valid_from#375049, DERIVATIVE._valid_to#375050, DERIVATIVE.accountinghedgemethod#375051, DERIVATIVE.accountinghedgerelationshipidentifier#375052, DERIVATIVE.accountinghedgerelationshiptype#375053, DERIVATIVE.accountingstandard#375054, DERIVATIVE.agreementpackageidentifier#375055, DERIVATIVE.book#375056, DERIVATIVE.businesssegment#375057, DERIVATIVE.buysellindicator#375058, DERIVATIVE.counterparty#375059, ... 29 more fields]\n                                                +- SubqueryAlias DERIVATIVE\n                                                   +- Project [_load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, counterpartysourcesystemidentifier#375191, creditsupportannex#375192, creditsupportannexsourcesystemidentifier#375193, deliveryentity#375194, deliveryset#375195, derivativeagreementidentifier#375196, derivativetradeidentifier#375197, fairvaluehierarchy#375198, filename#375199, filereportingperiod#375200, ... 20 more fields]\n                                                      +- Project [DERIVATIVE._load_dts#375132 AS _load_dts#375176, DERIVATIVE._load_end_dts#375133 AS _load_end_dts#375177, DERIVATIVE._row_hash#375134 AS _row_hash#375178, DERIVATIVE._valid#375135 AS _valid#375179, DERIVATIVE._valid_from#375136 AS _valid_from#375180, DERIVATIVE._valid_to#375137 AS _valid_to#375181, DERIVATIVE.accountinghedgemethod#375138 AS accountinghedgemethod#375182, DERIVATIVE.accountinghedgerelationshipidentifier#375139 AS accountinghedgerelationshipidentifier#375183, DERIVATIVE.accountinghedgerelationshiptype#375140 AS accountinghedgerelationshiptype#375184, DERIVATIVE.accountingstandard#375141 AS accountingstandard#375185, DERIVATIVE.agreementpackageidentifier#375142 AS agreementpackageidentifier#375186, DERIVATIVE.book#375143 AS book#375187, DERIVATIVE.businesssegment#375144 AS businesssegment#375188, DERIVATIVE.buysellindicator#375145 AS buysellindicator#375189, DERIVATIVE.counterparty#375146 AS counterparty#375190, DERIVATIVE.counterpartysourcesystemidentifier#375147 AS counterpartysourcesystemidentifier#375191, DERIVATIVE.creditsupportannex#375148 AS creditsupportannex#375192, DERIVATIVE.creditsupportannexsourcesystemidentifier#375149 AS creditsupportannexsourcesystemidentifier#375193, DERIVATIVE.deliveryentity#375150 AS deliveryentity#375194, DERIVATIVE.deliveryset#375151 AS deliveryset#375195, DERIVATIVE.derivativeagreementidentifier#375152 AS derivativeagreementidentifier#375196, DERIVATIVE.derivativetradeidentifier#375153 AS derivativetradeidentifier#375197, DERIVATIVE.fairvaluehierarchy#375154 AS fairvaluehierarchy#375198, DERIVATIVE.filename#375155 AS filename#375199, DERIVATIVE.filereportingperiod#375156 AS filereportingperiod#375200, ... 19 more fields]\n                                                         +- LocalRelation <empty>, [AMOUNT_AGG.ai#375122, AMOUNT_AGG.derivativetrade#375123, AMOUNT_AGG.dirty_replacement_cost#375124, AMOUNT_AGG.fee_cd#375125, AMOUNT_AGG.fee_et#375126, AMOUNT_AGG.mtmkt#375127, AMOUNT_AGG.mtmkt_rcoa#375128, AMOUNT_AGG.notional#375129, AMOUNT_AGG.notional_rcoa#375130, AMOUNT_AGG.notionaltransactioncurrency#375131, DERIVATIVE._load_dts#375132, DERIVATIVE._load_end_dts#375133, DERIVATIVE._row_hash#375134, DERIVATIVE._valid#375135, DERIVATIVE._valid_from#375136, DERIVATIVE._valid_to#375137, DERIVATIVE.accountinghedgemethod#375138, DERIVATIVE.accountinghedgerelationshipidentifier#375139, DERIVATIVE.accountinghedgerelationshiptype#375140, DERIVATIVE.accountingstandard#375141, DERIVATIVE.agreementpackageidentifier#375142, DERIVATIVE.book#375143, DERIVATIVE.businesssegment#375144, DERIVATIVE.buysellindicator#375145, DERIVATIVE.counterparty#375146, ... 29 more fields]\n\n\nJVM stacktrace:\norg.apache.spark.sql.catalyst.ExtendedAnalysisException\n\tat org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)\n\tat scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)\n\tat scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:933)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:487)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:487)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:308)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$6(QueryExecution.scala:703)\n\tat org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:152)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:703)\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1342)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:696)\n\tat com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:692)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:692)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:295)\n\tat com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:294)\n\tat scala.util.Try$.apply(Try.scala:210)\n\tat org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)\n\tat org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)\n\tat org.apache.spark.util.LazyTry.get(LazyTry.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:340)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:274)\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)\n\tat org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)\n\tat org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)\n\tat org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)\n\tat org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)\n\tat org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)\n\tat org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)\n\tat com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)\n\tat com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)\n\tat scala.util.Using$.resource(Using.scala:261)\n\tat com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)", "context": {"errorClass": "UNRESOLVED_COLUMN.WITH_SUGGESTION"}, "exception": {"class": "_MultiThreadedRendezvous", "msg": "<_MultiThreadedRendezvous of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`CurrentDerivativeTradeIdentifier` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`derivativetradeidentifier`, `DerivativeTradeIdentifier`, `DERIVATIVE`.`derivativeagreementidentifier`, `DERIVATIVE`.`agreementpackageidentifier`, `DERIVATIVE`.`sourcesystemidentifier`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 41 more fields]\n      +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 40 more fields]\n         +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182...\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_message:\"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`CurrentDerivativeTradeIdentifier` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`derivativetradeidentifier`, `DerivativeTradeIdentifier`, `DERIVATIVE`.`derivativeagreementidentifier`, `DERIVATIVE`.`agreementpackageidentifier`, `DERIVATIVE`.`sourcesystemidentifier`]. SQLSTATE: 42703; line 1 pos 0;\\n\\'GlobalLimit 1\\n+- \\'LocalLimit 1\\n   +- \\'Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 41 more fields]\\n      +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 40 more fields]\\n         +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182...\", grpc_status:13, created_time:\"2025-09-12T13:45:24.596373679+00:00\"}\"\n>", "stacktrace": [{"class": null, "method": "_execute_and_fetch_as_iterator", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "1932"}, {"class": null, "method": "__next__", "file": "<frozen _collections_abc>", "line": "356"}, {"class": null, "method": "send", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "141"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "202"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "174"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "307"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "279"}, {"class": null, "method": "<lambda>", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "175"}, {"class": null, "method": "__iter__", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "658"}, {"class": null, "method": "__next__", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "540"}, {"class": null, "method": "_next", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "966"}]}}


2025-09-12 13:45:24 [ERROR] _log:  [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`CurrentDerivativeTradeIdentifier` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`derivativetradeidentifier`, `DerivativeTradeIdentifier`, `DERIVATIVE`.`derivativeagreementidentifier`, `DERIVATIVE`.`agreementpackageidentifier`, `DERIVATIVE`.`sourcesystemidentifier`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 41 more fields]
      +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 40 more fields]
         +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 39 more fields]
            +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 38 more fields]
               +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 37 more fields]
                  +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 36 more fields]
                     +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 35 more fields]
                        +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 34 more fields]
                           +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 33 more fields]
                              +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 32 more fields]
                                 +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 31 more fields]
                                    +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 30 more fields]
                                       +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 29 more fields]
                                          +- Project [idx#375110L, ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, ... 30 more fields]
                                             +- Join LeftOuter, (idx#375110L = idx#375265L)
                                                :- SubqueryAlias AMOUNT_AGG
                                                :  +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, monotonically_increasing_id() AS idx#375110L]
                                                :     +- Project [AMOUNT_AGG.ai#375035 AS ai#375089, AMOUNT_AGG.derivativetrade#375036 AS derivativetrade#375090, AMOUNT_AGG.dirty_replacement_cost#375037 AS dirty_replacement_cost#375091, AMOUNT_AGG.fee_cd#375038 AS fee_cd#375092, AMOUNT_AGG.fee_et#375039 AS fee_et#375093, AMOUNT_AGG.mtmkt#375040 AS mtmkt#375094, AMOUNT_AGG.mtmkt_rcoa#375041 AS mtmkt_rcoa#375095, AMOUNT_AGG.notional#375042 AS notional#375096, AMOUNT_AGG.notional_rcoa#375043 AS notional_rcoa#375097, AMOUNT_AGG.notionaltransactioncurrency#375044 AS notionaltransactioncurrency#375098]
                                                :        +- LocalRelation <empty>, [AMOUNT_AGG.ai#375035, AMOUNT_AGG.derivativetrade#375036, AMOUNT_AGG.dirty_replacement_cost#375037, AMOUNT_AGG.fee_cd#375038, AMOUNT_AGG.fee_et#375039, AMOUNT_AGG.mtmkt#375040, AMOUNT_AGG.mtmkt_rcoa#375041, AMOUNT_AGG.notional#375042, AMOUNT_AGG.notional_rcoa#375043, AMOUNT_AGG.notionaltransactioncurrency#375044, DERIVATIVE._load_dts#375045, DERIVATIVE._load_end_dts#375046, DERIVATIVE._row_hash#375047, DERIVATIVE._valid#375048, DERIVATIVE._valid_from#375049, DERIVATIVE._valid_to#375050, DERIVATIVE.accountinghedgemethod#375051, DERIVATIVE.accountinghedgerelationshipidentifier#375052, DERIVATIVE.accountinghedgerelationshiptype#375053, DERIVATIVE.accountingstandard#375054, DERIVATIVE.agreementpackageidentifier#375055, DERIVATIVE.book#375056, DERIVATIVE.businesssegment#375057, DERIVATIVE.buysellindicator#375058, DERIVATIVE.counterparty#375059, ... 29 more fields]
                                                +- SubqueryAlias DERIVATIVE
                                                   +- Project [_load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, counterpartysourcesystemidentifier#375191, creditsupportannex#375192, creditsupportannexsourcesystemidentifier#375193, deliveryentity#375194, deliveryset#375195, derivativeagreementidentifier#375196, derivativetradeidentifier#375197, fairvaluehierarchy#375198, filename#375199, filereportingperiod#375200, ... 20 more fields]
                                                      +- Project [DERIVATIVE._load_dts#375132 AS _load_dts#375176, DERIVATIVE._load_end_dts#375133 AS _load_end_dts#375177, DERIVATIVE._row_hash#375134 AS _row_hash#375178, DERIVATIVE._valid#375135 AS _valid#375179, DERIVATIVE._valid_from#375136 AS _valid_from#375180, DERIVATIVE._valid_to#375137 AS _valid_to#375181, DERIVATIVE.accountinghedgemethod#375138 AS accountinghedgemethod#375182, DERIVATIVE.accountinghedgerelationshipidentifier#375139 AS accountinghedgerelationshipidentifier#375183, DERIVATIVE.accountinghedgerelationshiptype#375140 AS accountinghedgerelationshiptype#375184, DERIVATIVE.accountingstandard#375141 AS accountingstandard#375185, DERIVATIVE.agreementpackageidentifier#375142 AS agreementpackageidentifier#375186, DERIVATIVE.book#375143 AS book#375187, DERIVATIVE.businesssegment#375144 AS businesssegment#375188, DERIVATIVE.buysellindicator#375145 AS buysellindicator#375189, DERIVATIVE.counterparty#375146 AS counterparty#375190, DERIVATIVE.counterpartysourcesystemidentifier#375147 AS counterpartysourcesystemidentifier#375191, DERIVATIVE.creditsupportannex#375148 AS creditsupportannex#375192, DERIVATIVE.creditsupportannexsourcesystemidentifier#375149 AS creditsupportannexsourcesystemidentifier#375193, DERIVATIVE.deliveryentity#375150 AS deliveryentity#375194, DERIVATIVE.deliveryset#375151 AS deliveryset#375195, DERIVATIVE.derivativeagreementidentifier#375152 AS derivativeagreementidentifier#375196, DERIVATIVE.derivativetradeidentifier#375153 AS derivativetradeidentifier#375197, DERIVATIVE.fairvaluehierarchy#375154 AS fairvaluehierarchy#375198, DERIVATIVE.filename#375155 AS filename#375199, DERIVATIVE.filereportingperiod#375156 AS filereportingperiod#375200, ... 19 more fields]
                                                         +- LocalRelation <empty>, [AMOUNT_AGG.ai#375122, AMOUNT_AGG.derivativetrade#375123, AMOUNT_AGG.dirty_replacement_cost#375124, AMOUNT_AGG.fee_cd#375125, AMOUNT_AGG.fee_et#375126, AMOUNT_AGG.mtmkt#375127, AMOUNT_AGG.mtmkt_rcoa#375128, AMOUNT_AGG.notional#375129, AMOUNT_AGG.notional_rcoa#375130, AMOUNT_AGG.notionaltransactioncurrency#375131, DERIVATIVE._load_dts#375132, DERIVATIVE._load_end_dts#375133, DERIVATIVE._row_hash#375134, DERIVATIVE._valid#375135, DERIVATIVE._valid_from#375136, DERIVATIVE._valid_to#375137, DERIVATIVE.accountinghedgemethod#375138, DERIVATIVE.accountinghedgerelationshipidentifier#375139, DERIVATIVE.accountinghedgerelationshiptype#375140, DERIVATIVE.accountingstandard#375141, DERIVATIVE.agreementpackageidentifier#375142, DERIVATIVE.book#375143, DERIVATIVE.businesssegment#375144, DERIVATIVE.buysellindicator#375145, DERIVATIVE.counterparty#375146, ... 29 more fields]


JVM stacktrace:
org.apache.spark.sql.catalyst.ExtendedAnalysisException
	at org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:425)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:425)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:487)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:487)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:308)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$6(QueryExecution.scala:703)
	at org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:152)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:703)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1342)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:696)
	at com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:692)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:692)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:295)
	at com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:294)
	at scala.util.Try$.apply(Try.scala:210)
	at org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)
	at org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)
	at org.apache.spark.util.LazyTry.get(LazyTry.scala:58)
	at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:340)
	at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:274)
	at org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)
	at org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)
	at org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)
	at org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)
	at org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)
	at org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)
	at scala.util.Using$.resource(Using.scala:261)
	at com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)
Traceback (most recent call last):
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 1932, in _execute_and_fetch_as_iterator
    for b in generator:
  File "<frozen _collections_abc>", line 356, in __next__
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 141, in send
    if not self._has_next():
           ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 202, in _has_next
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 174, in _has_next
    self._current = self._call_iter(
                    ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 307, in _call_iter
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 279, in _call_iter
    return iter_fun()
           ^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 175, in <lambda>
    lambda: next(self._iterator)  # type: ignore[arg-type]
            ^^^^^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 658, in __iter__
    for response in self._call:
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 540, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 966, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.INTERNAL
	details = "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`CurrentDerivativeTradeIdentifier` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`derivativetradeidentifier`, `DerivativeTradeIdentifier`, `DERIVATIVE`.`derivativeagreementidentifier`, `DERIVATIVE`.`agreementpackageidentifier`, `DERIVATIVE`.`sourcesystemidentifier`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 41 more fields]
      +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 40 more fields]
         +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182..."
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_message:"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`CurrentDerivativeTradeIdentifier` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`derivativetradeidentifier`, `DerivativeTradeIdentifier`, `DERIVATIVE`.`derivativeagreementidentifier`, `DERIVATIVE`.`agreementpackageidentifier`, `DERIVATIVE`.`sourcesystemidentifier`]. SQLSTATE: 42703; line 1 pos 0;\n\'GlobalLimit 1\n+- \'LocalLimit 1\n   +- \'Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 41 more fields]\n      +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182, accountinghedgerelationshipidentifier#375183, accountinghedgerelationshiptype#375184, accountingstandard#375185, agreementpackageidentifier#375186, book#375187, businesssegment#375188, buysellindicator#375189, counterparty#375190, ... 40 more fields]\n         +- Project [ai#375089, derivativetrade#375090, dirty_replacement_cost#375091, fee_cd#375092, fee_et#375093, mtmkt#375094, mtmkt_rcoa#375095, notional#375096, notional_rcoa#375097, notionaltransactioncurrency#375098, _load_dts#375176, _load_end_dts#375177, _row_hash#375178, _valid#375179, _valid_from#375180, _valid_to#375181, accountinghedgemethod#375182...", grpc_status:13, created_time:"2025-09-12T13:45:24.596373679+00:00"}"
>


{"ts": "2025-09-12 13:45:26.213", "level": "ERROR", "logger": "SQLQueryContextLogger", "msg": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`MaturityDate` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`tradedate`, `DERIVATIVE`.`valuedate`, `DERIVATIVE`.`filename`, `DERIVATIVE`.`reportingdate`, `DERIVATIVE`.`runid`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 52 more fields]\n      +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 51 more fields]\n         +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 50 more fields]\n            +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 49 more fields]\n               +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 48 more fields]\n                  +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 47 more fields]\n                     +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 46 more fields]\n                        +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 45 more fields]\n                           +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 44 more fields]\n                              +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 43 more fields]\n                                 +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 42 more fields]\n                                    +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 41 more fields]\n                                       +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 40 more fields]\n                                          +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 39 more fields]\n                                             +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 38 more fields]\n                                                +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 37 more fields]\n                                                   +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 36 more fields]\n                                                      +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 35 more fields]\n                                                         +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 34 more fields]\n                                                            +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 33 more fields]\n                                                               +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 32 more fields]\n                                                                  +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 31 more fields]\n                                                                     +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 30 more fields]\n                                                                        +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 29 more fields]\n                                                                           +- Project [idx#382264L, ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, ... 30 more fields]\n                                                                              +- Join LeftOuter, (idx#382264L = idx#382419L)\n                                                                                 :- SubqueryAlias AMOUNT_AGG\n                                                                                 :  +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, monotonically_increasing_id() AS idx#382264L]\n                                                                                 :     +- Project [AMOUNT_AGG.ai#382189 AS ai#382243, AMOUNT_AGG.derivativetrade#382190 AS derivativetrade#382244, AMOUNT_AGG.dirty_replacement_cost#382191 AS dirty_replacement_cost#382245, AMOUNT_AGG.fee_cd#382192 AS fee_cd#382246, AMOUNT_AGG.fee_et#382193 AS fee_et#382247, AMOUNT_AGG.mtmkt#382194 AS mtmkt#382248, AMOUNT_AGG.mtmkt_rcoa#382195 AS mtmkt_rcoa#382249, AMOUNT_AGG.notional#382196 AS notional#382250, AMOUNT_AGG.notional_rcoa#382197 AS notional_rcoa#382251, AMOUNT_AGG.notionaltransactioncurrency#382198 AS notionaltransactioncurrency#382252]\n                                                                                 :        +- LocalRelation <empty>, [AMOUNT_AGG.ai#382189, AMOUNT_AGG.derivativetrade#382190, AMOUNT_AGG.dirty_replacement_cost#382191, AMOUNT_AGG.fee_cd#382192, AMOUNT_AGG.fee_et#382193, AMOUNT_AGG.mtmkt#382194, AMOUNT_AGG.mtmkt_rcoa#382195, AMOUNT_AGG.notional#382196, AMOUNT_AGG.notional_rcoa#382197, AMOUNT_AGG.notionaltransactioncurrency#382198, DERIVATIVE._load_dts#382199, DERIVATIVE._load_end_dts#382200, DERIVATIVE._row_hash#382201, DERIVATIVE._valid#382202, DERIVATIVE._valid_from#382203, DERIVATIVE._valid_to#382204, DERIVATIVE.accountinghedgemethod#382205, DERIVATIVE.accountinghedgerelationshipidentifier#382206, DERIVATIVE.accountinghedgerelationshiptype#382207, DERIVATIVE.accountingstandard#382208, DERIVATIVE.agreementpackageidentifier#382209, DERIVATIVE.book#382210, DERIVATIVE.businesssegment#382211, DERIVATIVE.buysellindicator#382212, DERIVATIVE.counterparty#382213, ... 29 more fields]\n                                                                                 +- SubqueryAlias DERIVATIVE\n                                                                                    +- Project [_load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, counterpartysourcesystemidentifier#382345, creditsupportannex#382346, creditsupportannexsourcesystemidentifier#382347, deliveryentity#382348, deliveryset#382349, derivativeagreementidentifier#382350, derivativetradeidentifier#382351, fairvaluehierarchy#382352, filename#382353, filereportingperiod#382354, ... 20 more fields]\n                                                                                       +- Project [DERIVATIVE._load_dts#382286 AS _load_dts#382330, DERIVATIVE._load_end_dts#382287 AS _load_end_dts#382331, DERIVATIVE._row_hash#382288 AS _row_hash#382332, DERIVATIVE._valid#382289 AS _valid#382333, DERIVATIVE._valid_from#382290 AS _valid_from#382334, DERIVATIVE._valid_to#382291 AS _valid_to#382335, DERIVATIVE.accountinghedgemethod#382292 AS accountinghedgemethod#382336, DERIVATIVE.accountinghedgerelationshipidentifier#382293 AS accountinghedgerelationshipidentifier#382337, DERIVATIVE.accountinghedgerelationshiptype#382294 AS accountinghedgerelationshiptype#382338, DERIVATIVE.accountingstandard#382295 AS accountingstandard#382339, DERIVATIVE.agreementpackageidentifier#382296 AS agreementpackageidentifier#382340, DERIVATIVE.book#382297 AS book#382341, DERIVATIVE.businesssegment#382298 AS businesssegment#382342, DERIVATIVE.buysellindicator#382299 AS buysellindicator#382343, DERIVATIVE.counterparty#382300 AS counterparty#382344, DERIVATIVE.counterpartysourcesystemidentifier#382301 AS counterpartysourcesystemidentifier#382345, DERIVATIVE.creditsupportannex#382302 AS creditsupportannex#382346, DERIVATIVE.creditsupportannexsourcesystemidentifier#382303 AS creditsupportannexsourcesystemidentifier#382347, DERIVATIVE.deliveryentity#382304 AS deliveryentity#382348, DERIVATIVE.deliveryset#382305 AS deliveryset#382349, DERIVATIVE.derivativeagreementidentifier#382306 AS derivativeagreementidentifier#382350, DERIVATIVE.derivativetradeidentifier#382307 AS derivativetradeidentifier#382351, DERIVATIVE.fairvaluehierarchy#382308 AS fairvaluehierarchy#382352, DERIVATIVE.filename#382309 AS filename#382353, DERIVATIVE.filereportingperiod#382310 AS filereportingperiod#382354, ... 19 more fields]\n                                                                                          +- LocalRelation <empty>, [AMOUNT_AGG.ai#382276, AMOUNT_AGG.derivativetrade#382277, AMOUNT_AGG.dirty_replacement_cost#382278, AMOUNT_AGG.fee_cd#382279, AMOUNT_AGG.fee_et#382280, AMOUNT_AGG.mtmkt#382281, AMOUNT_AGG.mtmkt_rcoa#382282, AMOUNT_AGG.notional#382283, AMOUNT_AGG.notional_rcoa#382284, AMOUNT_AGG.notionaltransactioncurrency#382285, DERIVATIVE._load_dts#382286, DERIVATIVE._load_end_dts#382287, DERIVATIVE._row_hash#382288, DERIVATIVE._valid#382289, DERIVATIVE._valid_from#382290, DERIVATIVE._valid_to#382291, DERIVATIVE.accountinghedgemethod#382292, DERIVATIVE.accountinghedgerelationshipidentifier#382293, DERIVATIVE.accountinghedgerelationshiptype#382294, DERIVATIVE.accountingstandard#382295, DERIVATIVE.agreementpackageidentifier#382296, DERIVATIVE.book#382297, DERIVATIVE.businesssegment#382298, DERIVATIVE.buysellindicator#382299, DERIVATIVE.counterparty#382300, ... 29 more fields]\n\n\nJVM stacktrace:\norg.apache.spark.sql.catalyst.ExtendedAnalysisException\n\tat org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)\n\tat scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)\n\tat scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:933)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)\n\tat scala.collection.immutable.Vector.foreach(Vector.scala:1895)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)\n\tat org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:487)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:487)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:308)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$6(QueryExecution.scala:703)\n\tat org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:152)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:703)\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1342)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:696)\n\tat com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:692)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:692)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:295)\n\tat com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:294)\n\tat scala.util.Try$.apply(Try.scala:210)\n\tat org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)\n\tat org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)\n\tat org.apache.spark.util.LazyTry.get(LazyTry.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:340)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:274)\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)\n\tat com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)\n\tat org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)\n\tat org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)\n\tat org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)\n\tat org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)\n\tat org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)\n\tat org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)\n\tat org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)\n\tat org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)\n\tat com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)\n\tat com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)\n\tat com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)\n\tat scala.util.Using$.resource(Using.scala:261)\n\tat com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)\n\tat org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)", "context": {"errorClass": "UNRESOLVED_COLUMN.WITH_SUGGESTION"}, "exception": {"class": "_MultiThreadedRendezvous", "msg": "<_MultiThreadedRendezvous of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`MaturityDate` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`tradedate`, `DERIVATIVE`.`valuedate`, `DERIVATIVE`.`filename`, `DERIVATIVE`.`reportingdate`, `DERIVATIVE`.`runid`]. SQLSTATE: 42703; line 1 pos 0;\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 52 more fields]\n      +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 51 more fields]\n         +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, ac...\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_message:\"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`MaturityDate` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`tradedate`, `DERIVATIVE`.`valuedate`, `DERIVATIVE`.`filename`, `DERIVATIVE`.`reportingdate`, `DERIVATIVE`.`runid`]. SQLSTATE: 42703; line 1 pos 0;\\n\\'GlobalLimit 1\\n+- \\'LocalLimit 1\\n   +- \\'Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 52 more fields]\\n      +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 51 more fields]\\n         +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, ac...\", grpc_status:13, created_time:\"2025-09-12T13:45:26.194654881+00:00\"}\"\n>", "stacktrace": [{"class": null, "method": "_execute_and_fetch_as_iterator", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "1932"}, {"class": null, "method": "__next__", "file": "<frozen _collections_abc>", "line": "356"}, {"class": null, "method": "send", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "141"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "202"}, {"class": null, "method": "_has_next", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "174"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "307"}, {"class": null, "method": "_call_iter", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "279"}, {"class": null, "method": "<lambda>", "file": "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", "line": "175"}, {"class": null, "method": "__iter__", "file": "/databricks/spark/python/pyspark/sql/connect/client/core.py", "line": "658"}, {"class": null, "method": "__next__", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "540"}, {"class": null, "method": "_next", "file": "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", "line": "966"}]}}


2025-09-12 13:45:26 [ERROR] _log:  [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`MaturityDate` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`tradedate`, `DERIVATIVE`.`valuedate`, `DERIVATIVE`.`filename`, `DERIVATIVE`.`reportingdate`, `DERIVATIVE`.`runid`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 52 more fields]
      +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 51 more fields]
         +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 50 more fields]
            +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 49 more fields]
               +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 48 more fields]
                  +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 47 more fields]
                     +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 46 more fields]
                        +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 45 more fields]
                           +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 44 more fields]
                              +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 43 more fields]
                                 +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 42 more fields]
                                    +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 41 more fields]
                                       +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 40 more fields]
                                          +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 39 more fields]
                                             +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 38 more fields]
                                                +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 37 more fields]
                                                   +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 36 more fields]
                                                      +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 35 more fields]
                                                         +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 34 more fields]
                                                            +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 33 more fields]
                                                               +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 32 more fields]
                                                                  +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 31 more fields]
                                                                     +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 30 more fields]
                                                                        +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 29 more fields]
                                                                           +- Project [idx#382264L, ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, ... 30 more fields]
                                                                              +- Join LeftOuter, (idx#382264L = idx#382419L)
                                                                                 :- SubqueryAlias AMOUNT_AGG
                                                                                 :  +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, monotonically_increasing_id() AS idx#382264L]
                                                                                 :     +- Project [AMOUNT_AGG.ai#382189 AS ai#382243, AMOUNT_AGG.derivativetrade#382190 AS derivativetrade#382244, AMOUNT_AGG.dirty_replacement_cost#382191 AS dirty_replacement_cost#382245, AMOUNT_AGG.fee_cd#382192 AS fee_cd#382246, AMOUNT_AGG.fee_et#382193 AS fee_et#382247, AMOUNT_AGG.mtmkt#382194 AS mtmkt#382248, AMOUNT_AGG.mtmkt_rcoa#382195 AS mtmkt_rcoa#382249, AMOUNT_AGG.notional#382196 AS notional#382250, AMOUNT_AGG.notional_rcoa#382197 AS notional_rcoa#382251, AMOUNT_AGG.notionaltransactioncurrency#382198 AS notionaltransactioncurrency#382252]
                                                                                 :        +- LocalRelation <empty>, [AMOUNT_AGG.ai#382189, AMOUNT_AGG.derivativetrade#382190, AMOUNT_AGG.dirty_replacement_cost#382191, AMOUNT_AGG.fee_cd#382192, AMOUNT_AGG.fee_et#382193, AMOUNT_AGG.mtmkt#382194, AMOUNT_AGG.mtmkt_rcoa#382195, AMOUNT_AGG.notional#382196, AMOUNT_AGG.notional_rcoa#382197, AMOUNT_AGG.notionaltransactioncurrency#382198, DERIVATIVE._load_dts#382199, DERIVATIVE._load_end_dts#382200, DERIVATIVE._row_hash#382201, DERIVATIVE._valid#382202, DERIVATIVE._valid_from#382203, DERIVATIVE._valid_to#382204, DERIVATIVE.accountinghedgemethod#382205, DERIVATIVE.accountinghedgerelationshipidentifier#382206, DERIVATIVE.accountinghedgerelationshiptype#382207, DERIVATIVE.accountingstandard#382208, DERIVATIVE.agreementpackageidentifier#382209, DERIVATIVE.book#382210, DERIVATIVE.businesssegment#382211, DERIVATIVE.buysellindicator#382212, DERIVATIVE.counterparty#382213, ... 29 more fields]
                                                                                 +- SubqueryAlias DERIVATIVE
                                                                                    +- Project [_load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, counterpartysourcesystemidentifier#382345, creditsupportannex#382346, creditsupportannexsourcesystemidentifier#382347, deliveryentity#382348, deliveryset#382349, derivativeagreementidentifier#382350, derivativetradeidentifier#382351, fairvaluehierarchy#382352, filename#382353, filereportingperiod#382354, ... 20 more fields]
                                                                                       +- Project [DERIVATIVE._load_dts#382286 AS _load_dts#382330, DERIVATIVE._load_end_dts#382287 AS _load_end_dts#382331, DERIVATIVE._row_hash#382288 AS _row_hash#382332, DERIVATIVE._valid#382289 AS _valid#382333, DERIVATIVE._valid_from#382290 AS _valid_from#382334, DERIVATIVE._valid_to#382291 AS _valid_to#382335, DERIVATIVE.accountinghedgemethod#382292 AS accountinghedgemethod#382336, DERIVATIVE.accountinghedgerelationshipidentifier#382293 AS accountinghedgerelationshipidentifier#382337, DERIVATIVE.accountinghedgerelationshiptype#382294 AS accountinghedgerelationshiptype#382338, DERIVATIVE.accountingstandard#382295 AS accountingstandard#382339, DERIVATIVE.agreementpackageidentifier#382296 AS agreementpackageidentifier#382340, DERIVATIVE.book#382297 AS book#382341, DERIVATIVE.businesssegment#382298 AS businesssegment#382342, DERIVATIVE.buysellindicator#382299 AS buysellindicator#382343, DERIVATIVE.counterparty#382300 AS counterparty#382344, DERIVATIVE.counterpartysourcesystemidentifier#382301 AS counterpartysourcesystemidentifier#382345, DERIVATIVE.creditsupportannex#382302 AS creditsupportannex#382346, DERIVATIVE.creditsupportannexsourcesystemidentifier#382303 AS creditsupportannexsourcesystemidentifier#382347, DERIVATIVE.deliveryentity#382304 AS deliveryentity#382348, DERIVATIVE.deliveryset#382305 AS deliveryset#382349, DERIVATIVE.derivativeagreementidentifier#382306 AS derivativeagreementidentifier#382350, DERIVATIVE.derivativetradeidentifier#382307 AS derivativetradeidentifier#382351, DERIVATIVE.fairvaluehierarchy#382308 AS fairvaluehierarchy#382352, DERIVATIVE.filename#382309 AS filename#382353, DERIVATIVE.filereportingperiod#382310 AS filereportingperiod#382354, ... 19 more fields]
                                                                                          +- LocalRelation <empty>, [AMOUNT_AGG.ai#382276, AMOUNT_AGG.derivativetrade#382277, AMOUNT_AGG.dirty_replacement_cost#382278, AMOUNT_AGG.fee_cd#382279, AMOUNT_AGG.fee_et#382280, AMOUNT_AGG.mtmkt#382281, AMOUNT_AGG.mtmkt_rcoa#382282, AMOUNT_AGG.notional#382283, AMOUNT_AGG.notional_rcoa#382284, AMOUNT_AGG.notionaltransactioncurrency#382285, DERIVATIVE._load_dts#382286, DERIVATIVE._load_end_dts#382287, DERIVATIVE._row_hash#382288, DERIVATIVE._valid#382289, DERIVATIVE._valid_from#382290, DERIVATIVE._valid_to#382291, DERIVATIVE.accountinghedgemethod#382292, DERIVATIVE.accountinghedgerelationshipidentifier#382293, DERIVATIVE.accountinghedgerelationshiptype#382294, DERIVATIVE.accountingstandard#382295, DERIVATIVE.agreementpackageidentifier#382296, DERIVATIVE.book#382297, DERIVATIVE.businesssegment#382298, DERIVATIVE.buysellindicator#382299, DERIVATIVE.counterparty#382300, ... 29 more fields]


JVM stacktrace:
org.apache.spark.sql.catalyst.ExtendedAnalysisException
	at org.apache.spark.sql.errors.QueryCompilationErrors$.unresolvedAttributeError(QueryCompilationErrors.scala:504)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$$failUnresolvedAttribute(CheckAnalysis.scala:179)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10(CheckAnalysis.scala:489)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$10$adapted(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$9$adapted(CheckAnalysis.scala:474)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:575)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:573)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2(CheckAnalysis.scala:474)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis0$2$adapted(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:303)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$foreachUp$1$adapted(TreeNode.scala:302)
	at scala.collection.immutable.Vector.foreach(Vector.scala:1895)
	at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:302)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0(CheckAnalysis.scala:307)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis0$(CheckAnalysis.scala:278)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis0(Analyzer.scala:425)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:263)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:250)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:425)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$resolveInFixedPoint$1(HybridAnalyzer.scala:254)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:219)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.resolveInFixedPoint(HybridAnalyzer.scala:254)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.$anonfun$apply$1(HybridAnalyzer.scala:96)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.withTrackedAnalyzerBridgeState(HybridAnalyzer.scala:131)
	at org.apache.spark.sql.catalyst.analysis.resolver.HybridAnalyzer.apply(HybridAnalyzer.scala:87)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:487)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:425)
	at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:487)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$3(QueryExecution.scala:308)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:548)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$6(QueryExecution.scala:703)
	at org.apache.spark.sql.execution.SQLExecution$.withExecutionPhase(SQLExecution.scala:152)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$5(QueryExecution.scala:703)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:1342)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:696)
	at com.databricks.util.LexicalThreadLocal$Handle.runWith(LexicalThreadLocal.scala:63)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:692)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:692)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$2(QueryExecution.scala:295)
	at com.databricks.sql.util.MemoryTrackerHelper.withMemoryTracking(MemoryTrackerHelper.scala:80)
	at org.apache.spark.sql.execution.QueryExecution.$anonfun$lazyAnalyzed$1(QueryExecution.scala:294)
	at scala.util.Try$.apply(Try.scala:210)
	at org.apache.spark.util.Utils$.doTryWithCallerStacktrace(Utils.scala:1684)
	at org.apache.spark.util.Utils$.getTryWithCallerStacktrace(Utils.scala:1745)
	at org.apache.spark.util.LazyTry.get(LazyTry.scala:58)
	at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:340)
	at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:274)
	at org.apache.spark.sql.Dataset$.$anonfun$ofRows$7(Dataset.scala:235)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.SparkSession.$anonfun$withActiveAndFrameProfiler$1(SparkSession.scala:1469)
	at com.databricks.spark.util.FrameProfiler$.record(FrameProfiler.scala:94)
	at org.apache.spark.sql.SparkSession.withActiveAndFrameProfiler(SparkSession.scala:1469)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:230)
	at org.apache.spark.sql.connect.execution.SparkConnectPlanExecution.handlePlan(SparkConnectPlanExecution.scala:110)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.handlePlan(ExecuteThreadRunner.scala:404)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1(ExecuteThreadRunner.scala:313)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.$anonfun$executeInternal$1$adapted(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$2(SessionHolder.scala:464)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:1462)
	at org.apache.spark.sql.connect.service.SessionHolder.$anonfun$withSession$1(SessionHolder.scala:464)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:97)
	at org.apache.spark.sql.artifact.ArtifactManager.$anonfun$withResources$1(ArtifactManager.scala:90)
	at org.apache.spark.util.Utils$.withContextClassLoader(Utils.scala:241)
	at org.apache.spark.sql.artifact.ArtifactManager.withResources(ArtifactManager.scala:89)
	at org.apache.spark.sql.connect.service.SessionHolder.withSession(SessionHolder.scala:463)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.executeInternal(ExecuteThreadRunner.scala:233)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner.org$apache$spark$sql$connect$execution$ExecuteThreadRunner$$execute(ExecuteThreadRunner.scala:139)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.$anonfun$run$2(ExecuteThreadRunner.scala:614)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at com.databricks.unity.HandleImpl.$anonfun$runWithAndClose$1(UCSHandle.scala:109)
	at scala.util.Using$.resource(Using.scala:261)
	at com.databricks.unity.HandleImpl.runWithAndClose(UCSHandle.scala:108)
	at org.apache.spark.sql.connect.execution.ExecuteThreadRunner$ExecutionThread.run(ExecuteThreadRunner.scala:614)
Traceback (most recent call last):
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 1932, in _execute_and_fetch_as_iterator
    for b in generator:
  File "<frozen _collections_abc>", line 356, in __next__
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 141, in send
    if not self._has_next():
           ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 202, in _has_next
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 174, in _has_next
    self._current = self._call_iter(
                    ^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 307, in _call_iter
    raise e
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 279, in _call_iter
    return iter_fun()
           ^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/reattach.py", line 175, in <lambda>
    lambda: next(self._iterator)  # type: ignore[arg-type]
            ^^^^^^^^^^^^^^^^^^^^
  File "/databricks/spark/python/pyspark/sql/connect/client/core.py", line 658, in __iter__
    for response in self._call:
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 540, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/databricks/python/lib/python3.12/site-packages/grpc/_channel.py", line 966, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.INTERNAL
	details = "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`MaturityDate` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`tradedate`, `DERIVATIVE`.`valuedate`, `DERIVATIVE`.`filename`, `DERIVATIVE`.`reportingdate`, `DERIVATIVE`.`runid`]. SQLSTATE: 42703; line 1 pos 0;
'GlobalLimit 1
+- 'LocalLimit 1
   +- 'Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 52 more fields]
      +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 51 more fields]
         +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, ac..."
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_message:"[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`MaturityDate` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`tradedate`, `DERIVATIVE`.`valuedate`, `DERIVATIVE`.`filename`, `DERIVATIVE`.`reportingdate`, `DERIVATIVE`.`runid`]. SQLSTATE: 42703; line 1 pos 0;\n\'GlobalLimit 1\n+- \'LocalLimit 1\n   +- \'Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 52 more fields]\n      +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, accountingstandard#382339, agreementpackageidentifier#382340, book#382341, businesssegment#382342, buysellindicator#382343, counterparty#382344, ... 51 more fields]\n         +- Project [ai#382243, derivativetrade#382244, dirty_replacement_cost#382245, fee_cd#382246, fee_et#382247, mtmkt#382248, mtmkt_rcoa#382249, notional#382250, notional_rcoa#382251, notionaltransactioncurrency#382252, _load_dts#382330, _load_end_dts#382331, _row_hash#382332, _valid#382333, _valid_from#382334, _valid_to#382335, accountinghedgemethod#382336, accountinghedgerelationshipidentifier#382337, accountinghedgerelationshiptype#382338, ac...", grpc_status:13, created_time:"2025-09-12T13:45:26.194654881+00:00"}"
>
2025-09-12 13:45:27 [ERROR] validate_sql_expressions:  Problem with expression(s):
2025-09-12 13:45:27 [ERROR] validate_sql_expressions:  DERIVATIVE.BookType: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`BookType` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`book`, `DERIVATIVE`.`_valid`, `DERIVATIVE`.`md5code`, `DERIVATIVE`.`runid`, `DERIVATIVE`.`upi`]. SQLSTATE: 42703
DERIVATIVE.CurrentDerivativeTradeIdentifier: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`CurrentDerivativeTradeIdentifier` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`derivativetradeidentifier`, `DerivativeTradeIdentifier`, `DERIVATIVE`.`derivativeagreementidentifier`, `DERIVATIVE`.`agreementpackageidentifier`, `DERIVATIVE`.`sourcesystemidentifier`]. SQLSTATE: 42703
DERIVATIVE.MaturityDate: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `DERIVATIVE`.`MaturityDate` cannot be resolved. Did you mean one of the following? [`DERIVATIVE`.`tradedate`, `DERIVATIVE`.`valuedate`, `DERIVATIVE`.`filename`, `DERIVATIVE`.`reportingdate`, `DERIVATIVE`.`runid`]. SQLSTATE: 42703


/databricks/python/lib/python3.12/site-packages/IPython/core/interactiveshell.py:3585: UserWarning: To exit: use 'exit', 'quit', or Ctrl-D.
  warn("To exit: use 'exit', 'quit', or Ctrl-D.", stacklevel=1)
